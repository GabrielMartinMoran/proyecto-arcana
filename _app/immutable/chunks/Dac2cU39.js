import"./DsnmJJEf.js";import{g as De,u as qe,k as we,h as Be,D as Ne,b as g,t as F,a as m,s as _,e as d,ak as Me,r as c,am as de,bc as ze,ay as je,i as a,J as T,aT as ye,p as ve,an as K,d as ce,f as j,c as ee}from"./IMy7ATtu.js";import{s as E,d as fe,e as We}from"./D7fMbzXu.js";import{e as me,r as ke,s as X,a as Ge,b as Ye}from"./BN0HieB6.js";import{t as Ke,b as Te,s as le,c as Qe}from"./DDY-qgJG.js";import{c as He,r as ue,g as Je,l as Xe}from"./CjlGQt4x.js";import{s as Ue}from"./Cgz26Cyk.js";import{i as D}from"./BBGzISq_.js";import{p as R}from"./mVHqn3mP.js";import{C as oe}from"./BLWxwbCG.js";import{h as Ze}from"./CvfSrWQJ.js";import{d as Ve}from"./Bx3Ta1aT.js";import{r as $e}from"./B90_Oxup.js";import{p as I}from"./DxTVUXYh.js";import{r as et}from"./Kh4qeMCr.js";import{w as Fe,g as tt}from"./C_BOqCMP.js";function at(r,e,t){De(()=>{var n=qe(()=>e(r,t?.())||{});if(n?.destroy)return()=>n.destroy()})}function Ce(r,e={},t,n){for(var l in t){var u=t[l];e[l]!==u&&(t[l]==null?r.style.removeProperty(l):r.style.setProperty(l,u,n))}}function Ae(r,e,t,n){var l=r.__style;if(we||l!==e){var u=Ke(e,n);(!we||u!==r.getAttribute("style"))&&(u==null?r.removeAttribute("style"):r.style.cssText=u),r.__style=e}else n&&(Array.isArray(n)?(Ce(r,t?.[0],n[0]),Ce(r,t?.[1],n[1],"important")):Ce(r,t,n));return n}function rt(r,e,t,n,l){var u=()=>{n(t[r])};t.addEventListener(e,u),l?Be(()=>{t[r]=l()}):u(),(t===document.body||t===window||t===document)&&Ne(()=>{t.removeEventListener(e,u)})}var st=g('<h2 class="svelte-6qb8f6"> </h2>'),nt=g('<div class="container svelte-6qb8f6"><!> <!></div>');function it(r,e){let t=R(e,"title",3,void 0),n=R(e,"width",3,void 0);var l=nt();let u;var v=d(l);{var i=w=>{var C=st(),x=d(C,!0);c(C),F(()=>E(x,t())),m(w,C)};D(v,w=>{t()&&w(i)})}var z=_(v,2);Ue(z,()=>e.children??Me),c(l),F(w=>u=Ae(l,"",u,w),[()=>({width:n()})]),m(r,l)}const lt=r=>{window.addEventListener("click",e);function e(t){r.contains(t.target)||r.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var ot=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],vt=["difference","intersection","symmetricDifference","union"],xe=!1;class te extends Set{#a=new Map;#e=de(0);#t=de(0);#r=ze||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}xe||this.#n()}#s(e){return ze===this.#r?de(e):je(e)}#n(){xe=!0;var e=te.prototype,t=Set.prototype;for(const n of ot)e[n]=function(...l){return a(this.#e),t[n].apply(this,l)};for(const n of vt)e[n]=function(...l){a(this.#e);var u=t[n].apply(this,l);return new te(u)}}has(e){var t=super.has(e),n=this.#a,l=n.get(e);if(l===void 0){if(!t)return a(this.#e),!1;l=this.#s(!0),n.set(e,l)}return a(l),t}add(e){return super.has(e)||(super.add(e),T(this.#t,super.size),ye(this.#e)),this}delete(e){var t=super.delete(e),n=this.#a,l=n.get(e);return l!==void 0&&(n.delete(e),T(l,!1)),t&&(T(this.#t,super.size),ye(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())T(t,!1);e.clear(),T(this.#t,0),ye(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const ct=(r,e,t)=>{T(e,new te),t.onChange(Array.from(a(e)))};var dt=(r,e,t)=>e(r.target.checked,a(t).value),ut=g('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),ft=g('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function Se(r,e){ve(e,!0);let t=K(()=>new te(e.value));const n=(A,p)=>{A?a(t).add(p):a(t).delete(p),T(t,new te(a(t))),e.onChange(Array.from(a(t)))};let l=de(!1);const u=()=>{T(l,!1)};var v=ft(),i=d(v),z=d(i);c(i);var w=_(i,2),C=d(w),x=d(C);me(x,21,()=>e.options,A=>A.value,(A,p)=>{var P=ut(),k=d(P),s=d(k),o=_(s);ke(o),o.__input=[dt,n,p],c(k),c(P),F(h=>{X(k,"for",a(p).value),E(s,`${a(p).label??""} `),X(o,"id",a(p).value),X(o,"name",a(p).value),Ge(o,a(p).value),Ye(o,h)},[()=>a(t).has(a(p).value)]),m(A,P)}),c(x);var B=_(x,2);B.__click=[ct,t,e],c(C),c(w),c(v),at(v,A=>lt?.(A)),De(()=>rt("open","toggle",v,A=>T(l,A),()=>a(l))),F(()=>{E(z,`${e.summary??""} (${a(t).size??""})`),B.disabled=a(t).size===0}),We("outsideclick",v,u),m(r,v),ce()}fe(["input","click"]);var mt=(r,e,t)=>e.onFiltersChange({...a(t)}),_t=(r,e,t)=>{a(e).type=r.target.value,t.onFiltersChange({...a(e)})},ht=g("<option> </option>"),gt=(r,e)=>e.onResetFilters(),pt=g('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function da(r,e){ve(e,!0);let t=K(()=>e.filters);const n=()=>{const v=new Set(e.cards.map(i=>i.level));return Array.from(v).sort((i,z)=>i-z)},l=()=>{const v=new Set(e.cards.flatMap(i=>i.tags));return Array.from(v).sort()},u=()=>{const v=new Set(e.cards.map(i=>i.type));return Array.from(v).sort()};it(r,{children:(v,i)=>{var z=pt(),w=d(z);ke(w),w.__input=[mt,e,t];var C=_(w,2);C.__change=[_t,t,e];var x=d(C);x.value=x.__value="";var B=_(x);me(B,16,u,k=>k,(k,s)=>{var o=ht(),h=d(o,!0);c(o);var W={};F(Q=>{E(h,Q),W!==(W=s)&&(o.value=(o.__value=s)??"")},[()=>He(s)]),m(k,o)}),c(C);var A=_(C,2);{let k=K(()=>n().map(s=>({value:s,label:`Nivel ${s}`})));Se(A,{summary:"Niveles",get options(){return a(k)},get value(){return a(t).level},onChange:s=>{a(t).level=s,e.onFiltersChange({...a(t)})}})}var p=_(A,2);{let k=K(()=>l().map(s=>({value:s.toLowerCase(),label:s})));Se(p,{summary:"Etiquetas",get options(){return a(k)},get value(){return a(t).tags},onChange:s=>{a(t).tags=s.map(o=>o.toLowerCase()),e.onFiltersChange({...a(t)})}})}var P=_(p,2);P.__click=[gt,e],c(z),Te(w,()=>a(t).name,k=>a(t).name=k),m(v,z)},$$slots:{default:!0}}),ce()}fe(["input","change","click"]);var bt=g("<label> </label>"),yt=(r,e,t,n)=>{e.max!==void 0&&typeof a(t)=="number"&&T(t,Math.min(a(t),e.max)),n()(a(t))},Ct=g('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),At=g('<button class="button svelte-1r47u3b"> </button>'),kt=g("<div><!> <span><input/> <!> <!></span></div>");function wt(r,e){ve(e,!0);let t=R(e,"label",3,void 0),n=R(e,"labelWidth",3,"normalized"),l=R(e,"readonly",3,!1),u=R(e,"onChange",3,()=>{}),v=R(e,"button",3,void 0),i=R(e,"fullWidth",3,!1),z=R(e,"placeholder",3,""),w=R(e,"textAlign",3,"center"),C=K(()=>e.value);var x=kt();let B;var A=d(x);{var p=S=>{var b=bt(),U=d(b,!0);c(b),F(()=>{le(b,1,Qe(n()),"svelte-1r47u3b"),E(U,t())}),m(S,b)};D(A,S=>{t()&&S(p)})}var P=_(A,2);let k;var s=d(P);ke(s);let o;X(s,"min",0),s.__input=[yt,e,C,u];var h=_(s,2);{var W=S=>{var b=Ct(),U=_(j(b),2);let H;var ae=d(U,!0);c(U),F(V=>{H=le(U,1,"max svelte-1r47u3b",null,H,V),E(ae,e.max)},[()=>({withButton:v()!==void 0})]),m(S,b)};D(h,S=>{e.max!==void 0&&S(W)})}var Q=_(h,2);{var Z=S=>{var b=At();b.__click=function(...H){v().onClick?.apply(this,H)};var U=d(b,!0);c(b),F(()=>{X(b,"title",v().title),b.disabled=v().disabled,E(U,v().icon)}),m(S,b)};D(Q,S=>{v()&&S(Z)})}c(P),c(x),F((S,b,U)=>{B=le(x,1,"fieldgroup svelte-1r47u3b",null,B,S),k=le(P,1,"field svelte-1r47u3b",null,k,b),X(s,"type",typeof e.value=="number"?"number":"text"),s.disabled=l(),o=le(s,1,`text-align-${w()}`,"svelte-1r47u3b",o,U),X(s,"max",e.max),X(s,"placeholder",z())},[()=>({fullWidth:i()}),()=>({inputAlone:e.max===void 0&&v()===void 0&&!i(),inputWithButton:v()!==void 0,fullWidth:i(),readonly:l()}),()=>({alone:e.max===void 0&&v()===void 0,fullWidth:i(),withButton:v()!==void 0,withButtonAndMax:e.max!==void 0&&v()!==void 0})]),Te(s,()=>a(C),S=>T(C,S)),m(r,x),ce()}fe(["input","click"]);var zt=g('<span class="chip svelte-6vztta"> </span>'),xt=g('<span class="chip svelte-6vztta"> </span>'),St=g('<span class="chip svelte-6vztta"> </span>'),Lt=g('<span class="chip svelte-6vztta"> </span>'),Et=g('<span class="chip svelte-6vztta"> </span>'),Rt=g('<div class="controls svelte-6vztta"><!></div>'),Dt=g('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function Tt(r,e){ve(e,!0);let t=R(e,"children",3,void 0);const n=f=>{switch(ue(f.length>0?String(f[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var l=Dt();let u;var v=d(l);let i;var z=_(v,2),w=d(z),C=d(w),x=d(C),B=d(x,!0);c(x);var A=_(x,2),p=d(A);c(A);var P=_(A,4),k=d(P,!0);c(P),c(C);var s=_(C,2),o=d(s,!0);c(s),c(w);var h=_(w,2),W=d(h),Q=d(W);Ze(Q,()=>Ve.parse(e.card.description)),c(W);var Z=_(W,2),S=d(Z);me(S,16,()=>e.card.tags,f=>f,(f,y)=>{var L=zt(),G=d(L,!0);c(L),F(()=>E(G,y)),m(f,L)});var b=_(S,2);{var U=f=>{var y=ee(),L=j(y);{var G=M=>{var Y=xt(),ie=d(Y);c(Y),F(()=>E(ie,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),m(M,Y)},ne=M=>{var Y=ee(),ie=j(Y);{var _e=O=>{var q=St(),ge=d(q);c(q),F(()=>E(ge,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(O,q)},he=O=>{var q=ee(),ge=j(q);{var Ie=pe=>{var be=Lt(),Oe=d(be);c(be),F(()=>E(Oe,`Usos: ${e.card.uses.qty??"?"??""}`)),m(pe,be)};D(ge,pe=>{e.card.uses.type==="USES"&&pe(Ie)},!0)}m(O,q)};D(ie,O=>{e.card.uses.type==="RELOAD"?O(_e):O(he,!1)},!0)}m(M,Y)};D(L,M=>{e.card.uses.type==="LONG_REST"?M(G):M(ne,!1)})}m(f,y)};D(b,f=>{e.card.uses.type&&f(U)})}var H=_(b,2);{var ae=f=>{var y=Et(),L=d(y);c(y),F(()=>E(L,`Costo: ${e.card.cost??""} de oro`)),m(f,y)};D(H,f=>{e.card.cardType==="item"&&f(ae)})}c(Z),c(h);var V=_(h,2),N=_(d(V),2),J=d(N),$=d(J,!0);c(J),c(N);var re=_(N,2);{var se=f=>{var y=Rt(),L=d(y);Ue(L,t),c(y),m(f,y)};D(re,f=>{t()!==void 0&&f(se)})}c(V),c(z),c(l),F((f,y,L,G)=>{u=Ae(l,"",u,f),i=Ae(v,"",i,y),E(B,e.card.cardType==="ability"?"Habilidad":"Objeto MÃ¡gico"),E(p,`Nivel ${e.card.level??""}`),E(k,L),E(o,e.card.name),E($,G)},[()=>({"border-color":n(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),m(r,l),ce()}var Ut=(r,e,t)=>e(a(t).id),Ft=g('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Pt=(r,e,t)=>e(a(t).id),It=(r,e,t)=>e(a(t).id),Ot=g("<button>Desactivar</button>"),qt=(r,e,t)=>e(a(t).id),Bt=g("<button>Activar</button>"),Nt=g('<button>Quitar</button> <span class="spacer"></span> <!>',1),Mt=(r,e,t)=>e(a(t)),jt=g('<span class="spacer"></span> <button>Agregar</button>',1),Wt=g('<div class="controls svelte-1rfcjb3"><!></div>'),Gt=g('<div class="cards svelte-1rfcjb3"></div>');function ua(r,e){ve(e,!0);let t=R(e,"readonly",3,!0),n=R(e,"characterCards",19,()=>[]),l=R(e,"listMode",3,"all"),u=R(e,"onChange",3,()=>{}),v=R(e,"onCardReloadClick",3,()=>{}),i=K(n);const z=s=>{const o=e.cards.find(h=>h.id===s);if(!o){C(s);return}T(i,a(i).map(h=>h.id===s?{...h,isActive:!1,uses:p(o)}:h)),u()(a(i))},w=s=>{T(i,a(i).map(o=>o.id===s?{...o,isActive:!0}:o)),u()(a(i))},C=s=>{T(i,a(i).filter(o=>o.id!==s)),u()(a(i))},x=s=>{T(i,[...a(i),{id:s.id,uses:p(s),isActive:!1,level:s.level,cardType:s.type}]),u()(a(i))},B=(s,o)=>{T(i,a(i).map(h=>h.id===s?{...h,uses:o}:h)),u()(a(i))},A=s=>{const o=a(i).find(h=>h.id===s);return o?o.uses:0},p=s=>{if(s.uses.type===null)return null;switch(s.uses.type){case"USES":case"LONG_REST":case"DAY":return s.uses.qty??0;case"RELOAD":return oe.RELOAD_CARD_USES;default:return null}},P=s=>{const o=a(i).find(h=>h.id===s.id);return o?o.isActive:!1};var k=Gt();me(k,21,()=>e.cards,s=>s.id,(s,o)=>{Tt(s,{get card(){return a(o)},children:(h,W)=>{var Q=ee(),Z=j(Q);{var S=b=>{var U=Wt(),H=d(U);{var ae=N=>{var J=Ft(),$=j(J);{var re=f=>{{let y=K(()=>A(a(o).id)),L=K(()=>p(a(o))),G=K(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>v()(a(o).id),disabled:A(a(o).id)===p(a(o))}));wt(f,{get value(){return a(y)},get max(){return a(L)},onChange:ne=>B(a(o).id,Number(ne)),get button(){return a(G)}})}};D($,f=>{p(a(o))!==null&&f(re)})}var se=_($,4);se.__click=[Ut,z,o],m(N,J)},V=N=>{var J=ee(),$=j(J);{var re=f=>{var y=Nt(),L=j(y);L.__click=[Pt,C,o];var G=_(L,4);{var ne=M=>{var Y=ee(),ie=j(Y);{var _e=O=>{var q=Ot();q.__click=[It,z,o],m(O,q)},he=O=>{var q=Bt();q.__click=[qt,w,o],m(O,q)};D(ie,O=>{P(a(o))?O(_e):O(he,!1)})}m(M,Y)};D(G,M=>{a(o).type==="activable"&&M(ne)})}m(f,y)},se=f=>{var y=jt(),L=_(j(y),2);L.__click=[Mt,x,o],m(f,y)};D($,f=>{l()==="collection"?f(re):f(se,!1)},!0)}m(N,J)};D(H,N=>{l()==="active"?N(ae):N(V,!1)})}c(U),m(b,U)};D(Z,b=>{t()||b(S)})}m(h,Q)},$$slots:{default:!0}})}),c(k),m(r,k),ce()}fe(["click"]);const fa=()=>({buildEmptyFilters:()=>({name:"",level:[],tags:[],type:""}),getFiltersFromURL:()=>{const n=I.url.searchParams.get("name")??"",l=I.url.searchParams.getAll("level").filter(i=>i!=="").map(Number).filter(i=>i>0),u=I.url.searchParams.getAll("tags").filter(i=>i!==""),v=I.url.searchParams.get("type")??"";return{name:n,level:l,tags:u,type:v}},updateURLFilters:n=>{n.name?I.url.searchParams.set("name",n.name):I.url.searchParams.delete("name"),n.level.length===0?I.url.searchParams.delete("level"):I.url.searchParams.set("level",n.level.join(",")),n.tags.length===0?I.url.searchParams.delete("tags"):I.url.searchParams.set("tags",n.tags.join(",")),n.type?I.url.searchParams.set("type",n.type):I.url.searchParams.delete("type");const l=I.url.searchParams.toString(),u=`${I.url.pathname}${l?`?${l}`:""}`;$e(u,{})}}),Pe=r=>{if(!r.name)throw new Error("Card name is required");return{id:Je(r.name),...r,requirements:r.requirements??[]}},Yt=r=>{const e=ue(r.length>0?String(r[0]).toLowerCase():"");return oe.ABILITY_CARD_BACKGROUNDS[e]?oe.ABILITY_CARD_BACKGROUNDS[e]:oe.ABILITY_CARD_BACKGROUNDS.default},Kt=r=>({...Pe(r),type:r.type,img:Yt(r.tags),cardType:"ability"}),Qt=r=>oe.ITEM_CARD_BACKGROUNDS.default,Ht=r=>({...Pe(r),type:r.type,cost:r.cost,img:Qt(r.tags),cardType:"item"}),Le=Fe([]),Ee=Fe([]),Re=async(r,e,t,n)=>{if(tt(t).length>0)return;const u=await(await fetch(et(r))).text();let v=[];try{v=Xe(u)[e]??[]}catch(i){console.error("Error parsing YAML:",i)}t.set(v.map(i=>n(i)).toSorted((i,z)=>i.level-z.level||i.name.localeCompare(z.name)))},ma=()=>({loadAbilityCards:async()=>{await Re("/docs/cards.yml","cards",Le,Kt)},abilityCards:Le,loadItemCards:async()=>{await Re("/docs/magical-items.yml","items",Ee,Ht)},itemCards:Ee}),_a=(r,e)=>r.filter(t=>ue(t.name.toLowerCase()).includes(ue(e.name.toLowerCase()))&&(e.level.length===0||e.level.includes(t.level))&&(e.tags.length===0||e.tags.every(n=>t.tags.map(l=>l.toLowerCase()).includes(n)))&&(!e.type||e.type===t.type));export{da as C,wt as I,ma as a,ua as b,it as c,at as d,lt as e,_a as f,fa as u};
