import"./DsnmJJEf.js";import{h as Te,u as je,i as Ie,a2 as We,aa as _e,bg as xe,ax as Ge,j as a,F as T,aO as ke,p as de,b as y,e as _,r as d,g as h,ab as H,t as M,a as m,d as ue,aW as Be,f as G,c as $,s as Qe}from"./Cg1s0EoG.js";import{d as me,s as S,e as Ye}from"./DDMpRfKd.js";import{i as F}from"./MZe84WCl.js";import{e as he,r as fe,s as Z,b as Xe,d as Oe,f as He}from"./CSZ0gJPW.js";import{b as Ue,s as ce}from"./D1fKtWIY.js";import{p as D}from"./C6xtXO8m.js";import{c as Je,r as we,l as Ke}from"./CGjaQNWU.js";import{C as Ze,s as Ee}from"./CV7z2rc6.js";import{C as V}from"./CyC3GOE6.js";import{h as Ve}from"./ZowO87gX.js";import{d as $e}from"./Bx3Ta1aT.js";import{r as et}from"./BCisOs_b.js";import{p as N}from"./DPRm5G9v.js";import{r as tt}from"./wmAA6qdB.js";import{m as at,a as st}from"./CX9tXyxk.js";import{w as Pe,g as rt}from"./CDyK6DUB.js";function lt(l,e,t){Te(()=>{var s=je(()=>e(l,t?.())||{});if(s?.destroy)return()=>s.destroy()})}function nt(l,e,t,s,o){var v=()=>{s(t[l])};t.addEventListener(e,v),o?Ie(()=>{t[l]=o()}):v(),(t===document.body||t===window||t===document)&&We(()=>{t.removeEventListener(e,v)})}const it=l=>{window.addEventListener("click",e);function e(t){l.contains(t.target)||l.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var ot=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],vt=["difference","intersection","symmetricDifference","union"],Le=!1;class re extends Set{#a=new Map;#e=_e(0);#t=_e(0);#s=xe||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}Le||this.#l()}#r(e){return xe===this.#s?_e(e):Ge(e)}#l(){Le=!0;var e=re.prototype,t=Set.prototype;for(const s of ot)e[s]=function(...o){return a(this.#e),t[s].apply(this,o)};for(const s of vt)e[s]=function(...o){a(this.#e);var v=t[s].apply(this,o);return new re(v)}}has(e){var t=super.has(e),s=this.#a,o=s.get(e);if(o===void 0){if(!t)return a(this.#e),!1;o=this.#r(!0),s.set(e,o)}return a(o),t}add(e){return super.has(e)||(super.add(e),T(this.#t,super.size),ke(this.#e)),this}delete(e){var t=super.delete(e),s=this.#a,o=s.get(e);return o!==void 0&&(s.delete(e),T(o,!1)),t&&(T(this.#t,super.size),ke(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())T(t,!1);e.clear(),T(this.#t,0),ke(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const ct=(l,e,t)=>{T(e,new re),t.onChange(Array.from(a(e)))};var dt=(l,e,t)=>e(l.target.checked,a(t).value),ut=y('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),_t=y('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function ze(l,e){de(e,!0);let t=H(()=>new re(e.value));const s=(w,C)=>{w?a(t).add(C):a(t).delete(C),T(t,new re(a(t))),e.onChange(Array.from(a(t)))};let o=_e(!1);const v=()=>{T(o,!1)};var c=_t(),r=_(c),g=_(r);d(r);var R=h(r,2),E=_(R),x=_(E);he(x,21,()=>e.options,w=>w.value,(w,C)=>{var O=ut(),U=_(O),i=_(U),n=h(i);fe(n),n.__input=[dt,s,C],d(U),d(O),M(u=>{Z(U,"for",a(C).value),S(i,`${a(C).label??""} `),Z(n,"id",a(C).value),Z(n,"name",a(C).value),Xe(n,a(C).value),Oe(n,u)},[()=>a(t).has(a(C).value)]),m(w,O)}),d(x);var q=h(x,2);q.__click=[ct,t,e],d(E),d(R),d(c),lt(c,w=>it?.(w)),Te(()=>nt("open","toggle",c,w=>T(o,w),()=>a(o))),M(()=>{S(g,`${e.summary??""} (${a(t).size??""})`),q.disabled=a(t).size===0}),Ye("outsideclick",c,v),m(l,c),ue()}me(["input","click"]);var ft=(l,e,t)=>e.onFiltersChange({...a(t)}),mt=(l,e,t)=>{a(e).type=l.target.value,t.onFiltersChange({...a(e)})},ht=y("<option> </option>"),bt=(l,e,t)=>{a(e).onlyAvailables=l.target.checked,t.onFiltersChange({...a(e)})},gt=y('<div class="only-availables-field svelte-1o8sb8t"><label for="only-availables" class="svelte-1o8sb8t"><input type="checkbox" id="only-availables" class="svelte-1o8sb8t"/>Ver Solo disponibles</label></div>'),pt=(l,e)=>e.onResetFilters(),yt=y('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <!> <button>Limpiar Filtros</button></div>');function _a(l,e){de(e,!0);let t=D(e,"includeOnlyAvailablesFilter",3,!1),s=H(()=>e.filters);const o=()=>{const r=new Set(e.cards.map(g=>g.level));return Array.from(r).sort((g,R)=>g-R)},v=()=>{const r=new Set(e.cards.flatMap(g=>g.tags));return Array.from(r).sort()},c=()=>{const r=new Set(e.cards.map(g=>g.type));return Array.from(r).sort()};Ze(l,{children:(r,g)=>{var R=yt(),E=_(R);fe(E),E.__input=[ft,e,s];var x=h(E,2);x.__change=[mt,s,e];var q=_(x);q.value=q.__value="";var w=h(q);he(w,16,c,u=>u,(u,p)=>{var z=ht(),I=_(z,!0);d(z);var A={};M(b=>{S(I,b),A!==(A=p)&&(z.value=(z.__value=p)??"")},[()=>Je(p)]),m(u,z)}),d(x);var C=h(x,2);{let u=H(()=>o().map(p=>({value:p,label:`Nivel ${p}`})));ze(C,{summary:"Niveles",get options(){return a(u)},get value(){return a(s).level},onChange:p=>{a(s).level=p,e.onFiltersChange({...a(s)})}})}var O=h(C,2);{let u=H(()=>v().map(p=>({value:p.toLowerCase(),label:p})));ze(O,{summary:"Etiquetas",get options(){return a(u)},get value(){return a(s).tags},onChange:p=>{a(s).tags=p.map(z=>z.toLowerCase()),e.onFiltersChange({...a(s)})}})}var U=h(O,2);{var i=u=>{var p=gt(),z=_(p),I=_(z);fe(I),I.__input=[bt,s,e],Be(),d(z),d(p),M(()=>Oe(I,a(s).onlyAvailables)),m(u,p)};F(U,u=>{t()&&u(i)})}var n=h(U,2);n.__click=[pt,e],d(R),Ue(E,()=>a(s).name,u=>a(s).name=u),m(r,R)},$$slots:{default:!0}}),ue()}me(["input","change","click"]);var Ct=y("<label> </label>"),At=(l,e,t,s)=>{e.max!==void 0&&typeof a(t)=="number"&&T(t,Math.min(a(t),e.max)),s()(a(t))},kt=y('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),wt=y('<button class="button svelte-1r47u3b"> </button>'),xt=y("<div><!> <span><input/> <!> <!></span></div>");function Et(l,e){de(e,!0);let t=D(e,"label",3,void 0),s=D(e,"labelWidth",3,"normalized"),o=D(e,"readonly",3,!1),v=D(e,"onChange",3,()=>{}),c=D(e,"button",3,void 0),r=D(e,"fullWidth",3,!1),g=D(e,"placeholder",3,""),R=D(e,"textAlign",3,"center"),E=H(()=>e.value);var x=xt();let q;var w=_(x);{var C=A=>{var b=Ct(),P=_(b,!0);d(b),M(()=>{ce(b,1,He(s()),"svelte-1r47u3b"),S(P,t())}),m(A,b)};F(w,A=>{t()&&A(C)})}var O=h(w,2);let U;var i=_(O);fe(i);let n;Z(i,"min",0),i.__input=[At,e,E,v];var u=h(i,2);{var p=A=>{var b=kt(),P=h(G(b),2);let J;var le=_(P,!0);d(P),M(ee=>{J=ce(P,1,"max svelte-1r47u3b",null,J,ee),S(le,e.max)},[()=>({withButton:c()!==void 0})]),m(A,b)};F(u,A=>{e.max!==void 0&&A(p)})}var z=h(u,2);{var I=A=>{var b=wt();b.__click=function(...J){c().onClick?.apply(this,J)};var P=_(b,!0);d(b),M(()=>{Z(b,"title",c().title),b.disabled=c().disabled,S(P,c().icon)}),m(A,b)};F(z,A=>{c()&&A(I)})}d(O),d(x),M((A,b,P)=>{q=ce(x,1,"fieldgroup svelte-1r47u3b",null,q,A),U=ce(O,1,"field svelte-1r47u3b",null,U,b),Z(i,"type",typeof e.value=="number"?"number":"text"),i.disabled=o(),n=ce(i,1,`text-align-${R()}`,"svelte-1r47u3b",n,P),Z(i,"max",e.max),Z(i,"placeholder",g())},[()=>({fullWidth:r()}),()=>({inputAlone:e.max===void 0&&c()===void 0&&!r(),inputWithButton:c()!==void 0,fullWidth:r(),readonly:o()}),()=>({alone:e.max===void 0&&c()===void 0,fullWidth:r(),withButton:c()!==void 0,withButtonAndMax:e.max!==void 0&&c()!==void 0})]),Ue(i,()=>a(E),A=>T(E,A)),m(l,x),ue()}me(["input","click"]);var Lt=y('<span class="chip svelte-6vztta"> </span>'),zt=y('<span class="chip svelte-6vztta"> </span>'),St=y('<span class="chip svelte-6vztta"> </span>'),Ft=y('<span class="chip svelte-6vztta"> </span>'),Rt=y('<span class="chip svelte-6vztta"> </span>'),Tt=y('<span class="chip svelte-6vztta"> </span>'),Ot=y('<div class="controls svelte-6vztta"><!></div>'),Ut=y('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function Pt(l,e){de(e,!0);let t=D(e,"children",3,void 0);const s=f=>{switch(we(f.length>0?String(f[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var o=Ut();let v;var c=_(o);let r;var g=h(c,2),R=_(g),E=_(R),x=_(E),q=_(x,!0);d(x);var w=h(x,2),C=_(w);d(w);var O=h(w,4),U=_(O,!0);d(O),d(E);var i=h(E,2),n=_(i,!0);d(i),d(R);var u=h(R,2),p=_(u),z=_(p);Ve(z,()=>$e.parse(e.card.description)),d(p);var I=h(p,2),A=_(I);he(A,16,()=>e.card.tags,f=>f,(f,k)=>{var L=Lt(),Y=_(L,!0);d(L),M(()=>S(Y,k)),m(f,L)});var b=h(A,2);{var P=f=>{var k=$(),L=G(k);{var Y=Q=>{var X=zt(),ve=_(X);d(X),M(()=>S(ve,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),m(Q,X)},oe=Q=>{var X=$(),ve=G(X);{var be=j=>{var W=St(),pe=_(W);d(W),M(()=>S(pe,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a`)),m(j,W)},ge=j=>{var W=$(),pe=G(W);{var De=ae=>{var se=Ft(),ye=_(se);d(se),M(()=>S(ye,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(ae,se)},Me=ae=>{var se=$(),ye=G(se);{var Ne=Ce=>{var Ae=Rt(),qe=_(Ae);d(Ae),M(()=>S(qe,`Usos: ${e.card.uses.qty??"?"??""}`)),m(Ce,Ae)};F(ye,Ce=>{e.card.uses.type==="USES"&&Ce(Ne)},!0)}m(ae,se)};F(pe,ae=>{e.card.uses.type==="RELOAD"?ae(De):ae(Me,!1)},!0)}m(j,W)};F(ve,j=>{e.card.uses.type==="DAY"?j(be):j(ge,!1)},!0)}m(Q,X)};F(L,Q=>{e.card.uses.type==="LONG_REST"?Q(Y):Q(oe,!1)})}m(f,k)};F(b,f=>{e.card.uses.type&&f(P)})}var J=h(b,2);{var le=f=>{var k=Tt(),L=_(k);d(k),M(()=>S(L,`Costo: ${e.card.cost??""} de oro`)),m(f,k)};F(J,f=>{e.card.cardType==="item"&&f(le)})}d(I),d(u);var ee=h(u,2),B=h(_(ee),2),K=_(B),te=_(K,!0);d(K),d(B);var ne=h(B,2);{var ie=f=>{var k=Ot(),L=_(k);Qe(L,t),d(k),m(f,k)};F(ne,f=>{t()!==void 0&&f(ie)})}d(ee),d(g),d(o),M((f,k,L,Y)=>{v=Ee(o,"",v,f),r=Ee(c,"",r,k),S(q,e.card.cardType==="ability"?"Habilidad":"Objeto MÃ¡gico"),S(C,`Nivel ${e.card.level??""}`),S(U,L),S(n,e.card.name),S(te,Y)},[()=>({"border-color":s(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),m(l,o),ue()}var Dt=(l,e,t)=>e(a(t).id),Mt=y('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Nt=(l,e,t)=>e(a(t).id),qt=(l,e,t)=>e(a(t).id),jt=y("<button>Desactivar</button>"),It=(l,e,t)=>e(a(t).id),Wt=y("<button>Activar</button>"),Gt=y('<button>Quitar</button> <span class="spacer"></span> <!>',1),Bt=(l,e,t)=>e(a(t)),Qt=y('<span class="spacer"></span> <button>Agregar</button>',1),Yt=y('<div class="controls svelte-1rfcjb3"><!></div>'),Xt=y('<div class="cards svelte-1rfcjb3"></div>');function fa(l,e){de(e,!0);let t=D(e,"readonly",3,!0),s=D(e,"characterCards",19,()=>[]),o=D(e,"listMode",3,"all"),v=D(e,"onChange",3,()=>{}),c=D(e,"onCardReloadClick",3,()=>{}),r=H(s);const g=i=>{const n=e.cards.find(u=>u.id===i);if(!n){E(i);return}T(r,a(r).map(u=>u.id===i?{...u,isActive:!1,uses:C(n)}:u)),v()(a(r))},R=i=>{T(r,a(r).map(n=>n.id===i?{...n,isActive:!0}:n)),v()(a(r))},E=i=>{T(r,a(r).filter(n=>n.id!==i)),v()(a(r))},x=i=>{T(r,[...a(r),{id:i.id,uses:C(i),isActive:!1,level:i.level,cardType:i.type}]),v()(a(r))},q=(i,n)=>{T(r,a(r).map(u=>u.id===i?{...u,uses:n}:u)),v()(a(r))},w=i=>{const n=a(r).find(u=>u.id===i);return n?n.uses:0},C=i=>{if(i.uses.type===null)return null;switch(i.uses.type){case"USES":case"LONG_REST":case"DAY":return i.uses.qty??0;case"RELOAD":return V.RELOAD_CARD_USES;default:return null}},O=i=>{const n=a(r).find(u=>u.id===i.id);return n?n.isActive:!1};var U=Xt();he(U,21,()=>e.cards,i=>i.id,(i,n)=>{Pt(i,{get card(){return a(n)},children:(u,p)=>{var z=$(),I=G(z);{var A=b=>{var P=Yt(),J=_(P);{var le=B=>{var K=Mt(),te=G(K);{var ne=f=>{{let k=H(()=>w(a(n).id)),L=H(()=>C(a(n))),Y=H(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>c()(a(n).id),disabled:w(a(n).id)===C(a(n))}));Et(f,{get value(){return a(k)},get max(){return a(L)},onChange:oe=>q(a(n).id,Number(oe)),get button(){return a(Y)}})}};F(te,f=>{C(a(n))!==null&&f(ne)})}var ie=h(te,4);ie.__click=[Dt,g,n],m(B,K)},ee=B=>{var K=$(),te=G(K);{var ne=f=>{var k=Gt(),L=G(k);L.__click=[Nt,E,n];var Y=h(L,4);{var oe=Q=>{var X=$(),ve=G(X);{var be=j=>{var W=jt();W.__click=[qt,g,n],m(j,W)},ge=j=>{var W=Wt();W.__click=[It,R,n],m(j,W)};F(ve,j=>{O(a(n))?j(be):j(ge,!1)})}m(Q,X)};F(Y,Q=>{a(n).type==="activable"&&Q(oe)})}m(f,k)},ie=f=>{var k=Qt(),L=h(G(k),2);L.__click=[Bt,x,n],m(f,k)};F(te,f=>{o()==="collection"?f(ne):f(ie,!1)},!0)}m(B,K)};F(J,B=>{o()==="active"?B(le):B(ee,!1)})}d(P),m(b,P)};F(I,b=>{t()||b(A)})}m(u,z)},$$slots:{default:!0}})}),d(U),m(l,U),ue()}me(["click"]);const ma=()=>({buildEmptyFilters:({onlyAvailables:s}={onlyAvailables:void 0})=>({name:"",level:[],tags:[],type:"",onlyAvailables:s}),getFiltersFromURL:()=>{const s=N.url.searchParams.get("name")??"",o=N.url.searchParams.getAll("level").filter(r=>r!=="").map(Number).filter(r=>r>0),v=N.url.searchParams.getAll("tags").filter(r=>r!==""),c=N.url.searchParams.get("type")??"";return{name:s,level:o,tags:v,type:c}},updateURLFilters:s=>{s.name?N.url.searchParams.set("name",s.name):N.url.searchParams.delete("name"),s.level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",s.level.join(",")),s.tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",s.tags.join(",")),s.type?N.url.searchParams.set("type",s.type):N.url.searchParams.delete("type");const o=N.url.searchParams.toString(),v=`${N.url.pathname}${o?`?${o}`:""}`;et(v,{})}}),Se=Pe([]),Fe=Pe([]),Re=async(l,e,t,s)=>{if(rt(t).length>0)return;const v=await(await fetch(tt(l))).text();let c=[];try{c=Ke(v)[e]??[]}catch(r){console.error("Error parsing YAML:",r)}t.set(c.map(r=>s(r)).toSorted((r,g)=>r.level-g.level||r.tags.join("|").localeCompare(g.tags.join("|"))||r.name.localeCompare(g.name)))},ha=()=>({loadAbilityCards:async()=>{await Re("/docs/cards.yml","cards",Se,at)},abilityCards:Se,loadItemCards:async()=>{await Re("/docs/magical-items.yml","items",Fe,st)},itemCards:Fe}),ba=(l,e,t=void 0)=>{let s=[],o=!1;return t&&e.onlyAvailables&&(s=Ht(l,t),o=!0),l.filter(v=>{let c=we(e.name.toLowerCase()).split("|").filter(r=>r.length>0);return c.length===0&&(c=[""]),c.some(r=>we(v.name.toLowerCase()).includes(r))&&(e.level.length===0||e.level.includes(v.level))&&(e.tags.length===0||e.tags.every(r=>v.tags.map(g=>g.toLowerCase()).includes(r)))&&(!e.type||e.type===v.type)&&(!o||Jt(v,s))})},Ht=(l,e)=>{const t=[];for(const v of Object.keys(V.ATTR_NAME_MAP))for(let c=1;c<=e.attributes[v];c++)t.push(`${V.ATTR_NAME_MAP[v]} ${c}`.toLowerCase());const s=l.filter(v=>e.cards.find(c=>c.id===v.id));for(const v of s)t.push(v.name.toLowerCase());const o=l.filter(v=>v.tags.includes(V.LINEAGE_CARD_TAG)&&e.cards.find(c=>c.id===v.id)).length;return e.cards.length<=V.MAX_CARDS_TO_INCLUDE_LINEAGES&&o<V.MAX_LINEAGE_CARDS&&t.push(V.LINEAGE_REQUIREMENT.toLowerCase()),t},Jt=(l,e)=>l.requirements.find(t=>t.toLowerCase().startsWith("o "))?l.requirements.some(t=>e.includes(t.toLowerCase().replace("o ",""))):l.requirements.every(t=>e.includes(t.toLowerCase()));export{_a as C,Et as I,ha as a,fa as b,lt as c,it as d,ba as f,ma as u};
