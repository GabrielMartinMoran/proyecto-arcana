import"./DsnmJJEf.js";import{F as Te,I as Ie,G as je,a1 as Ge,a2 as _e,b7 as xe,aV as We,g as a,O as T,b8 as ke,aF as me,p as de,f as y,d as _,r as d,s as h,aG as X,t as M,e as S,aL as Be,b as m,c as ue,b6 as Qe,a as W,aH as $,aP as Ye}from"./DLXWS9Me.js";import{i as F}from"./sk9sCnVa.js";import{e as he,c as He}from"./DqBPzmir.js";import{r as fe,s as V,a as Xe,c as Oe}from"./YdHDDrJh.js";import{b as Pe}from"./CwyfYjnX.js";import{p as D}from"./B0W8Y-cb.js";import{b as Je,r as we,l as Ke}from"./BQL_5efD.js";import{C as Ve,s as Le}from"./QFUiQZjY.js";import{C as Z}from"./CyC3GOE6.js";import{s as ce}from"./DvREelRX.js";import{h as Ze}from"./Dx5HDuOT.js";import{d as $e}from"./Bx3Ta1aT.js";import{r as et}from"./BlEGOwK4.js";import{p as N}from"./BtKI8q5M.js";import{r as tt}from"./C9C7sEQ-.js";import{m as at,a as st}from"./CaGjeo4y.js";import{w as Ue,g as rt}from"./0JtrQ17s.js";function lt(l,e,t){Te(()=>{var s=Ie(()=>e(l,t?.())||{});if(s?.destroy)return()=>s.destroy()})}function nt(l,e,t,s,o){var v=()=>{s(t[l])};t.addEventListener(e,v),o?je(()=>{t[l]=o()}):v(),(t===document.body||t===window||t===document)&&Ge(()=>{t.removeEventListener(e,v)})}const it=l=>{window.addEventListener("click",e);function e(t){l.contains(t.target)||l.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var ot=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],vt=["difference","intersection","symmetricDifference","union"],Ee=!1;class re extends Set{#a=new Map;#e=_e(0);#t=_e(0);#s=xe||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}Ee||this.#l()}#r(e){return xe===this.#s?_e(e):We(e)}#l(){Ee=!0;var e=re.prototype,t=Set.prototype;for(const s of ot)e[s]=function(...o){return a(this.#e),t[s].apply(this,o)};for(const s of vt)e[s]=function(...o){a(this.#e);var v=t[s].apply(this,o);return new re(v)}}has(e){var t=super.has(e),s=this.#a,o=s.get(e);if(o===void 0){if(!t)return a(this.#e),!1;o=this.#r(!0),s.set(e,o)}return a(o),t}add(e){return super.has(e)||(super.add(e),T(this.#t,super.size),ke(this.#e)),this}delete(e){var t=super.delete(e),s=this.#a,o=s.get(e);return o!==void 0&&(s.delete(e),T(o,!1)),t&&(T(this.#t,super.size),ke(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())T(t,!1);e.clear(),T(this.#t,0),ke(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const ct=(l,e,t)=>{T(e,new re),t.onChange(Array.from(a(e)))};var dt=(l,e,t)=>e(l.target.checked,a(t).value),ut=y('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),_t=y('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function ze(l,e){de(e,!0);let t=X(()=>new re(e.value));const s=(w,C)=>{w?a(t).add(C):a(t).delete(C),T(t,new re(a(t))),e.onChange(Array.from(a(t)))};let o=_e(!1);const v=()=>{T(o,!1)};var c=_t(),r=_(c),g=_(r);d(r);var R=h(r,2),L=_(R),x=_(L);he(x,21,()=>e.options,w=>w.value,(w,C)=>{var O=ut(),P=_(O),i=_(P),n=h(i);fe(n),n.__input=[dt,s,C],d(P),d(O),M(u=>{V(P,"for",a(C).value),S(i,`${a(C).label??""} `),V(n,"id",a(C).value),V(n,"name",a(C).value),Xe(n,a(C).value),Oe(n,u)},[()=>a(t).has(a(C).value)]),m(w,O)}),d(x);var q=h(x,2);q.__click=[ct,t,e],d(L),d(R),d(c),lt(c,w=>it?.(w)),Te(()=>nt("open","toggle",c,w=>T(o,w),()=>a(o))),M(()=>{S(g,`${e.summary??""} (${a(t).size??""})`),q.disabled=a(t).size===0}),Be("outsideclick",c,v),m(l,c),ue()}me(["input","click"]);var ft=(l,e,t)=>e.onFiltersChange({...a(t)}),mt=(l,e,t)=>{a(e).type=l.target.value,t.onFiltersChange({...a(e)})},ht=y("<option> </option>"),bt=(l,e,t)=>{a(e).onlyAvailables=l.target.checked,t.onFiltersChange({...a(e)})},gt=y('<div class="only-availables-field svelte-1o8sb8t"><label for="only-availables" class="svelte-1o8sb8t"><input type="checkbox" id="only-availables" class="svelte-1o8sb8t"/>Ver Solo disponibles</label></div>'),pt=(l,e)=>e.onResetFilters(),yt=y('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <!> <button>Limpiar Filtros</button></div>');function fa(l,e){de(e,!0);let t=D(e,"includeOnlyAvailablesFilter",3,!1),s=X(()=>e.filters);const o=()=>{const r=new Set(e.cards.map(g=>g.level));return Array.from(r).sort((g,R)=>g-R)},v=()=>{const r=new Set(e.cards.flatMap(g=>g.tags));return Array.from(r).sort()},c=()=>{const r=new Set(e.cards.map(g=>g.type));return Array.from(r).sort()};Ve(l,{children:(r,g)=>{var R=yt(),L=_(R);fe(L),L.__input=[ft,e,s];var x=h(L,2);x.__change=[mt,s,e];var q=_(x);q.value=q.__value="";var w=h(q);he(w,16,c,u=>u,(u,p)=>{var z=ht(),j=_(z,!0);d(z);var A={};M(b=>{S(j,b),A!==(A=p)&&(z.value=(z.__value=p)??"")},[()=>Je(p)]),m(u,z)}),d(x);var C=h(x,2);{let u=X(()=>o().map(p=>({value:p,label:`Nivel ${p}`})));ze(C,{summary:"Niveles",get options(){return a(u)},get value(){return a(s).level},onChange:p=>{a(s).level=p,e.onFiltersChange({...a(s)})}})}var O=h(C,2);{let u=X(()=>v().map(p=>({value:p.toLowerCase(),label:p})));ze(O,{summary:"Etiquetas",get options(){return a(u)},get value(){return a(s).tags},onChange:p=>{a(s).tags=p.map(z=>z.toLowerCase()),e.onFiltersChange({...a(s)})}})}var P=h(O,2);{var i=u=>{var p=gt(),z=_(p),j=_(z);fe(j),j.__input=[bt,s,e],Qe(),d(z),d(p),M(()=>Oe(j,a(s).onlyAvailables)),m(u,p)};F(P,u=>{t()&&u(i)})}var n=h(P,2);n.__click=[pt,e],d(R),Pe(L,()=>a(s).name,u=>a(s).name=u),m(r,R)},$$slots:{default:!0}}),ue()}me(["input","change","click"]);var Ct=y("<label> </label>"),At=(l,e,t,s)=>{e.max!==void 0&&typeof a(t)=="number"&&T(t,Math.min(a(t),e.max)),s()(a(t))},kt=y('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),wt=y('<button class="button svelte-1r47u3b"> </button>'),xt=y("<div><!> <span><input/> <!> <!></span></div>");function Lt(l,e){de(e,!0);let t=D(e,"label",3,void 0),s=D(e,"labelWidth",3,"normalized"),o=D(e,"readonly",3,!1),v=D(e,"onChange",3,()=>{}),c=D(e,"button",3,void 0),r=D(e,"fullWidth",3,!1),g=D(e,"placeholder",3,""),R=D(e,"textAlign",3,"center"),L=X(()=>e.value);var x=xt();let q;var w=_(x);{var C=A=>{var b=Ct(),U=_(b,!0);d(b),M(()=>{ce(b,1,He(s()),"svelte-1r47u3b"),S(U,t())}),m(A,b)};F(w,A=>{t()&&A(C)})}var O=h(w,2);let P;var i=_(O);fe(i);let n;V(i,"min",0),i.__input=[At,e,L,v];var u=h(i,2);{var p=A=>{var b=kt(),U=h(W(b),2);let J;var le=_(U,!0);d(U),M(ee=>{J=ce(U,1,"max svelte-1r47u3b",null,J,ee),S(le,e.max)},[()=>({withButton:c()!==void 0})]),m(A,b)};F(u,A=>{e.max!==void 0&&A(p)})}var z=h(u,2);{var j=A=>{var b=wt();b.__click=function(...J){c().onClick?.apply(this,J)};var U=_(b,!0);d(b),M(()=>{V(b,"title",c().title),b.disabled=c().disabled,S(U,c().icon)}),m(A,b)};F(z,A=>{c()&&A(j)})}d(O),d(x),M((A,b,U)=>{q=ce(x,1,"fieldgroup svelte-1r47u3b",null,q,A),P=ce(O,1,"field svelte-1r47u3b",null,P,b),V(i,"type",typeof e.value=="number"?"number":"text"),i.disabled=o(),n=ce(i,1,`text-align-${R()}`,"svelte-1r47u3b",n,U),V(i,"max",e.max),V(i,"placeholder",g())},[()=>({fullWidth:r()}),()=>({inputAlone:e.max===void 0&&c()===void 0&&!r(),inputWithButton:c()!==void 0,fullWidth:r(),readonly:o()}),()=>({alone:e.max===void 0&&c()===void 0,fullWidth:r(),withButton:c()!==void 0,withButtonAndMax:e.max!==void 0&&c()!==void 0})]),Pe(i,()=>a(L),A=>T(L,A)),m(l,x),ue()}me(["input","click"]);var Et=y('<span class="chip svelte-6vztta"> </span>'),zt=y('<span class="chip svelte-6vztta"> </span>'),St=y('<span class="chip svelte-6vztta"> </span>'),Ft=y('<span class="chip svelte-6vztta"> </span>'),Rt=y('<span class="chip svelte-6vztta"> </span>'),Tt=y('<span class="chip svelte-6vztta"> </span>'),Ot=y('<div class="controls svelte-6vztta"><!></div>'),Pt=y('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function Ut(l,e){de(e,!0);let t=D(e,"children",3,void 0);const s=f=>{switch(we(f.length>0?String(f[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var o=Pt();let v;var c=_(o);let r;var g=h(c,2),R=_(g),L=_(R),x=_(L),q=_(x,!0);d(x);var w=h(x,2),C=_(w);d(w);var O=h(w,4),P=_(O,!0);d(O),d(L);var i=h(L,2),n=_(i,!0);d(i),d(R);var u=h(R,2),p=_(u),z=_(p);Ze(z,()=>$e.parse(e.card.description)),d(p);var j=h(p,2),A=_(j);he(A,16,()=>e.card.tags,f=>f,(f,k)=>{var E=Et(),Y=_(E,!0);d(E),M(()=>S(Y,k)),m(f,E)});var b=h(A,2);{var U=f=>{var k=$(),E=W(k);{var Y=Q=>{var H=zt(),ve=_(H);d(H),M(()=>S(ve,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),m(Q,H)},oe=Q=>{var H=$(),ve=W(H);{var be=I=>{var G=St(),pe=_(G);d(G),M(()=>S(pe,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a`)),m(I,G)},ge=I=>{var G=$(),pe=W(G);{var De=ae=>{var se=Ft(),ye=_(se);d(se),M(()=>S(ye,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(ae,se)},Me=ae=>{var se=$(),ye=W(se);{var Ne=Ce=>{var Ae=Rt(),qe=_(Ae);d(Ae),M(()=>S(qe,`Usos: ${e.card.uses.qty??"?"??""}`)),m(Ce,Ae)};F(ye,Ce=>{e.card.uses.type==="USES"&&Ce(Ne)},!0)}m(ae,se)};F(pe,ae=>{e.card.uses.type==="RELOAD"?ae(De):ae(Me,!1)},!0)}m(I,G)};F(ve,I=>{e.card.uses.type==="DAY"?I(be):I(ge,!1)},!0)}m(Q,H)};F(E,Q=>{e.card.uses.type==="LONG_REST"?Q(Y):Q(oe,!1)})}m(f,k)};F(b,f=>{e.card.uses.type&&f(U)})}var J=h(b,2);{var le=f=>{var k=Tt(),E=_(k);d(k),M(()=>S(E,`Costo: ${e.card.cost??""} de oro`)),m(f,k)};F(J,f=>{e.card.cardType==="item"&&f(le)})}d(j),d(u);var ee=h(u,2),B=h(_(ee),2),K=_(B),te=_(K,!0);d(K),d(B);var ne=h(B,2);{var ie=f=>{var k=Ot(),E=_(k);Ye(E,t),d(k),m(f,k)};F(ne,f=>{t()!==void 0&&f(ie)})}d(ee),d(g),d(o),M((f,k,E,Y)=>{v=Le(o,"",v,f),r=Le(c,"",r,k),S(q,e.card.cardType==="ability"?"Habilidad":"Objeto MÃ¡gico"),S(C,`Nivel ${e.card.level??""}`),S(P,E),S(n,e.card.name),S(te,Y)},[()=>({"border-color":s(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),m(l,o),ue()}var Dt=(l,e,t)=>e(a(t).id),Mt=y('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Nt=(l,e,t)=>e(a(t).id),qt=(l,e,t)=>e(a(t).id),It=y("<button>Desactivar</button>"),jt=(l,e,t)=>e(a(t).id),Gt=y("<button>Activar</button>"),Wt=y('<button>Quitar</button> <span class="spacer"></span> <!>',1),Bt=(l,e,t)=>e(a(t)),Qt=y('<span class="spacer"></span> <button>Agregar</button>',1),Yt=y('<div class="controls svelte-1rfcjb3"><!></div>'),Ht=y('<div class="cards svelte-1rfcjb3"></div>');function ma(l,e){de(e,!0);let t=D(e,"readonly",3,!0),s=D(e,"characterCards",19,()=>[]),o=D(e,"listMode",3,"all"),v=D(e,"onChange",3,()=>{}),c=D(e,"onCardReloadClick",3,()=>{}),r=X(s);const g=i=>{const n=e.cards.find(u=>u.id===i);if(!n){L(i);return}T(r,a(r).map(u=>u.id===i?{...u,isActive:!1,uses:C(n)}:u)),v()(a(r))},R=i=>{T(r,a(r).map(n=>n.id===i?{...n,isActive:!0}:n)),v()(a(r))},L=i=>{T(r,a(r).filter(n=>n.id!==i)),v()(a(r))},x=i=>{T(r,[...a(r),{id:i.id,uses:C(i),isActive:!1,level:i.level,cardType:i.type}]),v()(a(r))},q=(i,n)=>{T(r,a(r).map(u=>u.id===i?{...u,uses:n}:u)),v()(a(r))},w=i=>{const n=a(r).find(u=>u.id===i);return n?n.uses:0},C=i=>{if(i.uses.type===null)return null;switch(i.uses.type){case"USES":case"LONG_REST":case"DAY":return i.uses.qty??0;case"RELOAD":return Z.RELOAD_CARD_USES;default:return null}},O=i=>{const n=a(r).find(u=>u.id===i.id);return n?n.isActive:!1};var P=Ht();he(P,21,()=>e.cards,i=>i.id,(i,n)=>{Ut(i,{get card(){return a(n)},children:(u,p)=>{var z=$(),j=W(z);{var A=b=>{var U=Yt(),J=_(U);{var le=B=>{var K=Mt(),te=W(K);{var ne=f=>{{let k=X(()=>w(a(n).id)),E=X(()=>C(a(n))),Y=X(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>c()(a(n).id),disabled:w(a(n).id)===C(a(n))}));Lt(f,{get value(){return a(k)},get max(){return a(E)},onChange:oe=>q(a(n).id,Number(oe)),get button(){return a(Y)}})}};F(te,f=>{C(a(n))!==null&&f(ne)})}var ie=h(te,4);ie.__click=[Dt,g,n],m(B,K)},ee=B=>{var K=$(),te=W(K);{var ne=f=>{var k=Wt(),E=W(k);E.__click=[Nt,L,n];var Y=h(E,4);{var oe=Q=>{var H=$(),ve=W(H);{var be=I=>{var G=It();G.__click=[qt,g,n],m(I,G)},ge=I=>{var G=Gt();G.__click=[jt,R,n],m(I,G)};F(ve,I=>{O(a(n))?I(be):I(ge,!1)})}m(Q,H)};F(Y,Q=>{a(n).type==="activable"&&Q(oe)})}m(f,k)},ie=f=>{var k=Qt(),E=h(W(k),2);E.__click=[Bt,x,n],m(f,k)};F(te,f=>{o()==="collection"?f(ne):f(ie,!1)},!0)}m(B,K)};F(J,B=>{o()==="active"?B(le):B(ee,!1)})}d(U),m(b,U)};F(j,b=>{t()||b(A)})}m(u,z)},$$slots:{default:!0}})}),d(P),m(l,P),ue()}me(["click"]);const ha=()=>({buildEmptyFilters:({onlyAvailables:s}={onlyAvailables:void 0})=>({name:"",level:[],tags:[],type:"",onlyAvailables:s}),getFiltersFromURL:()=>{const s=N.url.searchParams.get("name")??"",o=N.url.searchParams.getAll("level").filter(r=>r!=="").map(Number).filter(r=>r>0),v=N.url.searchParams.getAll("tags").filter(r=>r!==""),c=N.url.searchParams.get("type")??"";return{name:s,level:o,tags:v,type:c}},updateURLFilters:s=>{s.name?N.url.searchParams.set("name",s.name):N.url.searchParams.delete("name"),s.level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",s.level.join(",")),s.tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",s.tags.join(",")),s.type?N.url.searchParams.set("type",s.type):N.url.searchParams.delete("type");const o=N.url.searchParams.toString(),v=`${N.url.pathname}${o?`?${o}`:""}`;et(v,{})}}),Se=Ue([]),Fe=Ue([]),Re=async(l,e,t,s)=>{if(rt(t).length>0)return;const v=await(await fetch(tt(l))).text();let c=[];try{c=Ke(v)[e]??[]}catch(r){console.error("Error parsing YAML:",r)}t.set(c.map(r=>s(r)).toSorted((r,g)=>r.level-g.level||r.tags.join("|").localeCompare(g.tags.join("|"))||r.name.localeCompare(g.name)))},ba=()=>({loadAbilityCards:async()=>{await Re("/docs/cards.yml","cards",Se,at)},abilityCards:Se,loadItemCards:async()=>{await Re("/docs/magical-items.yml","items",Fe,st)},itemCards:Fe}),ga=(l,e,t=void 0)=>{let s=[],o=!1;return t&&e.onlyAvailables&&(s=Xt(l,t),o=!0),l.filter(v=>{let c=we(e.name.toLowerCase()).split("|").filter(r=>r.length>0);return c.length===0&&(c=[""]),c.some(r=>we(v.name.toLowerCase()).includes(r))&&(e.level.length===0||e.level.includes(v.level))&&(e.tags.length===0||e.tags.every(r=>v.tags.map(g=>g.toLowerCase()).includes(r)))&&(!e.type||e.type===v.type)&&(!o||Jt(v,s))})},Xt=(l,e)=>{const t=[];for(const v of Object.keys(Z.ATTR_NAME_MAP))for(let c=1;c<=e.attributes[v];c++)t.push(`${Z.ATTR_NAME_MAP[v]} ${c}`.toLowerCase());const s=l.filter(v=>e.cards.find(c=>c.id===v.id));for(const v of s)t.push(v.name.toLowerCase());const o=l.filter(v=>v.tags.includes(Z.LINEAGE_CARD_TAG)&&e.cards.find(c=>c.id===v.id)).length;return e.cards.length<=Z.MAX_CARDS_TO_INCLUDE_LINEAGES&&o<Z.MAX_LINEAGE_CARDS&&t.push(Z.LINEAGE_REQUIREMENT.toLowerCase()),t},Jt=(l,e)=>l.requirements.find(t=>t.toLowerCase().startsWith("o "))?l.requirements.some(t=>e.includes(t.toLowerCase().replace("o ",""))):l.requirements.every(t=>e.includes(t.toLowerCase()));export{fa as C,Lt as I,ba as a,ma as b,lt as c,it as d,ga as f,ha as u};
