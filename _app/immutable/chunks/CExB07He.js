import"./DsnmJJEf.js";import{h as Re,u as Ne,l as we,i as qe,F as je,b as g,s as Te,t as P,a as m,g as h,e as u,aD as Ie,r as d,aa as de,be as Le,am as We,j as a,K as O,aL as ye,p as ve,ab as H,d as ce,aT as Ge,f as Q,c as te}from"./4UBXq5Sj.js";import{s as F,d as fe,e as Be}from"./DEyIqfax.js";import{i as T}from"./DY7lAt98.js";import{e as _e,r as ue,s as Z,a as Qe,b as Pe}from"./Z0ud6hNo.js";import{t as Xe,b as Oe,s as oe,c as Ye}from"./3q36uapf.js";import{p as R}from"./CsZilKOT.js";import{c as He,r as Ae,l as Ke}from"./CGjaQNWU.js";import{C as V}from"./BdNfXnux.js";import{h as Je}from"./QhpshmSz.js";import{d as Ze}from"./Bx3Ta1aT.js";import{r as Ve}from"./mM-1AuYX.js";import{p as N}from"./DquHj3qN.js";import{r as $e}from"./CJb_XuXC.js";import{m as et,a as tt}from"./BtSkwSql.js";import{w as Ue,g as at}from"./Cje6xDa-.js";function st(r,e,t){Re(()=>{var s=Ne(()=>e(r,t?.())||{});if(s?.destroy)return()=>s.destroy()})}function Ce(r,e={},t,s){for(var n in t){var i=t[n];e[n]!==i&&(t[n]==null?r.style.removeProperty(n):r.style.setProperty(n,i,s))}}function ke(r,e,t,s){var n=r.__style;if(we||n!==e){var i=Xe(e,s);(!we||i!==r.getAttribute("style"))&&(i==null?r.removeAttribute("style"):r.style.cssText=i),r.__style=e}else s&&(Array.isArray(s)?(Ce(r,t?.[0],s[0]),Ce(r,t?.[1],s[1],"important")):Ce(r,t,s));return s}function rt(r,e,t,s,n){var i=()=>{s(t[r])};t.addEventListener(e,i),n?qe(()=>{t[r]=n()}):i(),(t===document.body||t===window||t===document)&&je(()=>{t.removeEventListener(e,i)})}var nt=g('<h2 class="svelte-6qb8f6"> </h2>'),lt=g('<div class="container svelte-6qb8f6"><!> <!></div>');function it(r,e){let t=R(e,"title",3,void 0),s=R(e,"width",3,void 0);var n=lt();let i;var c=u(n);{var l=w=>{var L=nt(),E=u(L,!0);d(L),P(()=>F(E,t())),m(w,L)};T(c,w=>{t()&&w(l)})}var p=h(c,2);Te(p,()=>e.children??Ie),d(n),P(w=>i=ke(n,"",i,w),[()=>({width:s()})]),m(r,n)}const ot=r=>{window.addEventListener("click",e);function e(t){r.contains(t.target)||r.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var vt=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ct=["difference","intersection","symmetricDifference","union"],Ee=!1;class ae extends Set{#a=new Map;#e=de(0);#t=de(0);#s=Le||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}Ee||this.#n()}#r(e){return Le===this.#s?de(e):We(e)}#n(){Ee=!0;var e=ae.prototype,t=Set.prototype;for(const s of vt)e[s]=function(...n){return a(this.#e),t[s].apply(this,n)};for(const s of ct)e[s]=function(...n){a(this.#e);var i=t[s].apply(this,n);return new ae(i)}}has(e){var t=super.has(e),s=this.#a,n=s.get(e);if(n===void 0){if(!t)return a(this.#e),!1;n=this.#r(!0),s.set(e,n)}return a(n),t}add(e){return super.has(e)||(super.add(e),O(this.#t,super.size),ye(this.#e)),this}delete(e){var t=super.delete(e),s=this.#a,n=s.get(e);return n!==void 0&&(s.delete(e),O(n,!1)),t&&(O(this.#t,super.size),ye(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())O(t,!1);e.clear(),O(this.#t,0),ye(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const dt=(r,e,t)=>{O(e,new ae),t.onChange(Array.from(a(e)))};var ut=(r,e,t)=>e(r.target.checked,a(t).value),ft=g('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),_t=g('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function ze(r,e){ve(e,!0);let t=H(()=>new ae(e.value));const s=(z,C)=>{z?a(t).add(C):a(t).delete(C),O(t,new ae(a(t))),e.onChange(Array.from(a(t)))};let n=de(!1);const i=()=>{O(n,!1)};var c=_t(),l=u(c),p=u(l);d(l);var w=h(l,2),L=u(w),E=u(L);_e(E,21,()=>e.options,z=>z.value,(z,C)=>{var U=ft(),D=u(U),v=u(D),o=h(v);ue(o),o.__input=[ut,s,C],d(D),d(U),P(f=>{Z(D,"for",a(C).value),F(v,`${a(C).label??""} `),Z(o,"id",a(C).value),Z(o,"name",a(C).value),Qe(o,a(C).value),Pe(o,f)},[()=>a(t).has(a(C).value)]),m(z,U)}),d(E);var q=h(E,2);q.__click=[dt,t,e],d(L),d(w),d(c),st(c,z=>ot?.(z)),Re(()=>rt("open","toggle",c,z=>O(n,z),()=>a(n))),P(()=>{F(p,`${e.summary??""} (${a(t).size??""})`),q.disabled=a(t).size===0}),Be("outsideclick",c,i),m(r,c),ce()}fe(["input","click"]);var mt=(r,e,t)=>e.onFiltersChange({...a(t)}),ht=(r,e,t)=>{a(e).type=r.target.value,t.onFiltersChange({...a(e)})},bt=g("<option> </option>"),gt=(r,e,t)=>{a(e).onlyAvailables=r.target.checked,t.onFiltersChange({...a(e)})},pt=g('<div class="only-availables-field svelte-1o8sb8t"><label for="only-availables" class="svelte-1o8sb8t"><input type="checkbox" id="only-availables" class="svelte-1o8sb8t"/>Ver Solo disponibles</label></div>'),yt=(r,e)=>e.onResetFilters(),Ct=g('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <!> <button>Limpiar Filtros</button></div>');function ua(r,e){ve(e,!0);let t=R(e,"includeOnlyAvailablesFilter",3,!1),s=H(()=>e.filters);const n=()=>{const l=new Set(e.cards.map(p=>p.level));return Array.from(l).sort((p,w)=>p-w)},i=()=>{const l=new Set(e.cards.flatMap(p=>p.tags));return Array.from(l).sort()},c=()=>{const l=new Set(e.cards.map(p=>p.type));return Array.from(l).sort()};it(r,{children:(l,p)=>{var w=Ct(),L=u(w);ue(L),L.__input=[mt,e,s];var E=h(L,2);E.__change=[ht,s,e];var q=u(E);q.value=q.__value="";var z=h(q);_e(z,16,c,f=>f,(f,y)=>{var S=bt(),I=u(S,!0);d(S);var A={};P(b=>{F(I,b),A!==(A=y)&&(S.value=(S.__value=y)??"")},[()=>He(y)]),m(f,S)}),d(E);var C=h(E,2);{let f=H(()=>n().map(y=>({value:y,label:`Nivel ${y}`})));ze(C,{summary:"Niveles",get options(){return a(f)},get value(){return a(s).level},onChange:y=>{a(s).level=y,e.onFiltersChange({...a(s)})}})}var U=h(C,2);{let f=H(()=>i().map(y=>({value:y.toLowerCase(),label:y})));ze(U,{summary:"Etiquetas",get options(){return a(f)},get value(){return a(s).tags},onChange:y=>{a(s).tags=y.map(S=>S.toLowerCase()),e.onFiltersChange({...a(s)})}})}var D=h(U,2);{var v=f=>{var y=pt(),S=u(y),I=u(S);ue(I),I.__input=[gt,s,e],Ge(),d(S),d(y),P(()=>Pe(I,a(s).onlyAvailables)),m(f,y)};T(D,f=>{t()&&f(v)})}var o=h(D,2);o.__click=[yt,e],d(w),Oe(L,()=>a(s).name,f=>a(s).name=f),m(l,w)},$$slots:{default:!0}}),ce()}fe(["input","change","click"]);var At=g("<label> </label>"),kt=(r,e,t,s)=>{e.max!==void 0&&typeof a(t)=="number"&&O(t,Math.min(a(t),e.max)),s()(a(t))},wt=g('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),Lt=g('<button class="button svelte-1r47u3b"> </button>'),Et=g("<div><!> <span><input/> <!> <!></span></div>");function zt(r,e){ve(e,!0);let t=R(e,"label",3,void 0),s=R(e,"labelWidth",3,"normalized"),n=R(e,"readonly",3,!1),i=R(e,"onChange",3,()=>{}),c=R(e,"button",3,void 0),l=R(e,"fullWidth",3,!1),p=R(e,"placeholder",3,""),w=R(e,"textAlign",3,"center"),L=H(()=>e.value);var E=Et();let q;var z=u(E);{var C=A=>{var b=At(),M=u(b,!0);d(b),P(()=>{oe(b,1,Ye(s()),"svelte-1r47u3b"),F(M,t())}),m(A,b)};T(z,A=>{t()&&A(C)})}var U=h(z,2);let D;var v=u(U);ue(v);let o;Z(v,"min",0),v.__input=[kt,e,L,i];var f=h(v,2);{var y=A=>{var b=wt(),M=h(Q(b),2);let K;var se=u(M,!0);d(M),P($=>{K=oe(M,1,"max svelte-1r47u3b",null,K,$),F(se,e.max)},[()=>({withButton:c()!==void 0})]),m(A,b)};T(f,A=>{e.max!==void 0&&A(y)})}var S=h(f,2);{var I=A=>{var b=Lt();b.__click=function(...K){c().onClick?.apply(this,K)};var M=u(b,!0);d(b),P(()=>{Z(b,"title",c().title),b.disabled=c().disabled,F(M,c().icon)}),m(A,b)};T(S,A=>{c()&&A(I)})}d(U),d(E),P((A,b,M)=>{q=oe(E,1,"fieldgroup svelte-1r47u3b",null,q,A),D=oe(U,1,"field svelte-1r47u3b",null,D,b),Z(v,"type",typeof e.value=="number"?"number":"text"),v.disabled=n(),o=oe(v,1,`text-align-${w()}`,"svelte-1r47u3b",o,M),Z(v,"max",e.max),Z(v,"placeholder",p())},[()=>({fullWidth:l()}),()=>({inputAlone:e.max===void 0&&c()===void 0&&!l(),inputWithButton:c()!==void 0,fullWidth:l(),readonly:n()}),()=>({alone:e.max===void 0&&c()===void 0,fullWidth:l(),withButton:c()!==void 0,withButtonAndMax:e.max!==void 0&&c()!==void 0})]),Oe(v,()=>a(L),A=>O(L,A)),m(r,E),ce()}fe(["input","click"]);var xt=g('<span class="chip svelte-6vztta"> </span>'),St=g('<span class="chip svelte-6vztta"> </span>'),Ft=g('<span class="chip svelte-6vztta"> </span>'),Rt=g('<span class="chip svelte-6vztta"> </span>'),Tt=g('<span class="chip svelte-6vztta"> </span>'),Pt=g('<div class="controls svelte-6vztta"><!></div>'),Ot=g('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function Ut(r,e){ve(e,!0);let t=R(e,"children",3,void 0);const s=_=>{switch(Ae(_.length>0?String(_[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var n=Ot();let i;var c=u(n);let l;var p=h(c,2),w=u(p),L=u(w),E=u(L),q=u(E,!0);d(E);var z=h(E,2),C=u(z);d(z);var U=h(z,4),D=u(U,!0);d(U),d(L);var v=h(L,2),o=u(v,!0);d(v),d(w);var f=h(w,2),y=u(f),S=u(y);Je(S,()=>Ze.parse(e.card.description)),d(y);var I=h(y,2),A=u(I);_e(A,16,()=>e.card.tags,_=>_,(_,k)=>{var x=xt(),X=u(x,!0);d(x),P(()=>F(X,k)),m(_,x)});var b=h(A,2);{var M=_=>{var k=te(),x=Q(k);{var X=B=>{var Y=St(),ie=u(Y);d(Y),P(()=>F(ie,`Usos: ${e.card.uses.qty??"?"??""} por día de descanso`)),m(B,Y)},le=B=>{var Y=te(),ie=Q(Y);{var me=j=>{var W=Ft(),be=u(W);d(W),P(()=>F(be,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(j,W)},he=j=>{var W=te(),be=Q(W);{var De=ge=>{var pe=Rt(),Me=u(pe);d(pe),P(()=>F(Me,`Usos: ${e.card.uses.qty??"?"??""}`)),m(ge,pe)};T(be,ge=>{e.card.uses.type==="USES"&&ge(De)},!0)}m(j,W)};T(ie,j=>{e.card.uses.type==="RELOAD"?j(me):j(he,!1)},!0)}m(B,Y)};T(x,B=>{e.card.uses.type==="LONG_REST"?B(X):B(le,!1)})}m(_,k)};T(b,_=>{e.card.uses.type&&_(M)})}var K=h(b,2);{var se=_=>{var k=Tt(),x=u(k);d(k),P(()=>F(x,`Costo: ${e.card.cost??""} de oro`)),m(_,k)};T(K,_=>{e.card.cardType==="item"&&_(se)})}d(I),d(f);var $=h(f,2),G=h(u($),2),J=u(G),ee=u(J,!0);d(J),d(G);var re=h(G,2);{var ne=_=>{var k=Pt(),x=u(k);Te(x,t),d(k),m(_,k)};T(re,_=>{t()!==void 0&&_(ne)})}d($),d(p),d(n),P((_,k,x,X)=>{i=ke(n,"",i,_),l=ke(c,"",l,k),F(q,e.card.cardType==="ability"?"Habilidad":"Objeto Mágico"),F(C,`Nivel ${e.card.level??""}`),F(D,x),F(o,e.card.name),F(ee,X)},[()=>({"border-color":s(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"—"]),m(r,n),ce()}var Dt=(r,e,t)=>e(a(t).id),Mt=g('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Nt=(r,e,t)=>e(a(t).id),qt=(r,e,t)=>e(a(t).id),jt=g("<button>Desactivar</button>"),It=(r,e,t)=>e(a(t).id),Wt=g("<button>Activar</button>"),Gt=g('<button>Quitar</button> <span class="spacer"></span> <!>',1),Bt=(r,e,t)=>e(a(t)),Qt=g('<span class="spacer"></span> <button>Agregar</button>',1),Xt=g('<div class="controls svelte-1rfcjb3"><!></div>'),Yt=g('<div class="cards svelte-1rfcjb3"></div>');function fa(r,e){ve(e,!0);let t=R(e,"readonly",3,!0),s=R(e,"characterCards",19,()=>[]),n=R(e,"listMode",3,"all"),i=R(e,"onChange",3,()=>{}),c=R(e,"onCardReloadClick",3,()=>{}),l=H(s);const p=v=>{const o=e.cards.find(f=>f.id===v);if(!o){L(v);return}O(l,a(l).map(f=>f.id===v?{...f,isActive:!1,uses:C(o)}:f)),i()(a(l))},w=v=>{O(l,a(l).map(o=>o.id===v?{...o,isActive:!0}:o)),i()(a(l))},L=v=>{O(l,a(l).filter(o=>o.id!==v)),i()(a(l))},E=v=>{O(l,[...a(l),{id:v.id,uses:C(v),isActive:!1,level:v.level,cardType:v.type}]),i()(a(l))},q=(v,o)=>{O(l,a(l).map(f=>f.id===v?{...f,uses:o}:f)),i()(a(l))},z=v=>{const o=a(l).find(f=>f.id===v);return o?o.uses:0},C=v=>{if(v.uses.type===null)return null;switch(v.uses.type){case"USES":case"LONG_REST":case"DAY":return v.uses.qty??0;case"RELOAD":return V.RELOAD_CARD_USES;default:return null}},U=v=>{const o=a(l).find(f=>f.id===v.id);return o?o.isActive:!1};var D=Yt();_e(D,21,()=>e.cards,v=>v.id,(v,o)=>{Ut(v,{get card(){return a(o)},children:(f,y)=>{var S=te(),I=Q(S);{var A=b=>{var M=Xt(),K=u(M);{var se=G=>{var J=Mt(),ee=Q(J);{var re=_=>{{let k=H(()=>z(a(o).id)),x=H(()=>C(a(o))),X=H(()=>({icon:"🎲",title:"Tirar para recargar",onClick:()=>c()(a(o).id),disabled:z(a(o).id)===C(a(o))}));zt(_,{get value(){return a(k)},get max(){return a(x)},onChange:le=>q(a(o).id,Number(le)),get button(){return a(X)}})}};T(ee,_=>{C(a(o))!==null&&_(re)})}var ne=h(ee,4);ne.__click=[Dt,p,o],m(G,J)},$=G=>{var J=te(),ee=Q(J);{var re=_=>{var k=Gt(),x=Q(k);x.__click=[Nt,L,o];var X=h(x,4);{var le=B=>{var Y=te(),ie=Q(Y);{var me=j=>{var W=jt();W.__click=[qt,p,o],m(j,W)},he=j=>{var W=Wt();W.__click=[It,w,o],m(j,W)};T(ie,j=>{U(a(o))?j(me):j(he,!1)})}m(B,Y)};T(X,B=>{a(o).type==="activable"&&B(le)})}m(_,k)},ne=_=>{var k=Qt(),x=h(Q(k),2);x.__click=[Bt,E,o],m(_,k)};T(ee,_=>{n()==="collection"?_(re):_(ne,!1)},!0)}m(G,J)};T(K,G=>{n()==="active"?G(se):G($,!1)})}d(M),m(b,M)};T(I,b=>{t()||b(A)})}m(f,S)},$$slots:{default:!0}})}),d(D),m(r,D),ce()}fe(["click"]);const _a=()=>({buildEmptyFilters:({onlyAvailables:s}={onlyAvailables:void 0})=>({name:"",level:[],tags:[],type:"",onlyAvailables:s}),getFiltersFromURL:()=>{const s=N.url.searchParams.get("name")??"",n=N.url.searchParams.getAll("level").filter(l=>l!=="").map(Number).filter(l=>l>0),i=N.url.searchParams.getAll("tags").filter(l=>l!==""),c=N.url.searchParams.get("type")??"";return{name:s,level:n,tags:i,type:c}},updateURLFilters:s=>{s.name?N.url.searchParams.set("name",s.name):N.url.searchParams.delete("name"),s.level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",s.level.join(",")),s.tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",s.tags.join(",")),s.type?N.url.searchParams.set("type",s.type):N.url.searchParams.delete("type");const n=N.url.searchParams.toString(),i=`${N.url.pathname}${n?`?${n}`:""}`;Ve(i,{})}}),xe=Ue([]),Se=Ue([]),Fe=async(r,e,t,s)=>{if(at(t).length>0)return;const i=await(await fetch($e(r))).text();let c=[];try{c=Ke(i)[e]??[]}catch(l){console.error("Error parsing YAML:",l)}t.set(c.map(l=>s(l)).toSorted((l,p)=>l.level-p.level||l.tags.join("|").localeCompare(p.tags.join("|"))||l.name.localeCompare(p.name)))},ma=()=>({loadAbilityCards:async()=>{await Fe("/docs/cards.yml","cards",xe,et)},abilityCards:xe,loadItemCards:async()=>{await Fe("/docs/magical-items.yml","items",Se,tt)},itemCards:Se}),ha=(r,e,t=void 0)=>{let s=[],n=!1;return t&&e.onlyAvailables&&(s=Ht(r,t),n=!0),r.filter(i=>Ae(i.name.toLowerCase()).includes(Ae(e.name.toLowerCase()))&&(e.level.length===0||e.level.includes(i.level))&&(e.tags.length===0||e.tags.every(c=>i.tags.map(l=>l.toLowerCase()).includes(c)))&&(!e.type||e.type===i.type)&&(!n||Kt(i,s)))},Ht=(r,e)=>{const t=[];for(const i of Object.keys(V.ATTR_NAME_MAP))for(let c=1;c<=e.attributes[i];c++)t.push(`${V.ATTR_NAME_MAP[i]} ${c}`.toLowerCase());const s=r.filter(i=>e.cards.find(c=>c.id===i.id));for(const i of s)t.push(i.name.toLowerCase());const n=r.filter(i=>i.tags.includes(V.LINEAGE_CARD_TAG)&&e.cards.find(c=>c.id===i.id)).length;return e.cards.length<=V.MAX_CARDS_TO_INCLUDE_LINEAGES&&n<V.MAX_LINEAGE_CARDS&&t.push(V.LINEAGE_REQUIREMENT.toLowerCase()),t},Kt=(r,e)=>r.requirements.find(t=>t.toLowerCase().startsWith("o "))?r.requirements.some(t=>e.includes(t.toLowerCase().replace("o ",""))):r.requirements.every(t=>e.includes(t.toLowerCase()));export{ua as C,zt as I,ma as a,fa as b,it as c,st as d,ot as e,ha as f,_a as u};
