import"./DsnmJJEf.js";import{v as xe,D as Re,h as ke,a8 as De,z as Ue,f as k,aT as Se,t as F,b as h,s as p,d as c,ai as Oe,r as o,e as O,aG as ve,aV as Ae,ar as qe,H as a,O as L,aW as ge,aa as ue,p as ie,ab as Y,aP as Ne,c as le,a as H,aN as ne}from"./Kn-3yCMi.js";import{e as de,r as Ce,s as Z,a as Fe,b as Te,C as oe}from"./DoQYgQHR.js";import{t as Be,b as Ee,s as se,c as Me}from"./WpMs7pcV.js";import{r as We}from"./CNbsq0bT.js";import{p as N}from"./Djb_0UR9.js";import{r as ce,c as je,g as Ge,l as Ie}from"./CjlGQt4x.js";import{i as T}from"./XhFqZ_PR.js";import{p as R}from"./C2rRscMh.js";import{h as Ke}from"./DlV9slla.js";import{d as Qe}from"./Bx3Ta1aT.js";import{r as He}from"./CsGzFYzi.js";import{w as Ye,g as Je}from"./C2b8wWAA.js";function Xe(s,e,t){xe(()=>{var i=Re(()=>e(s,t?.())||{});if(i?.destroy)return()=>i.destroy()})}function be(s,e={},t,i){for(var l in t){var r=t[l];e[l]!==r&&(t[l]==null?s.style.removeProperty(l):s.style.setProperty(l,r,i))}}function ye(s,e,t,i){var l=s.__style;if(ke||l!==e){var r=Be(e,i);(!ke||r!==s.getAttribute("style"))&&(r==null?s.removeAttribute("style"):s.style.cssText=r),s.__style=e}else i&&(Array.isArray(i)?(be(s,t?.[0],i[0]),be(s,t?.[1],i[1],"important")):be(s,t,i));return i}function Ze(s,e,t,i,l){var r=()=>{i(t[s])};t.addEventListener(e,r),l?De(()=>{t[s]=l()}):r(),(t===document.body||t===window||t===document)&&Ue(()=>{t.removeEventListener(e,r)})}var Ve=k('<h2 class="svelte-6qb8f6"> </h2>'),$e=k('<div class="container svelte-6qb8f6"><!> <!></div>');function et(s,e){let t=R(e,"title",3,void 0),i=R(e,"width",3,void 0);var l=$e();let r;var f=c(l);{var d=E=>{var _=Ve(),u=c(_,!0);o(_),F(()=>O(u,t())),h(E,_)};T(f,E=>{t()&&E(d)})}var B=p(f,2);Se(B,()=>e.children??Oe),o(l),F(E=>r=ye(l,"",r,E),[()=>({width:i()})]),h(s,l)}const tt=s=>{window.addEventListener("click",e);function e(t){s.contains(t.target)||s.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var at=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],rt=["difference","intersection","symmetricDifference","union"],we=!1;class ae extends Set{#a=new Map;#e=ve(0);#t=ve(0);#r=Ae||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}we||this.#n()}#s(e){return Ae===this.#r?ve(e):qe(e)}#n(){we=!0;var e=ae.prototype,t=Set.prototype;for(const i of at)e[i]=function(...l){return a(this.#e),t[i].apply(this,l)};for(const i of rt)e[i]=function(...l){a(this.#e);var r=t[i].apply(this,l);return new ae(r)}}has(e){var t=super.has(e),i=this.#a,l=i.get(e);if(l===void 0){if(!t)return a(this.#e),!1;l=this.#s(!0),i.set(e,l)}return a(l),t}add(e){return super.has(e)||(super.add(e),L(this.#t,super.size),ge(this.#e)),this}delete(e){var t=super.delete(e),i=this.#a,l=i.get(e);return l!==void 0&&(i.delete(e),L(l,!1)),t&&(L(this.#t,super.size),ge(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())L(t,!1);e.clear(),L(this.#t,0),ge(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const st=(s,e,t)=>{L(e,new ae),t.onChange(Array.from(a(e)))};var nt=(s,e,t)=>e(s.target.checked,a(t).value),it=k('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),lt=k('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function ze(s,e){ie(e,!0);let t=Y(()=>new ae(e.value));const i=(y,m)=>{y?a(t).add(m):a(t).delete(m),L(t,new ae(a(t))),e.onChange(Array.from(a(t)))};let l=ve(!1);const r=()=>{L(l,!1)};var f=lt(),d=c(f),B=c(d);o(d);var E=p(d,2),_=c(E),u=c(_);de(u,21,()=>e.options,y=>y.value,(y,m)=>{var D=it(),U=c(D),v=c(U),n=p(v);Ce(n),n.__input=[nt,i,m],o(U),o(D),F(g=>{Z(U,"for",a(m).value),O(v,`${a(m).label??""} `),Z(n,"id",a(m).value),Z(n,"name",a(m).value),Fe(n,a(m).value),Te(n,g)},[()=>a(t).has(a(m).value)]),h(y,D)}),o(u);var A=p(u,2);A.__click=[st,t,e],o(_),o(E),o(f),Xe(f,y=>tt?.(y)),xe(()=>Ze("open","toggle",f,y=>L(l,y),()=>a(l))),F(()=>{O(B,`${e.summary??""} (${a(t).size??""})`),A.disabled=a(t).size===0}),Ne("outsideclick",f,r),h(s,f),le()}ue(["input","click"]);const vt=(s,e,t,i)=>{L(e,t()),i()};var ot=(s,e)=>e(),ct=(s,e,t)=>{a(e).type=s.target.value,t()},ut=k("<option> </option>"),dt=k('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function Vt(s,e){ie(e,!0);const t=()=>({name:"",level:[],tags:[],type:""}),i=()=>{const _=N.url.searchParams.get("name")??"",u=N.url.searchParams.getAll("level").filter(m=>m!=="").map(Number).filter(m=>m>0),A=N.url.searchParams.getAll("tags").filter(m=>m!==""),y=N.url.searchParams.get("type")??"";return{name:_,level:u,tags:A,type:y}},l=()=>{a(r).name?N.url.searchParams.set("name",a(r).name):N.url.searchParams.delete("name"),a(r).level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",a(r).level.join(",")),a(r).tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",a(r).tags.join(",")),a(r).type?N.url.searchParams.set("type",a(r).type):N.url.searchParams.delete("type");const _=N.url.searchParams.toString(),u=`${N.url.pathname}${_?`?${_}`:""}`;We(u,{})};let r=Y(i);const f=()=>{const _=e.cards.filter(u=>ce(u.name.toLowerCase()).includes(ce(a(r).name.toLowerCase()))&&(a(r).level.length===0||a(r).level.includes(u.level))&&(a(r).tags.length===0||a(r).tags.every(A=>u.tags.includes(A)))&&(!a(r).type||a(r).type===u.type));e.onFilter(_),l()},d=()=>{const _=new Set(e.cards.map(u=>u.level));return Array.from(_).sort((u,A)=>u-A)},B=()=>{const _=new Set(e.cards.flatMap(u=>u.tags));return Array.from(_).sort()},E=()=>{const _=new Set(e.cards.map(u=>u.type));return Array.from(_).sort()};et(s,{children:(_,u)=>{var A=dt(),y=c(A);Ce(y),y.__input=[ot,f];var m=p(y,2);m.__change=[ct,r,f];var D=c(m);D.value=D.__value="";var U=p(D);de(U,16,E,q=>q,(q,w)=>{var j=ut(),z=c(j,!0);o(j);var b={};F(x=>{O(z,x),b!==(b=w)&&(j.value=(j.__value=w)??"")},[()=>je(w)]),h(q,j)}),o(m);var v=p(m,2);{let q=Y(()=>d().map(w=>({value:w,label:`Nivel ${w}`})));ze(v,{summary:"Niveles",get options(){return a(q)},get value(){return a(r).level},onChange:w=>{a(r).level=w,f()}})}var n=p(v,2);{let q=Y(()=>B().map(w=>({value:w,label:w})));ze(n,{summary:"Etiquetas",get options(){return a(q)},get value(){return a(r).tags},onChange:w=>{a(r).tags=w,f()}})}var g=p(n,2);g.__click=[vt,r,t,f],o(A),Ee(y,()=>a(r).name,q=>a(r).name=q),h(_,A)},$$slots:{default:!0}}),le()}ue(["input","change","click"]);var ft=k("<label> </label>"),_t=(s,e,t,i)=>{e.max!==void 0&&typeof a(t)=="number"&&L(t,Math.min(a(t),e.max)),i()(a(t))},mt=k('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),ht=k('<button class="button svelte-1r47u3b"> </button>'),gt=k("<div><!> <span><input/> <!> <!></span></div>");function bt(s,e){ie(e,!0);let t=R(e,"label",3,void 0),i=R(e,"labelWidth",3,"normalized"),l=R(e,"readonly",3,!1),r=R(e,"onChange",3,()=>{}),f=R(e,"button",3,void 0),d=R(e,"fullWidth",3,!1),B=R(e,"placeholder",3,""),E=R(e,"textAlign",3,"center"),_=Y(()=>e.value);var u=gt();let A;var y=c(u);{var m=z=>{var b=ft(),x=c(b,!0);o(b),F(()=>{se(b,1,Me(i()),"svelte-1r47u3b"),O(x,t())}),h(z,b)};T(y,z=>{t()&&z(m)})}var D=p(y,2);let U;var v=c(D);Ce(v);let n;Z(v,"min",0),v.__input=[_t,e,_,r];var g=p(v,2);{var q=z=>{var b=mt(),x=p(H(b),2);let I;var ee=c(x,!0);o(x),F(re=>{I=se(x,1,"max svelte-1r47u3b",null,I,re),O(ee,e.max)},[()=>({withButton:f()!==void 0})]),h(z,b)};T(g,z=>{e.max!==void 0&&z(q)})}var w=p(g,2);{var j=z=>{var b=ht();b.__click=function(...I){f().onClick?.apply(this,I)};var x=c(b,!0);o(b),F(()=>{Z(b,"title",f().title),b.disabled=f().disabled,O(x,f().icon)}),h(z,b)};T(w,z=>{f()&&z(j)})}o(D),o(u),F((z,b,x)=>{A=se(u,1,"fieldgroup svelte-1r47u3b",null,A,z),U=se(D,1,"field svelte-1r47u3b",null,U,b),Z(v,"type",typeof e.value=="number"?"number":"text"),v.disabled=l(),n=se(v,1,`text-align-${E()}`,"svelte-1r47u3b",n,x),Z(v,"max",e.max),Z(v,"placeholder",B())},[()=>({fullWidth:d()}),()=>({inputAlone:e.max===void 0&&f()===void 0&&!d(),inputWithButton:f()!==void 0,fullWidth:d(),readonly:l()}),()=>({alone:e.max===void 0&&f()===void 0,fullWidth:d(),withButton:f()!==void 0,withButtonAndMax:e.max!==void 0&&f()!==void 0})]),Ee(v,()=>a(_),z=>L(_,z)),h(s,u),le()}ue(["input","click"]);var pt=k('<span class="chip svelte-6vztta"> </span>'),yt=k('<span class="chip svelte-6vztta"> </span>'),Ct=k('<span class="chip svelte-6vztta"> </span>'),kt=k('<span class="chip svelte-6vztta"> </span>'),At=k('<div class="controls svelte-6vztta"><!></div>'),wt=k('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function zt(s,e){ie(e,!0);let t=R(e,"children",3,void 0);const i=C=>{switch(ce(C.length>0?String(C[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}},l=C=>{let S=ce(C.length>0?String(C[0]).toLowerCase():"");return oe.CARD_BACKGROUNDS[S]?oe.CARD_BACKGROUNDS[S]:oe.CARD_BACKGROUNDS.default};var r=wt();let f;var d=c(r);let B;var E=p(d,2),_=c(E),u=c(_),A=c(u),y=c(A);o(A);var m=p(A,2),D=c(m,!0);o(m),o(u);var U=p(u,2),v=c(U,!0);o(U),o(_);var n=p(_,2),g=c(n),q=c(g);Ke(q,()=>Qe.parse(e.card.description)),o(g);var w=p(g,2),j=c(w);de(j,16,()=>e.card.tags,C=>C,(C,S)=>{var M=pt(),P=c(M,!0);o(M),F(()=>O(P,S)),h(C,M)});var z=p(j,2);{var b=C=>{var S=ne(),M=H(S);{var P=W=>{var K=yt(),$=c(K);o(K),F(()=>O($,`Usos: ${e.card.uses.qty??"?"??""} por día de descanso`)),h(W,K)},Q=W=>{var K=ne(),$=H(K);{var fe=G=>{var te=Ct(),_e=c(te);o(te),F(()=>O(_e,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),h(G,te)},X=G=>{var te=ne(),_e=H(te);{var Le=me=>{var he=kt(),Pe=c(he);o(he),F(()=>O(Pe,`Usos: ${e.card.uses.qty??"?"??""}`)),h(me,he)};T(_e,me=>{e.card.uses.type==="USES"&&me(Le)},!0)}h(G,te)};T($,G=>{e.card.uses.type==="RELOAD"?G(fe):G(X,!1)},!0)}h(W,K)};T(M,W=>{e.card.uses.type==="LONG_REST"?W(P):W(Q,!1)})}h(C,S)};T(z,C=>{e.card.uses.type&&C(b)})}o(w),o(n);var x=p(n,2),I=p(c(x),2),ee=c(I),re=c(ee,!0);o(ee),o(I);var J=p(I,2);{var V=C=>{var S=At(),M=c(S);Se(M,t),o(S),h(C,S)};T(J,C=>{t()!==void 0&&C(V)})}o(x),o(E),o(r),F((C,S,M,P)=>{f=ye(r,"",f,C),B=ye(d,"",B,S),O(y,`Nivel ${e.card.level??""}`),O(D,M),O(v,e.card.name),O(re,P)},[()=>({"border-color":i(e.card.tags)}),()=>({"background-image":`url(${l(e.card.tags)})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"—"]),h(s,r),le()}var xt=(s,e,t)=>e(a(t).id),St=k('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Et=(s,e,t)=>e(a(t).id),Lt=(s,e,t)=>e(a(t).id),Pt=k("<button>Desactivar</button>"),Rt=(s,e,t)=>e(a(t).id),Dt=k("<button>Activar</button>"),Ut=k('<button>Quitar</button> <span class="spacer"></span> <!>',1),Ot=(s,e,t)=>e(a(t)),qt=k('<span class="spacer"></span> <button>Agregar</button>',1),Nt=k('<div class="controls svelte-1rfcjb3"><!></div>'),Ft=k('<div class="cards svelte-1rfcjb3"></div>');function $t(s,e){ie(e,!0);let t=R(e,"readonly",3,!0),i=R(e,"characterCards",19,()=>[]),l=R(e,"listMode",3,"all"),r=R(e,"onChange",3,()=>{}),f=R(e,"onCardReloadClick",3,()=>{}),d=Y(i);const B=v=>{const n=e.cards.find(g=>g.id===v);if(!n){_(v);return}L(d,a(d).map(g=>g.id===v?{...g,isActive:!1,uses:m(n)}:g)),r()(a(d))},E=v=>{L(d,a(d).map(n=>n.id===v?{...n,isActive:!0}:n)),r()(a(d))},_=v=>{L(d,a(d).filter(n=>n.id!==v)),r()(a(d))},u=v=>{L(d,[...a(d),{id:v.id,uses:m(v),isActive:!1,level:v.level}]),r()(a(d))},A=(v,n)=>{L(d,a(d).map(g=>g.id===v?{...g,uses:n}:g)),r()(a(d))},y=v=>{const n=a(d).find(g=>g.id===v);return n?n.uses:0},m=v=>{if(v.uses.type===null)return null;switch(v.uses.type){case"USES":case"LONG_REST":return v.uses.qty??0;case"RELOAD":return oe.RELOAD_CARD_USES;default:return null}},D=v=>{const n=a(d).find(g=>g.id===v.id);return n?n.isActive:!1};var U=Ft();de(U,21,()=>e.cards,v=>v.id,(v,n)=>{zt(v,{get card(){return a(n)},children:(g,q)=>{var w=ne(),j=H(w);{var z=b=>{var x=Nt(),I=c(x);{var ee=J=>{var V=St(),C=H(V);{var S=P=>{{let Q=Y(()=>y(a(n).id)),W=Y(()=>m(a(n))),K=Y(()=>({icon:"🎲",title:"Tirar para recargar",onClick:()=>f()(a(n).id),disabled:y(a(n).id)===m(a(n))}));bt(P,{get value(){return a(Q)},get max(){return a(W)},onChange:$=>A(a(n).id,Number($)),get button(){return a(K)}})}};T(C,P=>{m(a(n))!==null&&P(S)})}var M=p(C,4);M.__click=[xt,B,n],h(J,V)},re=J=>{var V=ne(),C=H(V);{var S=P=>{var Q=Ut(),W=H(Q);W.__click=[Et,_,n];var K=p(W,4);{var $=X=>{var G=Pt();G.__click=[Lt,B,n],h(X,G)},fe=X=>{var G=Dt();G.__click=[Rt,E,n],h(X,G)};T(K,X=>{D(a(n))?X($):X(fe,!1)})}h(P,Q)},M=P=>{var Q=qt(),W=p(H(Q),2);W.__click=[Ot,u,n],h(P,Q)};T(C,P=>{l()==="collection"?P(S):P(M,!1)},!0)}h(J,V)};T(I,J=>{l()==="active"?J(ee):J(re,!1)})}o(x),h(b,x)};T(j,b=>{t()||b(z)})}h(g,w)},$$slots:{default:!0}})}),o(U),h(s,U),le()}ue(["click"]);const Tt=s=>{if(!s.name)throw new Error("Card name is required");return{id:Ge(s.name),...s}},pe=Ye([]),ea=()=>({loadCards:async()=>{if(Je(pe).length>0)return;const t=await(await fetch(He("/docs/cards.yml"))).text();let i=[];try{i=Ie(t).cards??[]}catch(l){console.error("Error parsing YAML:",l)}pe.set(i.map(l=>Tt(l)))},cards:pe});export{Vt as C,bt as I,$t as a,et as b,ea as u};
