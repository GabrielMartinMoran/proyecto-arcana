import"./DsnmJJEf.js";import{v as Ce,D as Se,h as pe,a8 as ze,z as Ee,f as w,aP as ke,t as N,b as g,s as C,d as v,ai as Le,r as i,e as F,aa as oe,p as le,N as Pe,aQ as Re,c as ne,O as I,aG as Ue,H as t,ab as X,a as Q,aN as se}from"./Dq1J35Nh.js";import{e as ce,r as be,s as J,a as De,b as Fe,C as ie}from"./CKrzFlF1.js";import{t as Oe,b as Ae,s as re,c as Ne}from"./Cllcj470.js";import{r as qe}from"./CCbNn2KL.js";import{p as O}from"./B0aeXgCt.js";import{r as ve,c as Te,g as Be,l as Me}from"./CjlGQt4x.js";import{i as q}from"./C6PZYbrM.js";import{p as U}from"./Du0JBBBG.js";import{h as We}from"./CbDuNScW.js";import{d as je}from"./Bx3Ta1aT.js";import{r as Ge}from"./DmB4ZnOZ.js";import{w as Ie,g as Ke}from"./CkIMCjdd.js";function Qe(s,e,a){Ce(()=>{var o=Se(()=>e(s,a?.())||{});if(o?.destroy)return()=>o.destroy()})}function me(s,e={},a,o){for(var c in a){var r=a[c];e[c]!==r&&(a[c]==null?s.style.removeProperty(c):s.style.setProperty(c,r,o))}}function he(s,e,a,o){var c=s.__style;if(pe||c!==e){var r=Oe(e,o);(!pe||r!==s.getAttribute("style"))&&(r==null?s.removeAttribute("style"):s.style.cssText=r),s.__style=e}else o&&(Array.isArray(o)?(me(s,a?.[0],o[0]),me(s,a?.[1],o[1],"important")):me(s,a,o));return o}function He(s,e,a,o,c){var r=()=>{o(a[s])};a.addEventListener(e,r),c?ze(()=>{a[s]=c()}):r(),(a===document.body||a===window||a===document)&&Ee(()=>{a.removeEventListener(e,r)})}var Ye=w('<h2 class="svelte-6qb8f6"> </h2>'),Je=w('<div class="container svelte-6qb8f6"><!> <!></div>');function Xe(s,e){let a=U(e,"title",3,void 0),o=U(e,"width",3,void 0);var c=Je();let r;var f=v(c);{var d=E=>{var _=Ye(),u=v(_,!0);i(_),N(()=>F(u,a())),g(E,_)};q(f,E=>{a()&&E(d)})}var T=C(f,2);ke(T,()=>e.children??Le),i(c),N(E=>r=he(c,"",r,E),[()=>({width:o()})]),g(s,c)}const Ze=s=>{window.addEventListener("click",e);function e(a){s.contains(a.target)||s.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var Ve=(s,e,a)=>e(s.target.checked,t(a).value),$e=w('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),et=w('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul></fieldset></form></details>');function ye(s,e){le(e,!0);let a=Pe(new Set);const o=(m,h)=>{m?a.add(h):a.delete(h),e.onChange(Array.from(a))};let c=Ue(!1);const r=()=>{I(c,!1)};var f=et(),d=v(f),T=v(d,!0);i(d);var E=C(d,2),_=v(E),u=v(_);ce(u,21,()=>e.options,m=>m.value,(m,h)=>{var b=$e(),D=v(b),P=v(D),l=C(P);be(l),l.__input=[Ve,o,h],i(D),i(b),N(n=>{J(D,"for",t(h).value),F(P,`${t(h).label??""} `),J(l,"id",t(h).value),J(l,"name",t(h).value),De(l,t(h).value),Fe(l,n)},[()=>a.has(t(h).value)]),g(m,b)}),i(u),i(_),i(E),i(f),Qe(f,m=>Ze?.(m)),Ce(()=>He("open","toggle",f,m=>I(c,m),()=>t(c))),N(()=>F(T,e.summary)),Re("outsideclick",f,r),g(s,f),ne()}oe(["input"]);const tt=(s,e,a,o)=>{I(e,a()),o()};var at=(s,e)=>e(),rt=(s,e,a)=>{t(e).type=s.target.value,a()},st=w("<option> </option>"),lt=w('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Filtrar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Filtrar por Tipo</option><option>Todos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function Kt(s,e){le(e,!0);const a=()=>({name:"",level:[],tags:[],type:""}),o=()=>{const _=O.url.searchParams.get("name")??"",u=O.url.searchParams.getAll("level").filter(b=>b!=="").map(Number).filter(b=>b>0),m=O.url.searchParams.getAll("tags").filter(b=>b!==""),h=O.url.searchParams.get("type")??"";return{name:_,level:u,tags:m,type:h}},c=()=>{t(r).name?O.url.searchParams.set("name",t(r).name):O.url.searchParams.delete("name"),t(r).level.length===0?O.url.searchParams.delete("level"):O.url.searchParams.set("level",t(r).level.join(",")),t(r).tags.length===0?O.url.searchParams.delete("tags"):O.url.searchParams.set("tags",t(r).tags.join(",")),t(r).type?O.url.searchParams.set("type",t(r).type):O.url.searchParams.delete("type");const _=O.url.searchParams.toString(),u=`${O.url.pathname}${_?`?${_}`:""}`;qe(u,{})};let r=X(o);const f=()=>{console.log("Filters",t(r));const _=e.cards.filter(u=>ve(u.name.toLowerCase()).includes(ve(t(r).name.toLowerCase()))&&(t(r).level.length===0||t(r).level.includes(u.level))&&(t(r).tags.length===0||t(r).tags.every(m=>u.tags.includes(m)))&&(!t(r).type||t(r).type===u.type));e.onFilter(_),c()},d=()=>{const _=new Set(e.cards.map(u=>u.level));return Array.from(_).sort((u,m)=>u-m)},T=()=>{const _=new Set(e.cards.flatMap(u=>u.tags));return Array.from(_).sort()},E=()=>{const _=new Set(e.cards.map(u=>u.type));return Array.from(_).sort()};Xe(s,{children:(_,u)=>{var m=lt(),h=v(m);be(h),h.__input=[at,f];var b=C(h,2);b.__change=[rt,r,f];var D=v(b);D.value=D.__value="";var P=C(D);P.value=P.__value="";var l=C(P);ce(l,16,E,L=>L,(L,x)=>{var y=st(),k=v(y,!0);i(y);var S={};N(W=>{F(k,W),S!==(S=x)&&(y.value=(y.__value=x)??"")},[()=>Te(x)]),g(L,y)}),i(b);var n=C(b,2);{let L=X(()=>d().map(x=>({value:x,label:`Nivel ${x}`})));ye(n,{summary:"Filtrar por Nivel",get options(){return t(L)},onChange:x=>{t(r).level=x,f()}})}var p=C(n,2);{let L=X(()=>T().map(x=>({value:x,label:x})));ye(p,{summary:"Filtrar por Etiqueta",get options(){return t(L)},onChange:x=>{t(r).tags=x,f()}})}var $=C(p,2);$.__click=[tt,r,a,f],i(m),Ae(h,()=>t(r).name,L=>t(r).name=L),g(_,m)},$$slots:{default:!0}}),ne()}oe(["input","change","click"]);var nt=w("<label> </label>"),it=(s,e,a,o)=>{e.max!==void 0&&typeof t(a)=="number"&&I(a,Math.min(t(a),e.max)),o()(t(a))},vt=w('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),ot=w('<button class="button svelte-1r47u3b"> </button>'),ct=w("<div><!> <span><input/> <!> <!></span></div>");function dt(s,e){le(e,!0);let a=U(e,"label",3,void 0),o=U(e,"labelWidth",3,"normalized"),c=U(e,"readonly",3,!1),r=U(e,"onChange",3,()=>{}),f=U(e,"button",3,void 0),d=U(e,"fullWidth",3,!1),T=U(e,"placeholder",3,""),E=U(e,"textAlign",3,"center"),_=X(()=>e.value);var u=ct();let m;var h=v(u);{var b=y=>{var k=nt(),S=v(k,!0);i(k),N(()=>{re(k,1,Ne(o()),"svelte-1r47u3b"),F(S,a())}),g(y,k)};q(h,y=>{a()&&y(b)})}var D=C(h,2);let P;var l=v(D);be(l);let n;J(l,"min",0),l.__input=[it,e,_,r];var p=C(l,2);{var $=y=>{var k=vt(),S=C(Q(k),2);let W;var ee=v(S,!0);i(S),N(ae=>{W=re(S,1,"max svelte-1r47u3b",null,W,ae),F(ee,e.max)},[()=>({withButton:f()!==void 0})]),g(y,k)};q(p,y=>{e.max!==void 0&&y($)})}var L=C(p,2);{var x=y=>{var k=ot();k.__click=function(...W){f().onClick?.apply(this,W)};var S=v(k,!0);i(k),N(()=>{J(k,"title",f().title),k.disabled=f().disabled,F(S,f().icon)}),g(y,k)};q(L,y=>{f()&&y(x)})}i(D),i(u),N((y,k,S)=>{m=re(u,1,"fieldgroup svelte-1r47u3b",null,m,y),P=re(D,1,"field svelte-1r47u3b",null,P,k),J(l,"type",typeof e.value=="number"?"number":"text"),l.disabled=c(),n=re(l,1,`text-align-${E()}`,"svelte-1r47u3b",n,S),J(l,"max",e.max),J(l,"placeholder",T())},[()=>({fullWidth:d()}),()=>({inputAlone:e.max===void 0&&f()===void 0&&!d(),inputWithButton:f()!==void 0,fullWidth:d(),readonly:c()}),()=>({alone:e.max===void 0&&f()===void 0,fullWidth:d(),withButton:f()!==void 0,withButtonAndMax:e.max!==void 0&&f()!==void 0})]),Ae(l,()=>t(_),y=>I(_,y)),g(s,u),ne()}oe(["input","click"]);var ut=w('<span class="chip svelte-6vztta"> </span>'),ft=w('<span class="chip svelte-6vztta"> </span>'),_t=w('<span class="chip svelte-6vztta"> </span>'),mt=w('<span class="chip svelte-6vztta"> </span>'),gt=w('<div class="controls svelte-6vztta"><!></div>'),ht=w('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function bt(s,e){le(e,!0);let a=U(e,"children",3,void 0);const o=A=>{switch(ve(A.length>0?String(A[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}},c=A=>{let z=ve(A.length>0?String(A[0]).toLowerCase():"");return ie.CARD_BACKGROUNDS[z]?ie.CARD_BACKGROUNDS[z]:ie.CARD_BACKGROUNDS.default};var r=ht();let f;var d=v(r);let T;var E=C(d,2),_=v(E),u=v(_),m=v(u),h=v(m);i(m);var b=C(m,2),D=v(b,!0);i(b),i(u);var P=C(u,2),l=v(P,!0);i(P),i(_);var n=C(_,2),p=v(n),$=v(p);We($,()=>je.parse(e.card.description)),i(p);var L=C(p,2),x=v(L);ce(x,16,()=>e.card.tags,A=>A,(A,z)=>{var B=ut(),R=v(B,!0);i(B),N(()=>F(R,z)),g(A,B)});var y=C(x,2);{var k=A=>{var z=se(),B=Q(z);{var R=M=>{var G=ft(),V=v(G);i(G),N(()=>F(V,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),g(M,G)},K=M=>{var G=se(),V=Q(G);{var de=j=>{var te=_t(),ue=v(te);i(te),N(()=>F(ue,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),g(j,te)},Y=j=>{var te=se(),ue=Q(te);{var we=fe=>{var _e=mt(),xe=v(_e);i(_e),N(()=>F(xe,`Usos: ${e.card.uses.qty??"?"??""}`)),g(fe,_e)};q(ue,fe=>{e.card.uses.type==="USES"&&fe(we)},!0)}g(j,te)};q(V,j=>{e.card.uses.type==="RELOAD"?j(de):j(Y,!1)},!0)}g(M,G)};q(B,M=>{e.card.uses.type==="LONG_REST"?M(R):M(K,!1)})}g(A,z)};q(y,A=>{e.card.uses.type&&A(k)})}i(L),i(n);var S=C(n,2),W=C(v(S),2),ee=v(W),ae=v(ee,!0);i(ee),i(W);var H=C(W,2);{var Z=A=>{var z=gt(),B=v(z);ke(B,a),i(z),g(A,z)};q(H,A=>{a()!==void 0&&A(Z)})}i(S),i(E),i(r),N((A,z,B,R)=>{f=he(r,"",f,A),T=he(d,"",T,z),F(h,`Nivel ${e.card.level??""}`),F(D,B),F(l,e.card.name),F(ae,R)},[()=>({"border-color":o(e.card.tags)}),()=>({"background-image":`url(${c(e.card.tags)})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),g(s,r),ne()}var pt=(s,e,a)=>e(t(a).id),yt=w('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Ct=(s,e,a)=>e(t(a).id),kt=(s,e,a)=>e(t(a).id),At=w("<button>Desactivar</button>"),wt=(s,e,a)=>e(t(a).id),xt=w("<button>Activar</button>"),St=w('<button>Quitar</button> <span class="spacer"></span> <!>',1),zt=(s,e,a)=>e(t(a)),Et=w('<span class="spacer"></span> <button>Agregar</button>',1),Lt=w('<div class="controls svelte-1rfcjb3"><!></div>'),Pt=w('<div class="cards svelte-1rfcjb3"></div>');function Qt(s,e){le(e,!0);let a=U(e,"readonly",3,!0),o=U(e,"characterCards",19,()=>[]),c=U(e,"listMode",3,"all"),r=U(e,"onChange",3,()=>{}),f=U(e,"onCardReloadClick",3,()=>{}),d=X(o);const T=l=>{const n=e.cards.find(p=>p.id===l);if(!n){_(l);return}I(d,t(d).map(p=>p.id===l?{...p,isActive:!1,uses:b(n)}:p)),r()(t(d))},E=l=>{I(d,t(d).map(n=>n.id===l?{...n,isActive:!0}:n)),r()(t(d))},_=l=>{I(d,t(d).filter(n=>n.id!==l)),r()(t(d))},u=l=>{I(d,[...t(d),{id:l.id,uses:b(l),isActive:!1,level:l.level}]),r()(t(d))},m=(l,n)=>{I(d,t(d).map(p=>p.id===l?{...p,uses:n}:p)),r()(t(d))},h=l=>{const n=t(d).find(p=>p.id===l);return n?n.uses:0},b=l=>{if(l.uses.type===null)return null;switch(l.uses.type){case"USES":case"LONG_REST":return l.uses.qty??0;case"RELOAD":return ie.RELOAD_CARD_USES;default:return null}},D=l=>{const n=t(d).find(p=>p.id===l.id);return n?n.isActive:!1};var P=Pt();ce(P,21,()=>e.cards,l=>l.id,(l,n)=>{bt(l,{get card(){return t(n)},children:(p,$)=>{var L=se(),x=Q(L);{var y=k=>{var S=Lt(),W=v(S);{var ee=H=>{var Z=yt(),A=Q(Z);{var z=R=>{{let K=X(()=>h(t(n).id)),M=X(()=>b(t(n))),G=X(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>f()(t(n).id),disabled:h(t(n).id)===b(t(n))}));dt(R,{get value(){return t(K)},get max(){return t(M)},onChange:V=>m(t(n).id,Number(V)),get button(){return t(G)}})}};q(A,R=>{b(t(n))!==null&&R(z)})}var B=C(A,4);B.__click=[pt,T,n],g(H,Z)},ae=H=>{var Z=se(),A=Q(Z);{var z=R=>{var K=St(),M=Q(K);M.__click=[Ct,_,n];var G=C(M,4);{var V=Y=>{var j=At();j.__click=[kt,T,n],g(Y,j)},de=Y=>{var j=xt();j.__click=[wt,E,n],g(Y,j)};q(G,Y=>{D(t(n))?Y(V):Y(de,!1)})}g(R,K)},B=R=>{var K=Et(),M=C(Q(K),2);M.__click=[zt,u,n],g(R,K)};q(A,R=>{c()==="collection"?R(z):R(B,!1)},!0)}g(H,Z)};q(W,H=>{c()==="active"?H(ee):H(ae,!1)})}i(S),g(k,S)};q(x,k=>{a()||k(y)})}g(p,L)},$$slots:{default:!0}})}),i(P),g(s,P),ne()}oe(["click"]);const Rt=s=>{if(!s.name)throw new Error("Card name is required");return{id:Be(s.name),...s}},ge=Ie([]),Ht=()=>({loadCards:async()=>{if(Ke(ge).length>0)return;const a=await(await fetch(Ge("/docs/cards.yml"))).text();let o=[];try{o=Me(a).cards??[]}catch(c){console.error("Error parsing YAML:",c)}ge.set(o.map(c=>Rt(c)))},cards:ge});export{Kt as C,dt as I,Qt as a,Xe as b,Ht as u};
