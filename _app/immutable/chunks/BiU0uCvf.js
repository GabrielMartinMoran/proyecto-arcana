import{r as He}from"./CrnPV70r.js";import{C as Ce,u as We,a as ze}from"./Bst6R_nm.js";import{w as Re,g as ue}from"./Cje6xDa-.js";import"./DsnmJJEf.js";import{p as U,b as y,ab as L,t as T,K as H,j as a,a as f,d as j,e as g,g as o,bf as Ge,r as d,f as ae,aa as ge,J as ve,aT as Je,c as Ve}from"./4UBXq5Sj.js";import{d as Q,s as W,a as Be,o as Fe,e as Ke}from"./DEyIqfax.js";import{i as O,s as Ye,a as Qe}from"./DY7lAt98.js";import{r as Xe,s as ne,e as le}from"./Z0ud6hNo.js";import{b as Te,s as te}from"./3q36uapf.js";import{p as F}from"./CsZilKOT.js";import{g as Me}from"./BVq0DSPU.js";import{p as re}from"./BZJuPK-p.js";import{c as Ze}from"./DagTf92m.js";import{c as I,u as $e,a as Ie,b as xe,C as et,d as tt,e as at,f as qe,I as q}from"./a7NZIbSW.js";import{c as rt}from"./CGjaQNWU.js";import{b as nt}from"./BIoRDyB-.js";const we="arcana:characters",V={charactersStore:Re([]),exampleCharactersStore:Re([]),charactersAlreadyLoaded:!1,exampleCharactersAlreadyLoaded:!1};let Z=null,ye=null,ce=null,he=null,pe=!1;const Oe="arcana:pendingCharacterDeletes",se=(()=>{try{const n=(()=>{try{return localStorage.getItem(Oe)}catch{return null}})();return n?JSON.parse(n):[]}catch{return[]}})(),Ae=()=>{try{localStorage.setItem(Oe,JSON.stringify(se))}catch(n){console.warn("[characters-service] Failed to persist pending deletes",n)}},lt=async n=>{if(n&&$.isEnabled())for(const t of[...se])try{await $.deleteCharacterForUser(n,t);const e=se.indexOf(t);e!==-1&&(se.splice(e,1),Ae()),console.info("[characters-service] Successfully processed pending delete for",t)}catch(e){console.warn("[characters-service] Failed to process pending delete for",t,e)}},$=We(),ot=()=>{he||(he=V.charactersStore.subscribe(async n=>{if(pe)return;const t=JSON.stringify(n);try{localStorage.setItem(we,t)}catch(e){console.warn("Error saving characters to localStorage:",e)}try{Z&&$.isEnabled()&&await $.saveCharactersForUser(Z,n)}catch(e){console.error("Error persisting characters to cloud:",e)}}))},st=()=>{if(he){try{he()}catch{}he=null}},it=n=>{if(ce){try{ce()}catch{}ce=null}ce=$.listenCharactersForUser(n,t=>{pe=!0;try{V.charactersStore.set(t.map(e=>new Ce(e)))}finally{pe=!1}})},Pe=()=>{if(ce){try{ce()}catch{}ce=null}},hr=()=>{const n=async()=>{if(!V.charactersAlreadyLoaded){try{await $.initFirebase()}catch(r){console.warn("Firebase init error (continuing with local persistence):",r)}try{ye=await $.onAuthState(async r=>{const l=Z;if(Z=r?r.uid:null,l&&l!==Z&&Pe(),Z&&$.isEnabled())try{it(Z),lt(Z).catch(s=>{console.warn("[characters-service] processPendingDeletes failed:",s)})}catch(s){console.error("Error starting remote listener:",s)}else{Pe();const s=localStorage.getItem(we);if(s)try{const C=JSON.parse(s);V.charactersStore.set(C.map(A=>new Ce(A)))}catch(C){console.error("Error parsing characters JSON:",C)}else V.charactersStore.set([])}})}catch(r){console.warn("Auth listener setup error (continuing with local persistence):",r);const l=localStorage.getItem(we);if(l)try{const s=JSON.parse(l);V.charactersStore.set(s.map(C=>new Ce(C)))}catch(s){console.error("Error parsing characters JSON:",s)}}ot(),V.charactersAlreadyLoaded=!0}},t=async()=>{if(V.exampleCharactersAlreadyLoaded)return;let r=[];try{r=await(await fetch(He("/docs/example-characters.json"))).json()}catch(l){console.error("Error fetching example characters:",l)}try{V.exampleCharactersStore.set(r.map(l=>new Ce(l)))}catch(l){console.error("Error parsing example characters JSON:",l)}V.exampleCharactersAlreadyLoaded=!0},e=async r=>{V.charactersStore.update(l=>l.filter(s=>s.id!==r));try{se.includes(r)||(se.push(r),Ae())}catch(l){console.warn("[characters-service] Failed to queue pending delete:",l)}if(Z&&$.isEnabled())try{await $.deleteCharacterForUser(Z,r);const l=se.indexOf(r);l!==-1&&(se.splice(l,1),Ae())}catch(l){console.warn("[characters-service] Immediate cloud delete failed, queued for retry:",l);try{const s=await new Promise(C=>{V.charactersStore.subscribe(A=>C(A))()});await $.saveCharactersForUser(Z,s)}catch(s){console.error("[characters-service] Error syncing characters after failed delete:",s)}}};return{loadCharacters:n,loadExampleCharacters:t,characters:V.charactersStore,exampleCharacters:V.exampleCharactersStore,deleteCharacter:e,cleanup:()=>{if(ye){try{ye()}catch{}ye=null}Pe(),st()}}};var dt=(n,t,e)=>t.onChange(a(e)),ct=y('<input type="text" class="svelte-19nbfo1"/>');function Le(n,t){U(t,!0);let e=F(t,"placeholder",3,void 0),r=L(()=>t.value);var l=ct();Xe(l),l.__input=[dt,t,r],T(()=>{ne(l,"placeholder",e()),l.disabled=t.readonly}),Te(l,()=>a(r),s=>H(r,s)),f(n,l),j()}Q(["input"]);var vt=y("<label> </label>"),ut=(n,t,e)=>t.onChange(a(e)),gt=y("<div><!> <div><textarea></textarea></div></div>");function Se(n,t){U(t,!0);const e=6;let r=F(t,"label",3,void 0),l=F(t,"placeholder",3,""),s=F(t,"maxRows",3,e),C=L(()=>t.value);var A=gt();let P;var p=g(A);{var m=c=>{var _=vt(),k=g(_,!0);d(_),T(()=>W(k,r())),f(c,_)};O(p,c=>{r()&&c(m)})}var u=o(p,2);let S;var i=g(u);Ge(i),i.__input=[ut,t,C];let w;d(u),d(A),T((c,_,k)=>{P=te(A,1,"fieldgroup svelte-o02g58",null,P,c),S=te(u,1,"field svelte-o02g58",null,S,_),i.disabled=t.readonly,ne(i,"placeholder",l()),ne(i,"rows",s()==="unlimited"?void 0:s()),w=te(i,1,"svelte-o02g58",null,w,k)},[()=>({expanded:s()==="unlimited"}),()=>({expanded:s()==="unlimited"}),()=>({expanded:s()==="unlimited"})]),Te(i,()=>a(C),c=>H(C,c)),f(n,A),j()}Q(["input"]);var bt=y('<div class="portrait svelte-8jg83a"><img class="svelte-8jg83a"/></div>'),mt=y("<!> <!>",1);function _t(n,t){U(t,!0);let e=F(t,"character",7);var r=mt(),l=ae(r);{var s=A=>{I(A,{children:(P,p)=>{var m=bt(),u=g(m);d(m),T(()=>{ne(u,"src",e().img),ne(u,"alt",e().name)}),f(P,m)},$$slots:{default:!0}})};O(l,A=>{e().img&&A(s)})}var C=o(l,2);I(C,{children:(A,P)=>{Se(A,{label:"Historia",get value(){return e().story},get readonly(){return t.readonly},onChange:p=>{e().story=p,t.onChange(e())}})},$$slots:{default:!0}}),f(n,r),j()}var ht=(n,t)=>t("ability"),ft=(n,t)=>t("item"),yt=y('<!> <div class="controls svelte-o497rd"><span class="svelte-o497rd">Agregar cartas a tu colección</span> <div class="buttons svelte-o497rd"><button>Agregar Carta de Habilidad</button> <button>Agregar Carta de Objeto Mágico</button></div></div>',1),Ct=y('<div class="empty svelte-o497rd"><em>No se encontraron resultados</em></div>'),kt=y('<div class="cards-tab svelte-o497rd"><!> <!> <!></div> <div class="add-card-modal svelte-o497rd"><div class="all-cards svelte-o497rd"><!> <div class="cards-viewport svelte-o497rd"><!></div></div> <div class="footer svelte-o497rd"><span class="results-count"> </span> <button>Cerrar</button></div></div>',1);function xt(n,t){U(t,!0);let e=F(t,"character",7),{loadAbilityCards:r,abilityCards:l,loadItemCards:s,itemCards:C}=Ie(),{rollExpression:A}=ze();const{buildEmptyFilters:P}=$e();let p=ge(ve(P({onlyAvailables:!0}))),m=ge(ve([])),u=ge(ve({opened:!1,filteredCards:[],allCards:[]}));const S=l.subscribe(()=>{H(u,{...a(u),allCards:[],filteredCards:[]},!0)});Be(()=>{S()}),Fe(async()=>{await Promise.all([s(),r()]),H(m,[...ue(C),...ue(l)],!0)});const i=N=>{e().cards=N,t.onChange(e())},w=async N=>{const D=e().cards.find(G=>G.id===N),Y=a(m).find(G=>G.id===N);D&&Y&&D.uses!==null&&Y&&await A({expression:"1d6",variables:{},title:`${e().name}: Recarga de carta ${Y.name}`,resultFormatter:ee=>`<span class="total ${ee>=(Y.uses?.qty??0)?"success":"failure"}">${ee}</span>`})>=(Y.uses?.qty??0)&&(D.uses+=1,i([...e().cards]))},c=N=>{H(p,N,!0),H(u,{...a(u),filteredCards:qe(a(u).allCards,a(p),e())},!0)},_=()=>{c(P({onlyAvailables:!0}))},k=N=>{setTimeout(()=>{const D=N==="ability"?ue(l):ue(C);H(u,{opened:!0,filteredCards:qe(D,a(p),e()),allCards:D},!0)},0)},x=()=>{H(u,{opened:!1,filteredCards:[],allCards:[]},!0)};var v=kt(),b=ae(v),h=g(b);{var E=N=>{I(N,{children:(D,Y)=>{var G=yt(),ee=ae(G);q(ee,{label:"Ranuras de Cartas Activas",labelWidth:"fit",get value(){return e().maxActiveCards},get readonly(){return t.readonly},fullWidth:!0,onChange:je=>{e().maxActiveCards=Number(je),t.onChange(e())}});var fe=o(ee,2),Ee=o(g(fe),2),Ne=g(Ee);Ne.__click=[ht,k];var Ue=o(Ne,2);Ue.__click=[ft,k],d(Ee),d(fe),f(D,G)},$$slots:{default:!0}})};O(h,N=>{t.readonly||N(E)})}var M=o(h,2);I(M,{get title(){return`Cartas Activas (${e().numActiveCards??""}/${e().maxActiveCards??""})`},children:(N,D)=>{{let Y=L(()=>a(m).filter(G=>e().cards.some(ee=>ee.isActive&&ee.id===G.id)));xe(N,{get cards(){return a(Y)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"active",onChange:i,onCardReloadClick:w})}},$$slots:{default:!0}});var B=o(M,2);{let N=L(()=>`Colección (${e().cards.length})`);I(B,{get title(){return a(N)},children:(D,Y)=>{{let G=L(()=>a(m).filter(ee=>e().cards.some(fe=>fe.id===ee.id)));xe(D,{get cards(){return a(G)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"collection",onChange:i})}},$$slots:{default:!0}})}d(b);var X=o(b,2),ie=g(X),R=g(ie);et(R,{get cards(){return a(u).filteredCards},onFiltersChange:c,onResetFilters:_,get filters(){return a(p)},includeOnlyAvailablesFilter:!0});var z=o(R,2),J=g(z);{var K=N=>{{let D=L(()=>a(u).filteredCards.filter(Y=>e().cards.find(G=>G.id===Y.id)===void 0));xe(N,{get cards(){return a(D)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"all",onChange:i})}},oe=N=>{var D=Ct();f(N,D)};O(J,N=>{a(u).filteredCards.length>0?N(K):N(oe,!1)})}d(z),d(ie);var de=o(ie,2),be=g(de),me=g(be);d(be);var ke=o(be,2);ke.__click=x,d(de),d(X),tt(X,N=>at?.(N)),T(()=>{ne(X,"hidden",!a(u).opened),W(me,`${a(u).filteredCards.length??""}
			${a(u).filteredCards.length===1?"resultado":"resultados"}`)}),Ke("outsideclick",X,x),f(n,v),j()}Q(["click"]);const Pt=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"add",value:t.quantity,reason:t.reason||e};r().goldHistory.unshift(C),l.onChange(r()),s()},wt=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"subtract",value:t.quantity,reason:t.reason||e};r().goldHistory.unshift(C),l.onChange(r()),s()};var pt=y('<div class="status svelte-ssntdk"><div class="indicator svelte-ssntdk"><span>Oro Actual</span> <strong> </strong></div> <div class="indicator svelte-ssntdk"><span>Oro Gastado</span> <strong class="number svelte-ssntdk"> </strong></div></div>'),At=y('<div class="editor svelte-ssntdk"><div class="labels svelte-ssntdk"><label class="qty svelte-ssntdk">Cantidad</label> <label class="reason svelte-ssntdk">Razón</label> <label class="btn svelte-ssntdk"></label> <label class="btn svelte-ssntdk"></label></div> <div class="controls svelte-ssntdk"><!> <!> <button title="Gastar Oro" class="svelte-ssntdk">-</button> <button title="Ganar Oro" class="svelte-ssntdk">+</button></div></div>'),St=(n,t,e)=>t(a(e)),Et=y('<div class="log-content svelte-ssntdk"><strong> </strong> <span class="log-reason svelte-ssntdk"> </span> <button title="Deshacer esta acción">↶</button></div>'),Nt=y('<div class="empty svelte-ssntdk"><em>No hay registros</em></div>'),Rt=y('<div class="history svelte-ssntdk"></div>'),Mt=y("<!> <!> <!>",1);function qt(n,t){U(t,!0);const e="Sin razón especifica";let r=F(t,"character",7),l=ve({quantity:1,reason:""});const s=()=>{l.quantity=1,l.reason=""},C=S=>{r().goldHistory=r().goldHistory.filter(i=>i.id!==S.id),t.onChange(r())};var A=Mt(),P=ae(A);I(P,{title:"Estado Actual",children:(S,i)=>{var w=pt(),c=g(w),_=o(g(c),2);let k;var x=g(_,!0);d(_),d(c);var v=o(c,2),b=o(g(v),2),h=g(b,!0);d(b),d(v),d(w),T(E=>{k=te(_,1,"number svelte-ssntdk",null,k,E),W(x,r().currentGold),W(h,r().spentGold)},[()=>({negative:r().currentGold<0})]),f(S,w)},$$slots:{default:!0}});var p=o(P,2);{var m=S=>{I(S,{title:"Actualizar Oro",children:(i,w)=>{var c=At(),_=o(g(c),2),k=g(_);q(k,{get value(){return l.quantity},placeholder:"Cantidad",fullWidth:!1,onChange:h=>{l.quantity=Number(h)}});var x=o(k,2);q(x,{get value(){return l.reason},placeholder:"Razón",fullWidth:!0,onChange:h=>{l.reason=h.toString()}});var v=o(x,2);v.__click=[wt,l,e,r,t,s];var b=o(v,2);b.__click=[Pt,l,e,r,t,s],d(_),d(c),f(i,c)},$$slots:{default:!0}})};O(p,S=>{t.readonly||S(m)})}var u=o(p,2);I(u,{title:"Historial",children:(S,i)=>{var w=Rt();le(w,21,()=>r().goldHistory,c=>c.id,(c,_)=>{var k=Et(),x=g(k);let v;var b=g(x);d(x);var h=o(x,2),E=g(h,!0);d(h);var M=o(h,2);M.__click=[St,C,_],d(k),T(B=>{v=te(x,1,"log-amount svelte-ssntdk",null,v,B),W(b,`${a(_).type==="add"?"+":"-"}${a(_).value??""} Oro`),W(E,a(_).reason)},[()=>({positive:a(_).type==="add",negative:a(_).type==="subtract"})]),f(c,k)},c=>{var _=Nt();f(c,_)}),d(w),f(S,w)},$$slots:{default:!0}}),f(n,A),j()}Q(["click"]);const Dt=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),name:"",atkFormula:"",dmgFormula:"",notes:""}]),e.onChange(t())};var zt=y('<button title="Agregar Ataque">➕</button>'),Ft=(n,t,e)=>t(a(e)),Tt=y('<button title="Eliminar" class="svelte-1v2w3y3">🗑️</button>'),It=y('<div class="item svelte-1v2w3y3"><!> <!> <!> <!> <!></div>'),Ot=y('<div class="attack-list svelte-1v2w3y3"><div class="header svelte-1v2w3y3"><label>Ataques</label> <!></div> <div class="content svelte-1v2w3y3"><div class="attacks-header svelte-1v2w3y3"><label class="name svelte-1v2w3y3">Nombre</label> <label class="atk-formula svelte-1v2w3y3">Formula Ataque</label> <label class="dmg-formula svelte-1v2w3y3">Formula Daño</label> <label class="notes svelte-1v2w3y3">Notas</label> <label class="actions svelte-1v2w3y3"></label></div> <!></div></div>');function Lt(n,t){U(t,!0);let e=F(t,"attacks",7);const r=m=>{e(e().filter(u=>u.id!==m.id)),t.onChange(e())};var l=Ot(),s=g(l),C=o(g(s),2);{var A=m=>{var u=zt();u.__click=[Dt,e,t],f(m,u)};O(C,m=>{t.readonly||m(A)})}d(s);var P=o(s,2),p=o(g(P),2);le(p,17,e,m=>m.id,(m,u,S)=>{var i=It(),w=g(i);q(w,{get value(){return a(u).name},get readonly(){return t.readonly},placeholder:"Nombre",fullWidth:!0,onChange:b=>{a(u).name=b.toString(),t.onChange(e())}});var c=o(w,2);{let b=L(()=>({icon:"🎯",title:"Tirar Ataque",onClick:()=>t.onAttackRoll(a(u)),disabled:!a(u).atkFormula}));q(c,{get value(){return a(u).atkFormula},get readonly(){return t.readonly},placeholder:"1d6e+cuerpo",fullWidth:!0,onChange:h=>{a(u).atkFormula=h.toString(),t.onChange(e())},get button(){return a(b)}})}var _=o(c,2);{let b=L(()=>({icon:"💥",title:"Tirar Daño",onClick:()=>t.onDamageRoll(a(u)),disabled:!a(u).dmgFormula}));q(_,{get value(){return a(u).dmgFormula},get readonly(){return t.readonly},placeholder:"1d4",fullWidth:!0,onChange:h=>{a(u).dmgFormula=h.toString(),t.onChange(e())},get button(){return a(b)}})}var k=o(_,2);q(k,{get value(){return a(u).notes},get readonly(){return t.readonly},placeholder:"Contundente",fullWidth:!0,onChange:b=>{a(u).notes=b.toString(),t.onChange(e())}});var x=o(k,2);{var v=b=>{var h=Tt();h.__click=[Ft,r,u],f(b,h)};O(x,b=>{t.readonly||b(v)})}d(i),f(m,i)}),d(P),d(l),f(n,l),j()}Q(["click"]);function _e(n,t){U(t,!0);{let e=L(()=>({icon:"🎲",onClick:t.onDiceRoll,title:"Tirar"}));q(n,{get label(){return t.name},get value(){return t.value},get readonly(){return t.readonly},onChange:r=>t.onChange(Number(r)),get button(){return a(e)}})}j()}const Ut=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),quantity:1,name:"",notes:""}]),e.onChange(t())};var jt=y('<button title="Agregar Item">➕</button>'),Ht=(n,t,e)=>t(a(e)),Wt=y('<button title="Eliminar">🗑️</button>'),Gt=y('<div class="item svelte-1ewnrao"><!> <!> <!> <!></div>'),Jt=y('<div class="equipment-list svelte-1ewnrao"><div class="header svelte-1ewnrao"><label>Equipo</label> <!></div> <div class="content svelte-1ewnrao"><div class="items-header svelte-1ewnrao"><label class="quantity svelte-1ewnrao">Cantidad</label> <label class="name svelte-1ewnrao">Nombre</label> <label class="notes svelte-1ewnrao">Notas</label></div> <!></div></div>');function Vt(n,t){U(t,!0);let e=F(t,"equipment",7);const r=m=>{e(e().filter(u=>u.id!==m.id)),t.onChange(e())};var l=Jt(),s=g(l),C=o(g(s),2);{var A=m=>{var u=jt();u.__click=[Ut,e,t],f(m,u)};O(C,m=>{t.readonly||m(A)})}d(s);var P=o(s,2),p=o(g(P),2);le(p,17,e,m=>m.id,(m,u,S)=>{var i=Gt(),w=g(i);q(w,{get value(){return a(u).quantity},get readonly(){return t.readonly},onChange:v=>{a(u).quantity=Number(v),t.onChange(e())}});var c=o(w,2);q(c,{get value(){return a(u).name},get readonly(){return t.readonly},placeholder:"Nombre",onChange:v=>{a(u).name=v.toString(),t.onChange(e())}});var _=o(c,2);q(_,{get value(){return a(u).notes},get readonly(){return t.readonly},placeholder:"Notas",fullWidth:!0,onChange:v=>{a(u).notes=v.toString(),t.onChange(e())}});var k=o(_,2);{var x=v=>{var b=Wt();b.__click=[Ht,r,u],f(v,b)};O(k,v=>{t.readonly||v(x)})}d(i),f(m,i)}),d(P),d(l),f(n,l),j()}Q(["click"]);var Bt=y('<div class="attributes svelte-ox7hjw"><!> <!> <!> <!> <!> <!></div>'),Kt=y('<div class="attributes svelte-ox7hjw"><!> <!> <!> <!> <!> <!> <!></div>'),Yt=y('<div class="empty svelte-ox7hjw"><em>No hay ataques cargados.</em></div>'),Qt=y('<div class="info svelte-ox7hjw"><!> <!> <!> <!></div>'),Xt=y('<div class="empty svelte-ox7hjw"><em>El equipo esta vacío.</em></div>'),Zt=y('<div class="equipment svelte-ox7hjw"><!> <!> <!></div>'),$t=y("<!> <!> <!> <!>",1);function ea(n,t){U(t,!0);let e=F(t,"character",7),{rollExpression:r,rollModal:l}=ze();const s=i=>{l.openRollModal({expression:`1d6e+${i}`,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence,iniciativa:e().initiative},title:`${e().name}: ${rt(i)}`})},C=i=>{l.openRollModal({expression:i.atkFormula,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence},title:`${e().name}: Ataque con ${i.name}`})},A=i=>{r({expression:i.dmgFormula,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence},title:`${e().name}: Daño de ${i.name}`})};var P=$t(),p=ae(P);I(p,{title:"Atributos Principales",children:(i,w)=>{var c=Bt(),_=g(c);_e(_,{name:"Cuerpo",get value(){return e().attributes.body},get readonly(){return t.readonly},onDiceRoll:()=>s("cuerpo"),onChange:E=>{e().attributes.body=E,t.onChange(e())}});var k=o(_,2);_e(k,{name:"Reflejos",get value(){return e().attributes.reflexes},get readonly(){return t.readonly},onDiceRoll:()=>s("reflejos"),onChange:E=>{e().attributes.reflexes=E,t.onChange(e())}});var x=o(k,2);_e(x,{name:"Mente",get value(){return e().attributes.mind},get readonly(){return t.readonly},onDiceRoll:()=>s("mente"),onChange:E=>{e().attributes.mind=E,t.onChange(e())}});var v=o(x,2);_e(v,{name:"Instinto",get value(){return e().attributes.instinct},get readonly(){return t.readonly},onDiceRoll:()=>s("instinto"),onChange:E=>{e().attributes.instinct=E,t.onChange(e())}});var b=o(v,2);_e(b,{name:"Presencia",get value(){return e().attributes.presence},get readonly(){return t.readonly},onDiceRoll:()=>s("presencia"),onChange:E=>{e().attributes.presence=E,t.onChange(e())}});var h=o(b,2);q(h,{label:"Suerte",get value(){return e().currentLuck},get max(){return e().maxLuck},get readonly(){return t.readonly},onChange:E=>{e().currentLuck=Number(E),t.onChange(e())}}),d(c),f(i,c)},$$slots:{default:!0}});var m=o(p,2);I(m,{title:"Atributos Derivados",children:(i,w)=>{var c=Kt(),_=g(c);q(_,{label:"Salud",get value(){return e().currentHP},get max(){return e().maxHP},get readonly(){return t.readonly},onChange:M=>{e().currentHP=Number(M),t.onChange(e())}});var k=o(_,2);q(k,{label:"Salud Temporal",get value(){return e().tempHP},get readonly(){return t.readonly},onChange:M=>{e().tempHP=Number(M),t.onChange(e())}});var x=o(k,2);q(x,{label:"Velocidad",get value(){return e().speed},readonly:!0});var v=o(x,2);q(v,{label:"Esquiva",get value(){return e().evasion},readonly:!0});var b=o(v,2);q(b,{label:"Mitigación Física",get value(){return e().physicalMitigation},readonly:!0});var h=o(b,2);q(h,{label:"Mitigación Mágica",get value(){return e().magicalMitigation},readonly:!0});var E=o(h,2);q(E,{label:"Iniciativa",get value(){return e().initiative},readonly:!0,button:{icon:"🎲",title:"Tirar iniciativa",onClick:()=>s("iniciativa")}}),d(c),f(i,c)},$$slots:{default:!0}});var u=o(m,2);I(u,{title:"Información",children:(i,w)=>{var c=Qt(),_=g(c);Lt(_,{get attacks(){return e().attacks},get readonly(){return t.readonly},onChange:h=>{e().attacks=h,t.onChange(e())},onAttackRoll:C,onDamageRoll:A});var k=o(_,2);{var x=h=>{var E=Yt();f(h,E)};O(k,h=>{e().attacks.length===0&&h(x)})}var v=o(k,2);Se(v,{label:"Información Rápida",get value(){return e().quickInfo},get readonly(){return t.readonly},placeholder:"Información general, habilidades, etc.",onChange:h=>{e().quickInfo=h,t.onChange(e())}});var b=o(v,2);q(b,{label:"Lenguas",get value(){return e().languages},get readonly(){return t.readonly},fullWidth:!0,placeholder:"Lista de lenguas concidas",textAlign:"left",onChange:h=>{e().languages=h,t.onChange(e())}}),d(c),f(i,c)},$$slots:{default:!0}});var S=o(u,2);I(S,{title:"Equipo",children:(i,w)=>{var c=Zt(),_=g(c);q(_,{label:"Oro",get value(){return e().currentGold},readonly:!0,fullWidth:!0});var k=o(_,2);Vt(k,{get equipment(){return e().equipment},get readonly(){return t.readonly},onChange:b=>{e().equipment=b,t.onChange(e())}});var x=o(k,2);{var v=b=>{var h=Xt();f(b,h)};O(x,b=>{e().equipment.length===0&&b(v)})}d(c),f(i,c)},$$slots:{default:!0}}),f(n,P),j()}const ta=(n,t,e,r)=>{const l={id:crypto.randomUUID(),title:"Nota Nueva",content:""};H(t,[...a(t),l],!0),e.onChange(a(t)),r(l)};var aa=(n,t,e)=>t(a(e)),ra=y('<div class="header svelte-z1ulbz"><button title="Agregar Nota">➕</button> <button title="Eliminar Nota">🗑️</button></div>'),na=(n,t,e)=>t(a(e)),la=y('<button><span class="svelte-z1ulbz"> </span></button>'),oa=y('<div class="notes svelte-z1ulbz"></div>'),sa=y('<div class="notes empty svelte-z1ulbz"><em>No hay notas</em></div>'),ia=y('<div class="note svelte-z1ulbz"><!> <!></div>'),da=y('<div class="note empty svelte-z1ulbz"><em>No hay ninguna nota seleccionada</em></div>'),ca=y('<div class="notes svelte-z1ulbz"><div class="list svelte-z1ulbz"><!> <!></div> <div class="content svelte-z1ulbz"><!></div></div>');function va(n,t){U(t,!0);let e=ge(ve(t.notes)),r=ge(void 0),l=L(()=>a(e).find(v=>v.id===a(r)));const s=v=>{H(r,v.id,!0)},C=v=>{v&&(H(e,a(e).filter(b=>b.id!==v),!0),H(r,void 0),t.onChange(a(e)))},A=()=>{H(e,[...a(e)],!0),t.onChange(a(e))};var P=ca(),p=g(P),m=g(p);{var u=v=>{var b=ra(),h=g(b);h.__click=[ta,e,t,s];var E=o(h,2);E.__click=[aa,C,r],d(b),T(()=>E.disabled=!a(l)),f(v,b)};O(m,v=>{t.readonly||v(u)})}var S=o(m,2);{var i=v=>{var b=oa();le(b,21,()=>a(e),h=>h.id,(h,E)=>{var M=la();let B;M.__click=[na,s,E];var X=g(M),ie=g(X,!0);d(X),d(M),T(R=>{B=te(M,1,"note-btn svelte-z1ulbz",null,B,R),W(ie,a(E).title||"Nota sin título")},[()=>({selected:a(r)===a(E).id})]),f(h,M)}),d(b),f(v,b)},w=v=>{var b=sa();f(v,b)};O(S,v=>{a(e).length>0?v(i):v(w,!1)})}d(p);var c=o(p,2),_=g(c);{var k=v=>{var b=ia(),h=g(b);Le(h,{get value(){return a(l).title},get readonly(){return t.readonly},placeholder:"Título de la nota",onChange:M=>{a(l).title=M,A()}});var E=o(h,2);Se(E,{get value(){return a(l).content},get readonly(){return t.readonly},placeholder:"Contenido de la nota",onChange:M=>{a(l).content=M,A()},maxRows:"unlimited"}),d(b),f(v,b)},x=v=>{var b=da();f(v,b)};O(_,v=>{a(l)?v(k):v(x,!1)})}d(c),d(P),f(n,P),j()}Q(["click"]);function ua(n,t){U(t,!0);let e=F(t,"character",7);I(n,{title:"Notas",children:(r,l)=>{va(r,{get notes(){return e().notes},get readonly(){return t.readonly},onChange:s=>{e().notes=s,t.onChange(e())}})},$$slots:{default:!0}}),j()}const ga=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"add",value:t.quantity,reason:t.reason||e};r().ppHistory.unshift(C),l.onChange(r()),s()},ba=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"subtract",value:t.quantity,reason:t.reason||e};r().ppHistory.unshift(C),l.onChange(r()),s()};var ma=y('<div class="status svelte-1cdo061"><div class="indicator svelte-1cdo061"><span>PP Actuales</span> <strong> </strong></div> <div class="indicator svelte-1cdo061"><span>PP Gastados</span> <strong class="number svelte-1cdo061"> </strong></div> <div class="indicator svelte-1cdo061"><span>Poder de PJ</span> <strong class="number svelte-1cdo061"> </strong></div></div>'),_a=y('<div class="editor svelte-1cdo061"><div class="labels svelte-1cdo061"><label class="qty svelte-1cdo061">Cantidad</label> <label class="reason svelte-1cdo061">Razón</label> <label class="btn svelte-1cdo061"></label> <label class="btn svelte-1cdo061"></label></div> <div class="controls svelte-1cdo061"><!> <!> <button title="Gastar PP" class="svelte-1cdo061">-</button> <button title="Ganar PP" class="svelte-1cdo061">+</button></div></div>'),ha=(n,t,e)=>t(a(e)),fa=y('<div class="log-content svelte-1cdo061"><strong> </strong> <span class="log-reason svelte-1cdo061"> </span> <button title="Deshacer esta acción">↶</button></div>'),ya=y('<div class="empty svelte-1cdo061"><em>No hay registros</em></div>'),Ca=y('<div class="history svelte-1cdo061"></div>'),ka=y("<!> <!> <!>",1);function xa(n,t){U(t,!0);const e="Sin razón especifica";let r=F(t,"character",7),l=ve({quantity:1,reason:""});const s=()=>{l.quantity=1,l.reason=""},C=S=>{r().ppHistory=r().ppHistory.filter(i=>i.id!==S.id),t.onChange(r())};var A=ka(),P=ae(A);I(P,{title:"Estado Actual",children:(S,i)=>{var w=ma(),c=g(w),_=o(g(c),2);let k;var x=g(_,!0);d(_),d(c);var v=o(c,2),b=o(g(v),2),h=g(b,!0);d(b),d(v);var E=o(v,2),M=o(g(E),2),B=g(M,!0);d(M),d(E),d(w),T(X=>{k=te(_,1,"number svelte-1cdo061",null,k,X),W(x,r().currentPP),W(h,r().spentPP),W(B,r().pjPower)},[()=>({negative:r().currentPP<0})]),f(S,w)},$$slots:{default:!0}});var p=o(P,2);{var m=S=>{I(S,{title:"Actualizar Progreso",children:(i,w)=>{var c=_a(),_=o(g(c),2),k=g(_);q(k,{get value(){return l.quantity},placeholder:"Cantidad",fullWidth:!1,onChange:h=>{l.quantity=Number(h)}});var x=o(k,2);q(x,{get value(){return l.reason},placeholder:"Razón",fullWidth:!0,onChange:h=>{l.reason=h.toString()}});var v=o(x,2);v.__click=[ba,l,e,r,t,s];var b=o(v,2);b.__click=[ga,l,e,r,t,s],d(_),d(c),f(i,c)},$$slots:{default:!0}})};O(p,S=>{t.readonly||S(m)})}var u=o(p,2);I(u,{title:"Historial",children:(S,i)=>{var w=Ca();le(w,21,()=>r().ppHistory,c=>c.id,(c,_)=>{var k=fa(),x=g(k);let v;var b=g(x);d(x);var h=o(x,2),E=g(h,!0);d(h);var M=o(h,2);M.__click=[ha,C,_],d(k),T(B=>{v=te(x,1,"log-amount svelte-1cdo061",null,v,B),W(b,`${a(_).type==="add"?"+":"-"}${a(_).value??""} PP`),W(E,a(_).reason)},[()=>({positive:a(_).type==="add",negative:a(_).type==="subtract"})]),f(c,k)},c=>{var _=ya();f(c,_)}),d(w),f(S,w)},$$slots:{default:!0}}),f(n,A),j()}Q(["click"]);const Pa=(n,t)=>{let e="";if(e+=`# ${n.name}

`,e+=`## Atributos
`,e+=`- **Cuerpo:** ${n.attributes.body}
`,e+=`- **Reflejos:** ${n.attributes.reflexes}
`,e+=`- **Mente:** ${n.attributes.mind}
`,e+=`- **Instinto:** ${n.attributes.instinct}
`,e+=`- **Presencia:** ${n.attributes.presence}

`,e+=`- **Suerte:** ${n.currentLuck}/${n.maxLuck}
`,e+=`
`,e+=`## Atributos derivados
`,e+=`- **Salud:** ${n.currentHP}/${n.maxHP}
`,e+=`- **Salud Temporal:** ${n.tempHP}
`,e+=`- **Velocidad:** ${n.speed}
`,e+=`- **Esquiva:** ${n.evasion}
`,e+=`- **Mitigación Física:** ${n.physicalMitigation}
`,e+=`- **Mitigación Mágica:** ${n.magicalMitigation}
`,e+=`- **Iniciativa:** ${n.initiative}
`,e+=`
`,n.quickInfo&&(e+=`## Información Rápida
`,e+=`\`\`\`${n.quickInfo}
\`\`\`
`,e+=`
`),e+=`## Lenguas
`,e+=`${n.languages||"-"}
`,e+=`
`,e+=`## Oro
`,e+=`${n.currentGold}
`,e+=`
`,e+=`## Inventario
`,n.equipment.length>0){e+=`| Cantidad | Nombre | Notas |
`,e+=`| - | - | - |
`;for(const r of n.equipment)e+=`| ${r.quantity} | ${r.name} | ${r.notes} |
`}else e+=`__No hay items en el inventario.__
`;if(e+=`
`,e+=`## Cartas
`,e+=`**Cartas activas:** ${n.numActiveCards}${n.maxActiveCards}
`,e+=`### Colección
`,n.cards.length>0){e+=`| Nombre | Tipo | Activa |
`,e+=`| - | - | - |
`;for(const r of n.cards){const l=t.find(s=>s.id===r.id);l&&(e+=`| ${l.name} | ${l.cardType==="item"?"Objeto Mágico":"Habilidad"} | ${r.isActive?"Si":"No"} |
`)}}else e+=`__No hay cartas en la colección.__
`;if(e+=`
`,e+=`## Progreso
`,e+=`- **PP Actuales:** ${n.currentPP}
`,e+=`- **PP Gastados:** ${n.spentPP}
`,e+=`- **Poder de Personaje:** ${n.pjPower}
`,e+=`
`,n.story&&(e+=`## Historia
`,e+=`${n.story}
`,e+=`
`),n.notes.length>0){e+=`## Notas del Jugador
`;for(const r of n.notes)e+=`### ${r.title}
`,e+=`\`\`\`${r.content}\`\`\`
`;e+=`
`}return e},wa=async(n,t)=>{try{await navigator.clipboard.writeText(a(t)),alert("Personaje en formato Markdown copiado al portapapeles!")}catch(e){console.error("Failed to copy text: ",e),alert("Error al copiar el markdown al portapapeles")}};var pa=y('<div class="header svelte-1m8ejye"><label>Personaje</label> <button>Copiar Markdown</button></div> <pre class="svelte-1m8ejye"> </pre>',1);function Aa(n,t){U(t,!0);let e=ge(ve([])),{loadAbilityCards:r,abilityCards:l,loadItemCards:s,itemCards:C}=Ie(),A=L(()=>Pa(t.character,a(e)));Fe(async()=>{await Promise.all([s(),r()]),H(e,[...ue(C),...ue(l)],!0)}),I(n,{children:(P,p)=>{var m=pa(),u=ae(m),S=o(g(u),2);S.__click=[wa,A],d(u);var i=o(u,2),w=g(i,!0);d(i),T(()=>W(w,a(A))),f(P,m)},$$slots:{default:!0}}),j()}Q(["click"]);var Sa=(n,t,e)=>t()(a(e)),Ea=y("<option> </option>"),Na=y('<div class="fieldgroup svelte-1oyc7vz"><select></select></div>');function De(n,t){U(t,!0);let e=F(t,"onChange",3,()=>{}),r=L(()=>t.value);var l=Na(),s=g(l);s.__change=[Sa,e,r],le(s,21,()=>t.options,C=>C.label,(C,A)=>{var P=Ea(),p=g(P,!0);d(P);var m={};T(()=>{W(p,a(A).label),m!==(m=a(A).value)&&(P.value=(P.__value=a(A).value)??"")}),f(C,P)}),d(s),d(l),nt(s,()=>a(r),C=>H(r,C)),f(n,l),j()}Q(["change"]);const Ra=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),attribute:"maxHP",type:"add",formula:"",reason:""}]),e.onChange(t())};var Ma=(n,t,e)=>t(a(e)),qa=y('<div class="modifier svelte-1n17zba"><!> <!> <!> <!> <button title="Eliminar" class="svelte-1n17zba">🗑️</button></div>'),Da=y('<div class="empty svelte-1n17zba"><em>No hay modificadores disponibles</em></div>'),za=y('<div class="modifier-list svelte-1n17zba"><div class="header svelte-1n17zba"><label>Modificadores</label> <button title="Agregar Modificador">➕</button></div> <div class="content svelte-1n17zba"><div class="modifiers-header svelte-1n17zba"><label class="type svelte-1n17zba">Tipo</label> <label class="field svelte-1n17zba">Atributo</label> <label class="formula svelte-1n17zba">Formula</label> <label class="label svelte-1n17zba">Razón</label> <label class="btn svelte-1n17zba"></label></div> <!></div></div>');function Fa(n,t){U(t,!0);let e=F(t,"modifiers",7);const r=p=>{e(e().filter(m=>m.id!==p.id)),t.onChange(e())};var l=za(),s=g(l),C=o(g(s),2);C.__click=[Ra,e,t],d(s);var A=o(s,2),P=o(g(A),2);le(P,17,e,p=>p.id,(p,m,u)=>{var S=qa(),i=g(S);De(i,{options:[{label:"Sumar",value:"add"},{label:"Establecer",value:"set"}],get value(){return a(m).type},onChange:x=>{a(m).type=x.toString(),t.onChange(e())}});var w=o(i,2);De(w,{options:[{label:"Salud Máxima",value:"maxHP"},{label:"Suerte Máxima",value:"maxLuck"},{label:"Esquiva",value:"evasion"},{label:"Mitigación Física",value:"physicalMitigation"},{label:"Mitigación Mágica",value:"magicalMitigation"},{label:"Velocidad",value:"speed"}],get value(){return a(m).attribute},onChange:x=>{a(m).attribute=x.toString(),t.onChange(e())}});var c=o(w,2);q(c,{get value(){return a(m).formula},placeholder:"1+cuerpo",fullWidth:!0,onChange:x=>{a(m).formula=x.toString(),t.onChange(e())}});var _=o(c,2);q(_,{get value(){return a(m).reason},placeholder:"Razón",fullWidth:!0,onChange:x=>{a(m).reason=x.toString(),t.onChange(e())}});var k=o(_,2);k.__click=[Ma,r,m],d(S),f(p,S)},p=>{var m=Da();f(p,m)}),d(A),d(l),f(n,l),j()}Q(["click"]);var Ta=y('<div class="general svelte-1hn03u3"><!></div>'),Ia=y('<div class="modifiers svelte-1hn03u3"><!> <small class="available-variables svelte-1hn03u3"><em>Varaibles disponibles: cuerpo, reflejos, mente, instinto, presencia.</em></small></div>'),Oa=y("<!> <!>",1);function La(n,t){U(t,!0);let e=F(t,"character",7);var r=Oa(),l=ae(r);I(l,{title:"General",children:(C,A)=>{var P=Ta(),p=g(P);{let m=L(()=>e().img??"");q(p,{label:"URL del Retrato",get value(){return a(m)},fullWidth:!0,placeholder:"https://...",textAlign:"left",onChange:u=>{const S=u.toString();S.length>0?e().img=S:e().img=null,t.onChange(e())}})}d(P),f(C,P)},$$slots:{default:!0}});var s=o(l,2);I(s,{title:"Modificadores",children:(C,A)=>{var P=Ia(),p=g(P);Fa(p,{get modifiers(){return e().modifiers},onChange:m=>{e().modifiers=m,t.onChange(e())}}),Je(2),d(P),f(C,P)},$$slots:{default:!0}}),f(n,r),j()}var Ua=y("<button> </button>"),ja=y('<div class="character-sheet svelte-1dl9cdg"><div class="title"><!></div> <div class="tabs svelte-1dl9cdg"></div> <!></div>');function Ha(n,t){U(t,!0);let e=F(t,"character",7);const r=[{name:"general",title:"General",component:ea,availableWhenReadOnly:!0},{name:"cards",title:"Cartas",component:xt,availableWhenReadOnly:!0},{name:"bio",title:"Bio",component:_t,availableWhenReadOnly:!0},{name:"notes",title:"Notas",component:ua,availableWhenReadOnly:!0},{name:"progress",title:"Progreso",component:xa,availableWhenReadOnly:!0},{name:"economy",title:"Economía",component:qt,availableWhenReadOnly:!0},{name:"settings",title:"Configuración",component:La,availableWhenReadOnly:!1},{name:"see_as_md",title:"Ver como MD",component:Aa,availableWhenReadOnly:!0}];let l=L(()=>Math.max(r.findIndex(i=>i.name===t.currentTab),0)),s=L(()=>r.find(i=>i.name===t.currentTab)??r[0]);const C=i=>{const w=i.copy();t.onChange(w),e(w)},A=i=>{H(l,i),t.onTabChange(r[i].name)};var P=ja(),p=g(P),m=g(p);Le(m,{get value(){return e().name},get readonly(){return t.readonly},onChange:i=>{e().name=i,C(e())}}),d(p);var u=o(p,2);le(u,23,()=>r,i=>i.title,(i,w,c)=>{var _=Ve(),k=ae(_);{var x=v=>{var b=Ua();let h;b.__click=()=>A(a(c));var E=g(b,!0);d(b),T(M=>{h=te(b,1,"tab",null,h,M),W(E,a(w).title)},[()=>({selected:a(l)===a(c)})]),f(v,b)};O(k,v=>{(a(w).availableWhenReadOnly||!t.readonly)&&v(x)})}f(i,_)}),d(u);var S=o(u,2);Ze(S,()=>a(s).component,(i,w)=>{w(i,{get character(){return e()},get readonly(){return t.readonly},onChange:C})}),d(P),f(n,P),j()}Q(["click"]);const Wa=async(n,t,e)=>{const r=await t()();e(r)},Ga=async(n,t,e)=>{const r=await t()();e(r)},Ja=async(n,t,e)=>{a(t)&&await e()(a(t))},Va=async(n,t,e,r)=>{!a(t)||!confirm(`¿Quieres eliminar a ${a(t).name}?`)||(await e()(a(t)),H(t,void 0),r(null))},Ba=async(n,t,e)=>{a(t)&&await e()(a(t))};var Ka=y('<button title="Importar y Editar">📝</button>'),Ya=y('<button title="Crear">➕</button> <button title="Importar">📥</button> <button title="Exportar">📤</button> <button title="Eliminar">🗑️</button>',1),Qa=(n,t,e)=>t(a(e)),Xa=y('<img class="character-image svelte-dk16f3"/>'),Za=y('<span class="image-placeholder svelte-dk16f3"> </span>'),$a=y('<button><!> <span class="name svelte-dk16f3"> </span></button>'),er=y('<section class="characters-page svelte-dk16f3"><div class="list svelte-dk16f3"><div class="header svelte-dk16f3"><!></div> <div class="content svelte-dk16f3"></div></div> <div class="viewport svelte-dk16f3"><!></div></section>');function fr(n,t){U(t,!0);const e=()=>Qe(t.characters,"$characters",r),[r,l]=Ye(),s="general";let C=F(t,"onAddToMyCharacters",3,()=>{throw new Error("onAddToMyCharacters not implemented")}),A=F(t,"onCreateCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),P=F(t,"onImportCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),p=F(t,"onExportCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),m=F(t,"onDeleteCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),u=L(()=>re.url.searchParams.get("characterId")),S=L(()=>re.url.searchParams.get("tab")??s);const i=R=>{R!==null?(re.url.searchParams.set("characterId",R.id),re.url.searchParams.set("tab",s)):(re.url.searchParams.delete("characterId"),re.url.searchParams.delete("tab")),Me(`?${re.url.searchParams.toString()}`)},w=R=>{re.url.searchParams.set("tab",R),Me(`?${re.url.searchParams.toString()}`)};let c=L(()=>e().find(R=>R.id===a(u)));const _=R=>{t.characters.update(z=>{const J=z.findIndex(K=>K.id===R.id);if(J!==-1){const K=[...z];return K[J]=R,K}return z})};var k=er(),x=g(k),v=g(x),b=g(v);{var h=R=>{var z=Ka();z.__click=[Ba,c,C],T(()=>z.disabled=t.allActionsDisabled||!a(c)),f(R,z)},E=R=>{var z=Ya(),J=ae(z);J.__click=[Wa,A,i];var K=o(J,2);K.__click=[Ga,P,i];var oe=o(K,2);oe.__click=[Ja,c,p];var de=o(oe,2);de.__click=[Va,c,m,i],T(()=>{J.disabled=t.allActionsDisabled,K.disabled=t.allActionsDisabled,oe.disabled=t.allActionsDisabled||!a(c),de.disabled=t.allActionsDisabled||!a(c)}),f(R,z)};O(b,R=>{t.readonly?R(h):R(E,!1)})}d(v);var M=o(v,2);le(M,5,e,R=>R.id,(R,z)=>{var J=$a();let K;J.__click=[Qa,i,z];var oe=g(J);{var de=N=>{var D=Xa();T(()=>{ne(D,"src",a(z).img),ne(D,"alt",a(z).name)}),f(N,D)},be=N=>{var D=Za(),Y=g(D,!0);d(D),T(G=>W(Y,G),[()=>a(z).name.charAt(0).toUpperCase()]),f(N,D)};O(oe,N=>{a(z).img?N(de):N(be,!1)})}var me=o(oe,2),ke=g(me,!0);d(me),d(J),T(N=>{K=te(J,1,"character-item svelte-dk16f3",null,K,N),ne(me,"title",a(z).name),W(ke,a(z).name)},[()=>({selected:a(u)===a(z).id})]),f(R,J)}),d(M),d(x);var B=o(x,2),X=g(B);{var ie=R=>{Ha(R,{get character(){return a(c)},get readonly(){return t.readonly},onChange:_,get currentTab(){return a(S)},onTabChange:w})};O(X,R=>{a(c)&&R(ie)})}d(B),d(k),f(n,k),j(),l()}Q(["click"]);export{fr as C,hr as u};
