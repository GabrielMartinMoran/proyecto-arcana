import"./DsnmJJEf.js";import{e as Se,u as De,j as Ae,r as Pe,C as Ue,f as k,t as B,b as h,s as p,d as c,af as Oe,g as o,aD as de,bc as we,ao as qe,h as t,O as L,aK as be,p as oe,a8 as Y,c as ce,a as K,aH as re}from"./Hn1PX6zW.js";import{c as Ee,s as O,d as me,e as Fe}from"./BogrDlyN.js";import{e as he,r as ke,s as $,a as Ne,b as Be,C as fe}from"./erSfHhUs.js";import{t as Te,b as Le,s as ve,c as je}from"./9cBGwEYA.js";import{r as Me}from"./DrD8MEZc.js";import{p as N}from"./B2VwTLsk.js";import{r as _e,c as We,g as Ge,l as Ie}from"./CjlGQt4x.js";import{i as q}from"./DFpaMj22.js";import{p as D}from"./Dvdpb29w.js";import{h as Ke}from"./BhtKBOPy.js";import{d as Qe}from"./Bx3Ta1aT.js";import{r as He}from"./DARyrVtp.js";import{w as Ye,g as Je}from"./Cop9rsZ2.js";function Xe(s,e,a){Se(()=>{var i=De(()=>e(s,a?.())||{});if(i?.destroy)return()=>i.destroy()})}function pe(s,e={},a,i){for(var l in a){var r=a[l];e[l]!==r&&(a[l]==null?s.style.removeProperty(l):s.style.setProperty(l,r,i))}}function Ce(s,e,a,i){var l=s.__style;if(Ae||l!==e){var r=Te(e,i);(!Ae||r!==s.getAttribute("style"))&&(r==null?s.removeAttribute("style"):s.style.cssText=r),s.__style=e}else i&&(Array.isArray(i)?(pe(s,a?.[0],i[0]),pe(s,a?.[1],i[1],"important")):pe(s,a,i));return i}function Ze(s,e,a,i,l){var r=()=>{i(a[s])};a.addEventListener(e,r),l?Pe(()=>{a[s]=l()}):r(),(a===document.body||a===window||a===document)&&Ue(()=>{a.removeEventListener(e,r)})}var Ve=k('<h2 class="svelte-6qb8f6"> </h2>'),$e=k('<div class="container svelte-6qb8f6"><!> <!></div>');function et(s,e){let a=D(e,"title",3,void 0),i=D(e,"width",3,void 0);var l=$e();let r;var f=c(l);{var d=E=>{var _=Ve(),u=c(_,!0);o(_),B(()=>O(u,a())),h(E,_)};q(f,E=>{a()&&E(d)})}var T=p(f,2);Ee(T,()=>e.children??Oe),o(l),B(E=>r=Ce(l,"",r,E),[()=>({width:i()})]),h(s,l)}const tt=s=>{window.addEventListener("click",e);function e(a){s.contains(a.target)||s.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var at=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],rt=["difference","intersection","symmetricDifference","union"],ze=!1;class se extends Set{#a=new Map;#e=de(0);#t=de(0);#r=we||-1;constructor(e){if(super(),e){for(var a of e)super.add(a);this.#t.v=super.size}ze||this.#n()}#s(e){return we===this.#r?de(e):qe(e)}#n(){ze=!0;var e=se.prototype,a=Set.prototype;for(const i of at)e[i]=function(...l){return t(this.#e),a[i].apply(this,l)};for(const i of rt)e[i]=function(...l){t(this.#e);var r=a[i].apply(this,l);return new se(r)}}has(e){var a=super.has(e),i=this.#a,l=i.get(e);if(l===void 0){if(!a)return t(this.#e),!1;l=this.#s(!0),i.set(e,l)}return t(l),a}add(e){return super.has(e)||(super.add(e),L(this.#t,super.size),be(this.#e)),this}delete(e){var a=super.delete(e),i=this.#a,l=i.get(e);return l!==void 0&&(i.delete(e),L(l,!1)),a&&(L(this.#t,super.size),be(this.#e)),a}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var a of e.values())L(a,!1);e.clear(),L(this.#t,0),be(this.#e)}}keys(){return this.values()}values(){return t(this.#e),super.values()}entries(){return t(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return t(this.#t)}}const st=(s,e,a)=>{L(e,new se),a.onChange(Array.from(t(e)))};var nt=(s,e,a)=>e(s.target.checked,t(a).value),it=k('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),lt=k('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function xe(s,e){oe(e,!0);let a=Y(()=>new se(e.value));const i=(y,m)=>{y?t(a).add(m):t(a).delete(m),L(a,new se(t(a))),e.onChange(Array.from(t(a)))};let l=de(!1);const r=()=>{L(l,!1)};var f=lt(),d=c(f),T=c(d);o(d);var E=p(d,2),_=c(E),u=c(_);he(u,21,()=>e.options,y=>y.value,(y,m)=>{var P=it(),U=c(P),v=c(U),n=p(v);ke(n),n.__input=[nt,i,m],o(U),o(P),B(g=>{$(U,"for",t(m).value),O(v,`${t(m).label??""} `),$(n,"id",t(m).value),$(n,"name",t(m).value),Ne(n,t(m).value),Be(n,g)},[()=>t(a).has(t(m).value)]),h(y,P)}),o(u);var A=p(u,2);A.__click=[st,a,e],o(_),o(E),o(f),Xe(f,y=>tt?.(y)),Se(()=>Ze("open","toggle",f,y=>L(l,y),()=>t(l))),B(()=>{O(T,`${e.summary??""} (${t(a).size??""})`),A.disabled=t(a).size===0}),Fe("outsideclick",f,r),h(s,f),ce()}me(["input","click"]);const vt=(s,e,a,i)=>{L(e,a()),i()};var ot=(s,e)=>e(),ct=(s,e,a)=>{t(e).type=s.target.value,a()},ut=k("<option> </option>"),dt=k('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function $t(s,e){oe(e,!0);const a=()=>({name:"",level:[],tags:[],type:""}),i=()=>{const _=N.url.searchParams.get("name")??"",u=N.url.searchParams.getAll("level").filter(m=>m!=="").map(Number).filter(m=>m>0),A=N.url.searchParams.getAll("tags").filter(m=>m!==""),y=N.url.searchParams.get("type")??"";return{name:_,level:u,tags:A,type:y}},l=()=>{t(r).name?N.url.searchParams.set("name",t(r).name):N.url.searchParams.delete("name"),t(r).level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",t(r).level.join(",")),t(r).tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",t(r).tags.join(",")),t(r).type?N.url.searchParams.set("type",t(r).type):N.url.searchParams.delete("type");const _=N.url.searchParams.toString(),u=`${N.url.pathname}${_?`?${_}`:""}`;Me(u,{})};let r=Y(i);const f=()=>{const _=e.cards.filter(u=>_e(u.name.toLowerCase()).includes(_e(t(r).name.toLowerCase()))&&(t(r).level.length===0||t(r).level.includes(u.level))&&(t(r).tags.length===0||t(r).tags.every(A=>u.tags.includes(A)))&&(!t(r).type||t(r).type===u.type));e.onFilter(_),l()},d=()=>{const _=new Set(e.cards.map(u=>u.level));return Array.from(_).sort((u,A)=>u-A)},T=()=>{const _=new Set(e.cards.flatMap(u=>u.tags));return Array.from(_).sort()},E=()=>{const _=new Set(e.cards.map(u=>u.type));return Array.from(_).sort()};et(s,{children:(_,u)=>{var A=dt(),y=c(A);ke(y),y.__input=[ot,f];var m=p(y,2);m.__change=[ct,r,f];var P=c(m);P.value=P.__value="";var U=p(P);he(U,16,E,F=>F,(F,w)=>{var W=ut(),z=c(W,!0);o(W);var b={};B(x=>{O(z,x),b!==(b=w)&&(W.value=(W.__value=w)??"")},[()=>We(w)]),h(F,W)}),o(m);var v=p(m,2);{let F=Y(()=>d().map(w=>({value:w,label:`Nivel ${w}`})));xe(v,{summary:"Niveles",get options(){return t(F)},get value(){return t(r).level},onChange:w=>{t(r).level=w,f()}})}var n=p(v,2);{let F=Y(()=>T().map(w=>({value:w,label:w})));xe(n,{summary:"Etiquetas",get options(){return t(F)},get value(){return t(r).tags},onChange:w=>{t(r).tags=w,f()}})}var g=p(n,2);g.__click=[vt,r,a,f],o(A),Le(y,()=>t(r).name,F=>t(r).name=F),h(_,A)},$$slots:{default:!0}}),ce()}me(["input","change","click"]);var ft=k("<label> </label>"),_t=(s,e,a,i)=>{e.max!==void 0&&typeof t(a)=="number"&&L(a,Math.min(t(a),e.max)),i()(t(a))},mt=k('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),ht=k('<button class="button svelte-1r47u3b"> </button>'),gt=k("<div><!> <span><input/> <!> <!></span></div>");function bt(s,e){oe(e,!0);let a=D(e,"label",3,void 0),i=D(e,"labelWidth",3,"normalized"),l=D(e,"readonly",3,!1),r=D(e,"onChange",3,()=>{}),f=D(e,"button",3,void 0),d=D(e,"fullWidth",3,!1),T=D(e,"placeholder",3,""),E=D(e,"textAlign",3,"center"),_=Y(()=>e.value);var u=gt();let A;var y=c(u);{var m=z=>{var b=ft(),x=c(b,!0);o(b),B(()=>{ve(b,1,je(i()),"svelte-1r47u3b"),O(x,a())}),h(z,b)};q(y,z=>{a()&&z(m)})}var P=p(y,2);let U;var v=c(P);ke(v);let n;$(v,"min",0),v.__input=[_t,e,_,r];var g=p(v,2);{var F=z=>{var b=mt(),x=p(K(b),2);let G;var ae=c(x,!0);o(x),B(ne=>{G=ve(x,1,"max svelte-1r47u3b",null,G,ne),O(ae,e.max)},[()=>({withButton:f()!==void 0})]),h(z,b)};q(g,z=>{e.max!==void 0&&z(F)})}var w=p(g,2);{var W=z=>{var b=ht();b.__click=function(...G){f().onClick?.apply(this,G)};var x=c(b,!0);o(b),B(()=>{$(b,"title",f().title),b.disabled=f().disabled,O(x,f().icon)}),h(z,b)};q(w,z=>{f()&&z(W)})}o(P),o(u),B((z,b,x)=>{A=ve(u,1,"fieldgroup svelte-1r47u3b",null,A,z),U=ve(P,1,"field svelte-1r47u3b",null,U,b),$(v,"type",typeof e.value=="number"?"number":"text"),v.disabled=l(),n=ve(v,1,`text-align-${E()}`,"svelte-1r47u3b",n,x),$(v,"max",e.max),$(v,"placeholder",T())},[()=>({fullWidth:d()}),()=>({inputAlone:e.max===void 0&&f()===void 0&&!d(),inputWithButton:f()!==void 0,fullWidth:d(),readonly:l()}),()=>({alone:e.max===void 0&&f()===void 0,fullWidth:d(),withButton:f()!==void 0,withButtonAndMax:e.max!==void 0&&f()!==void 0})]),Le(v,()=>t(_),z=>L(_,z)),h(s,u),ce()}me(["input","click"]);var pt=k('<span class="chip svelte-6vztta"> </span>'),yt=k('<span class="chip svelte-6vztta"> </span>'),Ct=k('<span class="chip svelte-6vztta"> </span>'),kt=k('<span class="chip svelte-6vztta"> </span>'),At=k('<div class="controls svelte-6vztta"><!></div>'),wt=k('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function zt(s,e){oe(e,!0);let a=D(e,"children",3,void 0);const i=C=>{switch(_e(C.length>0?String(C[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}},l=C=>{let S=_e(C.length>0?String(C[0]).toLowerCase():"");return fe.CARD_BACKGROUNDS[S]?fe.CARD_BACKGROUNDS[S]:fe.CARD_BACKGROUNDS.default};var r=wt();let f;var d=c(r);let T;var E=p(d,2),_=c(E),u=c(_),A=c(u),y=c(A);o(A);var m=p(A,2),P=c(m,!0);o(m),o(u);var U=p(u,2),v=c(U,!0);o(U),o(_);var n=p(_,2),g=c(n),F=c(g);Ke(F,()=>Qe.parse(e.card.description)),o(g);var w=p(g,2),W=c(w);he(W,16,()=>e.card.tags,C=>C,(C,S)=>{var j=pt(),R=c(j,!0);o(j),B(()=>O(R,S)),h(C,j)});var z=p(W,2);{var b=C=>{var S=re(),j=K(S);{var R=M=>{var I=yt(),te=c(I);o(I),B(()=>O(te,`Usos: ${e.card.uses.qty??"?"??""} por día de descanso`)),h(M,I)},Q=M=>{var I=re(),te=K(I);{var ie=X=>{var Z=Ct(),le=c(Z);o(Z),B(()=>O(le,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),h(X,Z)},ue=X=>{var Z=re(),le=K(Z);{var V=H=>{var ge=kt(),Re=c(ge);o(ge),B(()=>O(Re,`Usos: ${e.card.uses.qty??"?"??""}`)),h(H,ge)};q(le,H=>{e.card.uses.type==="USES"&&H(V)},!0)}h(X,Z)};q(te,X=>{e.card.uses.type==="RELOAD"?X(ie):X(ue,!1)},!0)}h(M,I)};q(j,M=>{e.card.uses.type==="LONG_REST"?M(R):M(Q,!1)})}h(C,S)};q(z,C=>{e.card.uses.type&&C(b)})}o(w),o(n);var x=p(n,2),G=p(c(x),2),ae=c(G),ne=c(ae,!0);o(ae),o(G);var J=p(G,2);{var ee=C=>{var S=At(),j=c(S);Ee(j,a),o(S),h(C,S)};q(J,C=>{a()!==void 0&&C(ee)})}o(x),o(E),o(r),B((C,S,j,R)=>{f=Ce(r,"",f,C),T=Ce(d,"",T,S),O(y,`Nivel ${e.card.level??""}`),O(P,j),O(v,e.card.name),O(ne,R)},[()=>({"border-color":i(e.card.tags)}),()=>({"background-image":`url(${l(e.card.tags)})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"—"]),h(s,r),ce()}var xt=(s,e,a)=>e(t(a).id),St=k('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Et=(s,e,a)=>e(t(a).id),Lt=(s,e,a)=>e(t(a).id),Rt=k("<button>Desactivar</button>"),Dt=(s,e,a)=>e(t(a).id),Pt=k("<button>Activar</button>"),Ut=k('<button>Quitar</button> <span class="spacer"></span> <!>',1),Ot=(s,e,a)=>e(t(a)),qt=k('<span class="spacer"></span> <button>Agregar</button>',1),Ft=k('<div class="controls svelte-1rfcjb3"><!></div>'),Nt=k('<div class="cards svelte-1rfcjb3"></div>');function ea(s,e){oe(e,!0);let a=D(e,"readonly",3,!0),i=D(e,"characterCards",19,()=>[]),l=D(e,"listMode",3,"all"),r=D(e,"onChange",3,()=>{}),f=D(e,"onCardReloadClick",3,()=>{}),d=Y(i);const T=v=>{const n=e.cards.find(g=>g.id===v);if(!n){_(v);return}L(d,t(d).map(g=>g.id===v?{...g,isActive:!1,uses:m(n)}:g)),r()(t(d))},E=v=>{L(d,t(d).map(n=>n.id===v?{...n,isActive:!0}:n)),r()(t(d))},_=v=>{L(d,t(d).filter(n=>n.id!==v)),r()(t(d))},u=v=>{L(d,[...t(d),{id:v.id,uses:m(v),isActive:!1,level:v.level}]),r()(t(d))},A=(v,n)=>{L(d,t(d).map(g=>g.id===v?{...g,uses:n}:g)),r()(t(d))},y=v=>{const n=t(d).find(g=>g.id===v);return n?n.uses:0},m=v=>{if(v.uses.type===null)return null;switch(v.uses.type){case"USES":case"LONG_REST":return v.uses.qty??0;case"RELOAD":return fe.RELOAD_CARD_USES;default:return null}},P=v=>{const n=t(d).find(g=>g.id===v.id);return n?n.isActive:!1};var U=Nt();he(U,21,()=>e.cards,v=>v.id,(v,n)=>{zt(v,{get card(){return t(n)},children:(g,F)=>{var w=re(),W=K(w);{var z=b=>{var x=Ft(),G=c(x);{var ae=J=>{var ee=St(),C=K(ee);{var S=R=>{{let Q=Y(()=>y(t(n).id)),M=Y(()=>m(t(n))),I=Y(()=>({icon:"🎲",title:"Tirar para recargar",onClick:()=>f()(t(n).id),disabled:y(t(n).id)===m(t(n))}));bt(R,{get value(){return t(Q)},get max(){return t(M)},onChange:te=>A(t(n).id,Number(te)),get button(){return t(I)}})}};q(C,R=>{m(t(n))!==null&&R(S)})}var j=p(C,4);j.__click=[xt,T,n],h(J,ee)},ne=J=>{var ee=re(),C=K(ee);{var S=R=>{var Q=Ut(),M=K(Q);M.__click=[Et,_,n];var I=p(M,4);{var te=ie=>{var ue=re(),X=K(ue);{var Z=V=>{var H=Rt();H.__click=[Lt,T,n],h(V,H)},le=V=>{var H=Pt();H.__click=[Dt,E,n],h(V,H)};q(X,V=>{P(t(n))?V(Z):V(le,!1)})}h(ie,ue)};q(I,ie=>{t(n).type==="activable"&&ie(te)})}h(R,Q)},j=R=>{var Q=qt(),M=p(K(Q),2);M.__click=[Ot,u,n],h(R,Q)};q(C,R=>{l()==="collection"?R(S):R(j,!1)},!0)}h(J,ee)};q(G,J=>{l()==="active"?J(ae):J(ne,!1)})}o(x),h(b,x)};q(W,b=>{a()||b(z)})}h(g,w)},$$slots:{default:!0}})}),o(U),h(s,U),ce()}me(["click"]);const Bt=s=>{if(!s.name)throw new Error("Card name is required");return{id:Ge(s.name),...s}},ye=Ye([]),ta=()=>({loadCards:async()=>{if(Je(ye).length>0)return;const a=await(await fetch(He("/docs/cards.yml"))).text();let i=[];try{i=Ie(a).cards??[]}catch(l){console.error("Error parsing YAML:",l)}ye.set(i.map(l=>Bt(l)))},cards:ye});export{$t as C,bt as I,ea as a,et as b,ta as u};
