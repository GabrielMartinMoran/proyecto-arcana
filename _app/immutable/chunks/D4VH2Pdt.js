import"./DsnmJJEf.js";import{h as Se,u as Ue,i as Me,F as Ne,aa as de,bc as Ae,at as De,j as a,K as T,aL as ye,p as ve,b as A,e as _,r as d,g as h,ab as H,t as D,a as m,d as ce,aT as qe,f as Q,c as te,s as je}from"./t0Cq7XZL.js";import{d as _e,s as F,e as Ie}from"./D_zjkKVN.js";import{i as R}from"./CuTJ2zLb.js";import{e as fe,r as ue,s as Z,b as We,d as Fe,f as Ge}from"./BDY9aIh_.js";import{b as Re,s as oe}from"./BmU-s7xp.js";import{p as M}from"./Pn6U6YSw.js";import{c as Be,r as Ce,l as Qe}from"./CGjaQNWU.js";import{C as Xe,s as ke}from"./0WDDsGuN.js";import{C as V}from"./BLLLuF8N.js";import{h as Ye}from"./BnRKkySf.js";import{d as He}from"./Bx3Ta1aT.js";import{r as Ke}from"./1vJPu7dK.js";import{p as N}from"./BKB8WqQd.js";import{r as Je}from"./Bm4140z-.js";import{m as Ze,a as Ve}from"./DF-fq5rF.js";import{w as Te,g as $e}from"./y52P6WVk.js";function et(n,e,t){Se(()=>{var s=Ue(()=>e(n,t?.())||{});if(s?.destroy)return()=>s.destroy()})}function tt(n,e,t,s,o){var v=()=>{s(t[n])};t.addEventListener(e,v),o?Me(()=>{t[n]=o()}):v(),(t===document.body||t===window||t===document)&&Ne(()=>{t.removeEventListener(e,v)})}const at=n=>{window.addEventListener("click",e);function e(t){n.contains(t.target)||n.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var st=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],rt=["difference","intersection","symmetricDifference","union"],we=!1;class ae extends Set{#a=new Map;#e=de(0);#t=de(0);#s=Ae||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}we||this.#n()}#r(e){return Ae===this.#s?de(e):De(e)}#n(){we=!0;var e=ae.prototype,t=Set.prototype;for(const s of st)e[s]=function(...o){return a(this.#e),t[s].apply(this,o)};for(const s of rt)e[s]=function(...o){a(this.#e);var v=t[s].apply(this,o);return new ae(v)}}has(e){var t=super.has(e),s=this.#a,o=s.get(e);if(o===void 0){if(!t)return a(this.#e),!1;o=this.#r(!0),s.set(e,o)}return a(o),t}add(e){return super.has(e)||(super.add(e),T(this.#t,super.size),ye(this.#e)),this}delete(e){var t=super.delete(e),s=this.#a,o=s.get(e);return o!==void 0&&(s.delete(e),T(o,!1)),t&&(T(this.#t,super.size),ye(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())T(t,!1);e.clear(),T(this.#t,0),ye(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const nt=(n,e,t)=>{T(e,new ae),t.onChange(Array.from(a(e)))};var lt=(n,e,t)=>e(n.target.checked,a(t).value),it=A('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),ot=A('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function xe(n,e){ve(e,!0);let t=H(()=>new ae(e.value));const s=(w,p)=>{w?a(t).add(p):a(t).delete(p),T(t,new ae(a(t))),e.onChange(Array.from(a(t)))};let o=de(!1);const v=()=>{T(o,!1)};var c=ot(),r=_(c),k=_(r);d(r);var S=h(r,2),L=_(S),x=_(L);fe(x,21,()=>e.options,w=>w.value,(w,p)=>{var O=it(),P=_(O),i=_(P),l=h(i);ue(l),l.__input=[lt,s,p],d(P),d(O),D(u=>{Z(P,"for",a(p).value),F(i,`${a(p).label??""} `),Z(l,"id",a(p).value),Z(l,"name",a(p).value),We(l,a(p).value),Fe(l,u)},[()=>a(t).has(a(p).value)]),m(w,O)}),d(x);var q=h(x,2);q.__click=[nt,t,e],d(L),d(S),d(c),et(c,w=>at?.(w)),Se(()=>tt("open","toggle",c,w=>T(o,w),()=>a(o))),D(()=>{F(k,`${e.summary??""} (${a(t).size??""})`),q.disabled=a(t).size===0}),Ie("outsideclick",c,v),m(n,c),ce()}_e(["input","click"]);var vt=(n,e,t)=>e.onFiltersChange({...a(t)}),ct=(n,e,t)=>{a(e).type=n.target.value,t.onFiltersChange({...a(e)})},dt=A("<option> </option>"),ut=(n,e,t)=>{a(e).onlyAvailables=n.target.checked,t.onFiltersChange({...a(e)})},_t=A('<div class="only-availables-field svelte-1o8sb8t"><label for="only-availables" class="svelte-1o8sb8t"><input type="checkbox" id="only-availables" class="svelte-1o8sb8t"/>Ver Solo disponibles</label></div>'),ft=(n,e)=>e.onResetFilters(),mt=A('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <!> <button>Limpiar Filtros</button></div>');function ia(n,e){ve(e,!0);let t=M(e,"includeOnlyAvailablesFilter",3,!1),s=H(()=>e.filters);const o=()=>{const r=new Set(e.cards.map(k=>k.level));return Array.from(r).sort((k,S)=>k-S)},v=()=>{const r=new Set(e.cards.flatMap(k=>k.tags));return Array.from(r).sort()},c=()=>{const r=new Set(e.cards.map(k=>k.type));return Array.from(r).sort()};Xe(n,{children:(r,k)=>{var S=mt(),L=_(S);ue(L),L.__input=[vt,e,s];var x=h(L,2);x.__change=[ct,s,e];var q=_(x);q.value=q.__value="";var w=h(q);fe(w,16,c,u=>u,(u,g)=>{var z=dt(),I=_(z,!0);d(z);var y={};D(b=>{F(I,b),y!==(y=g)&&(z.value=(z.__value=g)??"")},[()=>Be(g)]),m(u,z)}),d(x);var p=h(x,2);{let u=H(()=>o().map(g=>({value:g,label:`Nivel ${g}`})));xe(p,{summary:"Niveles",get options(){return a(u)},get value(){return a(s).level},onChange:g=>{a(s).level=g,e.onFiltersChange({...a(s)})}})}var O=h(p,2);{let u=H(()=>v().map(g=>({value:g.toLowerCase(),label:g})));xe(O,{summary:"Etiquetas",get options(){return a(u)},get value(){return a(s).tags},onChange:g=>{a(s).tags=g.map(z=>z.toLowerCase()),e.onFiltersChange({...a(s)})}})}var P=h(O,2);{var i=u=>{var g=_t(),z=_(g),I=_(z);ue(I),I.__input=[ut,s,e],qe(),d(z),d(g),D(()=>Fe(I,a(s).onlyAvailables)),m(u,g)};R(P,u=>{t()&&u(i)})}var l=h(P,2);l.__click=[ft,e],d(S),Re(L,()=>a(s).name,u=>a(s).name=u),m(r,S)},$$slots:{default:!0}}),ce()}_e(["input","change","click"]);var ht=A("<label> </label>"),bt=(n,e,t,s)=>{e.max!==void 0&&typeof a(t)=="number"&&T(t,Math.min(a(t),e.max)),s()(a(t))},gt=A('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),pt=A('<button class="button svelte-1r47u3b"> </button>'),yt=A("<div><!> <span><input/> <!> <!></span></div>");function Ct(n,e){ve(e,!0);let t=M(e,"label",3,void 0),s=M(e,"labelWidth",3,"normalized"),o=M(e,"readonly",3,!1),v=M(e,"onChange",3,()=>{}),c=M(e,"button",3,void 0),r=M(e,"fullWidth",3,!1),k=M(e,"placeholder",3,""),S=M(e,"textAlign",3,"center"),L=H(()=>e.value);var x=yt();let q;var w=_(x);{var p=y=>{var b=ht(),U=_(b,!0);d(b),D(()=>{oe(b,1,Ge(s()),"svelte-1r47u3b"),F(U,t())}),m(y,b)};R(w,y=>{t()&&y(p)})}var O=h(w,2);let P;var i=_(O);ue(i);let l;Z(i,"min",0),i.__input=[bt,e,L,v];var u=h(i,2);{var g=y=>{var b=gt(),U=h(Q(b),2);let K;var se=_(U,!0);d(U),D($=>{K=oe(U,1,"max svelte-1r47u3b",null,K,$),F(se,e.max)},[()=>({withButton:c()!==void 0})]),m(y,b)};R(u,y=>{e.max!==void 0&&y(g)})}var z=h(u,2);{var I=y=>{var b=pt();b.__click=function(...K){c().onClick?.apply(this,K)};var U=_(b,!0);d(b),D(()=>{Z(b,"title",c().title),b.disabled=c().disabled,F(U,c().icon)}),m(y,b)};R(z,y=>{c()&&y(I)})}d(O),d(x),D((y,b,U)=>{q=oe(x,1,"fieldgroup svelte-1r47u3b",null,q,y),P=oe(O,1,"field svelte-1r47u3b",null,P,b),Z(i,"type",typeof e.value=="number"?"number":"text"),i.disabled=o(),l=oe(i,1,`text-align-${S()}`,"svelte-1r47u3b",l,U),Z(i,"max",e.max),Z(i,"placeholder",k())},[()=>({fullWidth:r()}),()=>({inputAlone:e.max===void 0&&c()===void 0&&!r(),inputWithButton:c()!==void 0,fullWidth:r(),readonly:o()}),()=>({alone:e.max===void 0&&c()===void 0,fullWidth:r(),withButton:c()!==void 0,withButtonAndMax:e.max!==void 0&&c()!==void 0})]),Re(i,()=>a(L),y=>T(L,y)),m(n,x),ce()}_e(["input","click"]);var At=A('<span class="chip svelte-6vztta"> </span>'),kt=A('<span class="chip svelte-6vztta"> </span>'),wt=A('<span class="chip svelte-6vztta"> </span>'),xt=A('<span class="chip svelte-6vztta"> </span>'),Lt=A('<span class="chip svelte-6vztta"> </span>'),Et=A('<div class="controls svelte-6vztta"><!></div>'),zt=A('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function St(n,e){ve(e,!0);let t=M(e,"children",3,void 0);const s=f=>{switch(Ce(f.length>0?String(f[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var o=zt();let v;var c=_(o);let r;var k=h(c,2),S=_(k),L=_(S),x=_(L),q=_(x,!0);d(x);var w=h(x,2),p=_(w);d(w);var O=h(w,4),P=_(O,!0);d(O),d(L);var i=h(L,2),l=_(i,!0);d(i),d(S);var u=h(S,2),g=_(u),z=_(g);Ye(z,()=>He.parse(e.card.description)),d(g);var I=h(g,2),y=_(I);fe(y,16,()=>e.card.tags,f=>f,(f,C)=>{var E=At(),X=_(E,!0);d(E),D(()=>F(X,C)),m(f,E)});var b=h(y,2);{var U=f=>{var C=te(),E=Q(C);{var X=B=>{var Y=kt(),ie=_(Y);d(Y),D(()=>F(ie,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),m(B,Y)},le=B=>{var Y=te(),ie=Q(Y);{var me=j=>{var W=wt(),be=_(W);d(W),D(()=>F(be,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(j,W)},he=j=>{var W=te(),be=Q(W);{var Oe=ge=>{var pe=xt(),Pe=_(pe);d(pe),D(()=>F(Pe,`Usos: ${e.card.uses.qty??"?"??""}`)),m(ge,pe)};R(be,ge=>{e.card.uses.type==="USES"&&ge(Oe)},!0)}m(j,W)};R(ie,j=>{e.card.uses.type==="RELOAD"?j(me):j(he,!1)},!0)}m(B,Y)};R(E,B=>{e.card.uses.type==="LONG_REST"?B(X):B(le,!1)})}m(f,C)};R(b,f=>{e.card.uses.type&&f(U)})}var K=h(b,2);{var se=f=>{var C=Lt(),E=_(C);d(C),D(()=>F(E,`Costo: ${e.card.cost??""} de oro`)),m(f,C)};R(K,f=>{e.card.cardType==="item"&&f(se)})}d(I),d(u);var $=h(u,2),G=h(_($),2),J=_(G),ee=_(J,!0);d(J),d(G);var re=h(G,2);{var ne=f=>{var C=Et(),E=_(C);je(E,t),d(C),m(f,C)};R(re,f=>{t()!==void 0&&f(ne)})}d($),d(k),d(o),D((f,C,E,X)=>{v=ke(o,"",v,f),r=ke(c,"",r,C),F(q,e.card.cardType==="ability"?"Habilidad":"Objeto MÃ¡gico"),F(p,`Nivel ${e.card.level??""}`),F(P,E),F(l,e.card.name),F(ee,X)},[()=>({"border-color":s(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),m(n,o),ce()}var Ft=(n,e,t)=>e(a(t).id),Rt=A('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Tt=(n,e,t)=>e(a(t).id),Ot=(n,e,t)=>e(a(t).id),Pt=A("<button>Desactivar</button>"),Ut=(n,e,t)=>e(a(t).id),Mt=A("<button>Activar</button>"),Nt=A('<button>Quitar</button> <span class="spacer"></span> <!>',1),Dt=(n,e,t)=>e(a(t)),qt=A('<span class="spacer"></span> <button>Agregar</button>',1),jt=A('<div class="controls svelte-1rfcjb3"><!></div>'),It=A('<div class="cards svelte-1rfcjb3"></div>');function oa(n,e){ve(e,!0);let t=M(e,"readonly",3,!0),s=M(e,"characterCards",19,()=>[]),o=M(e,"listMode",3,"all"),v=M(e,"onChange",3,()=>{}),c=M(e,"onCardReloadClick",3,()=>{}),r=H(s);const k=i=>{const l=e.cards.find(u=>u.id===i);if(!l){L(i);return}T(r,a(r).map(u=>u.id===i?{...u,isActive:!1,uses:p(l)}:u)),v()(a(r))},S=i=>{T(r,a(r).map(l=>l.id===i?{...l,isActive:!0}:l)),v()(a(r))},L=i=>{T(r,a(r).filter(l=>l.id!==i)),v()(a(r))},x=i=>{T(r,[...a(r),{id:i.id,uses:p(i),isActive:!1,level:i.level,cardType:i.type}]),v()(a(r))},q=(i,l)=>{T(r,a(r).map(u=>u.id===i?{...u,uses:l}:u)),v()(a(r))},w=i=>{const l=a(r).find(u=>u.id===i);return l?l.uses:0},p=i=>{if(i.uses.type===null)return null;switch(i.uses.type){case"USES":case"LONG_REST":case"DAY":return i.uses.qty??0;case"RELOAD":return V.RELOAD_CARD_USES;default:return null}},O=i=>{const l=a(r).find(u=>u.id===i.id);return l?l.isActive:!1};var P=It();fe(P,21,()=>e.cards,i=>i.id,(i,l)=>{St(i,{get card(){return a(l)},children:(u,g)=>{var z=te(),I=Q(z);{var y=b=>{var U=jt(),K=_(U);{var se=G=>{var J=Rt(),ee=Q(J);{var re=f=>{{let C=H(()=>w(a(l).id)),E=H(()=>p(a(l))),X=H(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>c()(a(l).id),disabled:w(a(l).id)===p(a(l))}));Ct(f,{get value(){return a(C)},get max(){return a(E)},onChange:le=>q(a(l).id,Number(le)),get button(){return a(X)}})}};R(ee,f=>{p(a(l))!==null&&f(re)})}var ne=h(ee,4);ne.__click=[Ft,k,l],m(G,J)},$=G=>{var J=te(),ee=Q(J);{var re=f=>{var C=Nt(),E=Q(C);E.__click=[Tt,L,l];var X=h(E,4);{var le=B=>{var Y=te(),ie=Q(Y);{var me=j=>{var W=Pt();W.__click=[Ot,k,l],m(j,W)},he=j=>{var W=Mt();W.__click=[Ut,S,l],m(j,W)};R(ie,j=>{O(a(l))?j(me):j(he,!1)})}m(B,Y)};R(X,B=>{a(l).type==="activable"&&B(le)})}m(f,C)},ne=f=>{var C=qt(),E=h(Q(C),2);E.__click=[Dt,x,l],m(f,C)};R(ee,f=>{o()==="collection"?f(re):f(ne,!1)},!0)}m(G,J)};R(K,G=>{o()==="active"?G(se):G($,!1)})}d(U),m(b,U)};R(I,b=>{t()||b(y)})}m(u,z)},$$slots:{default:!0}})}),d(P),m(n,P),ce()}_e(["click"]);const va=()=>({buildEmptyFilters:({onlyAvailables:s}={onlyAvailables:void 0})=>({name:"",level:[],tags:[],type:"",onlyAvailables:s}),getFiltersFromURL:()=>{const s=N.url.searchParams.get("name")??"",o=N.url.searchParams.getAll("level").filter(r=>r!=="").map(Number).filter(r=>r>0),v=N.url.searchParams.getAll("tags").filter(r=>r!==""),c=N.url.searchParams.get("type")??"";return{name:s,level:o,tags:v,type:c}},updateURLFilters:s=>{s.name?N.url.searchParams.set("name",s.name):N.url.searchParams.delete("name"),s.level.length===0?N.url.searchParams.delete("level"):N.url.searchParams.set("level",s.level.join(",")),s.tags.length===0?N.url.searchParams.delete("tags"):N.url.searchParams.set("tags",s.tags.join(",")),s.type?N.url.searchParams.set("type",s.type):N.url.searchParams.delete("type");const o=N.url.searchParams.toString(),v=`${N.url.pathname}${o?`?${o}`:""}`;Ke(v,{})}}),Le=Te([]),Ee=Te([]),ze=async(n,e,t,s)=>{if($e(t).length>0)return;const v=await(await fetch(Je(n))).text();let c=[];try{c=Qe(v)[e]??[]}catch(r){console.error("Error parsing YAML:",r)}t.set(c.map(r=>s(r)).toSorted((r,k)=>r.level-k.level||r.tags.join("|").localeCompare(k.tags.join("|"))||r.name.localeCompare(k.name)))},ca=()=>({loadAbilityCards:async()=>{await ze("/docs/cards.yml","cards",Le,Ze)},abilityCards:Le,loadItemCards:async()=>{await ze("/docs/magical-items.yml","items",Ee,Ve)},itemCards:Ee}),da=(n,e,t=void 0)=>{let s=[],o=!1;return t&&e.onlyAvailables&&(s=Wt(n,t),o=!0),n.filter(v=>Ce(v.name.toLowerCase()).includes(Ce(e.name.toLowerCase()))&&(e.level.length===0||e.level.includes(v.level))&&(e.tags.length===0||e.tags.every(c=>v.tags.map(r=>r.toLowerCase()).includes(c)))&&(!e.type||e.type===v.type)&&(!o||Gt(v,s)))},Wt=(n,e)=>{const t=[];for(const v of Object.keys(V.ATTR_NAME_MAP))for(let c=1;c<=e.attributes[v];c++)t.push(`${V.ATTR_NAME_MAP[v]} ${c}`.toLowerCase());const s=n.filter(v=>e.cards.find(c=>c.id===v.id));for(const v of s)t.push(v.name.toLowerCase());const o=n.filter(v=>v.tags.includes(V.LINEAGE_CARD_TAG)&&e.cards.find(c=>c.id===v.id)).length;return e.cards.length<=V.MAX_CARDS_TO_INCLUDE_LINEAGES&&o<V.MAX_LINEAGE_CARDS&&t.push(V.LINEAGE_REQUIREMENT.toLowerCase()),t},Gt=(n,e)=>n.requirements.find(t=>t.toLowerCase().startsWith("o "))?n.requirements.some(t=>e.includes(t.toLowerCase().replace("o ",""))):n.requirements.every(t=>e.includes(t.toLowerCase()));export{ia as C,Ct as I,ca as a,oa as b,et as c,at as d,da as f,va as u};
