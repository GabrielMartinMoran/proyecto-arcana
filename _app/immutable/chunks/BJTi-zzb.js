import{r as Le}from"./4z3Osgt6.js";import{C as fe,u as Ue,a as Me}from"./CVSkhmb7.js";import{w as Ee,g as ue}from"./Cje6xDa-.js";import"./DsnmJJEf.js";import{p as U,b as y,ab as W,t as I,K as H,j as a,a as f,d as j,e as b,g as o,bf as je,r as c,f as ae,aa as ge,J as ve,aT as He,c as We}from"./4UBXq5Sj.js";import{d as Q,s as J,a as Ge,o as qe,e as Je}from"./DEyIqfax.js";import{i as L,s as Ve,a as Be}from"./DY7lAt98.js";import{r as Ke,s as ne,e as le}from"./Z0ud6hNo.js";import{b as De,s as te}from"./3q36uapf.js";import{p as F}from"./CsZilKOT.js";import{g as Ne}from"./bbaEbAp4.js";import{p as re}from"./D8ahThmC.js";import{c as Ye}from"./DagTf92m.js";import{c as O,u as Qe,a as ze,b as Ce,C as Xe,d as Ze,e as $e,f as et,I as q}from"./ChoLbHSO.js";import{c as tt}from"./CGjaQNWU.js";import{b as at}from"./BIoRDyB-.js";const xe="arcana:characters",B={charactersStore:Ee([]),exampleCharactersStore:Ee([]),charactersAlreadyLoaded:!1,exampleCharactersAlreadyLoaded:!1};let $=null,he=null,ce=null,me=null,Pe=!1;const Te="arcana:pendingCharacterDeletes",se=(()=>{try{const n=(()=>{try{return localStorage.getItem(Te)}catch{return null}})();return n?JSON.parse(n):[]}catch{return[]}})(),we=()=>{try{localStorage.setItem(Te,JSON.stringify(se))}catch(n){console.warn("[characters-service] Failed to persist pending deletes",n)}},rt=async n=>{if(n&&ee.isEnabled())for(const t of[...se])try{await ee.deleteCharacterForUser(n,t);const e=se.indexOf(t);e!==-1&&(se.splice(e,1),we()),console.info("[characters-service] Successfully processed pending delete for",t)}catch(e){console.warn("[characters-service] Failed to process pending delete for",t,e)}},ee=Ue(),nt=()=>{me||(me=B.charactersStore.subscribe(async n=>{if(Pe)return;const t=JSON.stringify(n);try{localStorage.setItem(xe,t)}catch(e){console.warn("Error saving characters to localStorage:",e)}try{$&&ee.isEnabled()&&await ee.saveCharactersForUser($,n)}catch(e){console.error("Error persisting characters to cloud:",e)}}))},lt=()=>{if(me){try{me()}catch{}me=null}},ot=n=>{if(ce){try{ce()}catch{}ce=null}ce=ee.listenCharactersForUser(n,t=>{Pe=!0;try{B.charactersStore.set(t.map(e=>new fe(e)))}finally{Pe=!1}})},ke=()=>{if(ce){try{ce()}catch{}ce=null}},mr=()=>{const n=async()=>{if(!B.charactersAlreadyLoaded){try{await ee.initFirebase()}catch(r){console.warn("Firebase init error (continuing with local persistence):",r)}try{he=await ee.onAuthState(async r=>{const l=$;if($=r?r.uid:null,l&&l!==$&&ke(),$&&ee.isEnabled())try{ot($),rt($).catch(s=>{console.warn("[characters-service] processPendingDeletes failed:",s)})}catch(s){console.error("Error starting remote listener:",s)}else{ke();const s=localStorage.getItem(xe);if(s)try{const C=JSON.parse(s);B.charactersStore.set(C.map(p=>new fe(p)))}catch(C){console.error("Error parsing characters JSON:",C)}else B.charactersStore.set([])}})}catch(r){console.warn("Auth listener setup error (continuing with local persistence):",r);const l=localStorage.getItem(xe);if(l)try{const s=JSON.parse(l);B.charactersStore.set(s.map(C=>new fe(C)))}catch(s){console.error("Error parsing characters JSON:",s)}}nt(),B.charactersAlreadyLoaded=!0}},t=async()=>{if(B.exampleCharactersAlreadyLoaded)return;let r=[];try{r=await(await fetch(Le("/docs/example-characters.json"))).json()}catch(l){console.error("Error fetching example characters:",l)}try{B.exampleCharactersStore.set(r.map(l=>new fe(l)))}catch(l){console.error("Error parsing example characters JSON:",l)}B.exampleCharactersAlreadyLoaded=!0},e=async r=>{B.charactersStore.update(l=>l.filter(s=>s.id!==r));try{se.includes(r)||(se.push(r),we())}catch(l){console.warn("[characters-service] Failed to queue pending delete:",l)}if($&&ee.isEnabled())try{await ee.deleteCharacterForUser($,r);const l=se.indexOf(r);l!==-1&&(se.splice(l,1),we())}catch(l){console.warn("[characters-service] Immediate cloud delete failed, queued for retry:",l);try{const s=await new Promise(C=>{B.charactersStore.subscribe(p=>C(p))()});await ee.saveCharactersForUser($,s)}catch(s){console.error("[characters-service] Error syncing characters after failed delete:",s)}}};return{loadCharacters:n,loadExampleCharacters:t,characters:B.charactersStore,exampleCharacters:B.exampleCharactersStore,deleteCharacter:e,cleanup:()=>{if(he){try{he()}catch{}he=null}ke(),lt()}}};var st=(n,t,e)=>t.onChange(a(e)),it=y('<input type="text" class="svelte-19nbfo1"/>');function Fe(n,t){U(t,!0);let e=F(t,"placeholder",3,void 0),r=W(()=>t.value);var l=it();Ke(l),l.__input=[st,t,r],I(()=>{ne(l,"placeholder",e()),l.disabled=t.readonly}),De(l,()=>a(r),s=>H(r,s)),f(n,l),j()}Q(["input"]);var dt=y("<label> </label>"),ct=(n,t,e)=>t.onChange(a(e)),vt=y("<div><!> <div><textarea></textarea></div></div>");function pe(n,t){U(t,!0);const e=6;let r=F(t,"label",3,void 0),l=F(t,"placeholder",3,""),s=F(t,"maxRows",3,e),C=W(()=>t.value);var p=vt();let P;var A=b(p);{var m=d=>{var _=dt(),k=b(_,!0);c(_),I(()=>J(k,r())),f(d,_)};L(A,d=>{r()&&d(m)})}var u=o(A,2);let S;var i=b(u);je(i),i.__input=[ct,t,C];let w;c(u),c(p),I((d,_,k)=>{P=te(p,1,"fieldgroup svelte-o02g58",null,P,d),S=te(u,1,"field svelte-o02g58",null,S,_),i.disabled=t.readonly,ne(i,"placeholder",l()),ne(i,"rows",s()==="unlimited"?void 0:s()),w=te(i,1,"svelte-o02g58",null,w,k)},[()=>({expanded:s()==="unlimited"}),()=>({expanded:s()==="unlimited"}),()=>({expanded:s()==="unlimited"})]),De(i,()=>a(C),d=>H(C,d)),f(n,p),j()}Q(["input"]);var ut=y('<div class="portrait svelte-8jg83a"><img class="svelte-8jg83a"/></div>'),gt=y("<!> <!>",1);function bt(n,t){U(t,!0);let e=F(t,"character",7);var r=gt(),l=ae(r);{var s=p=>{O(p,{children:(P,A)=>{var m=ut(),u=b(m);c(m),I(()=>{ne(u,"src",e().img),ne(u,"alt",e().name)}),f(P,m)},$$slots:{default:!0}})};L(l,p=>{e().img&&p(s)})}var C=o(l,2);O(C,{children:(p,P)=>{pe(p,{label:"Historia",get value(){return e().story},get readonly(){return t.readonly},onChange:A=>{e().story=A,t.onChange(e())}})},$$slots:{default:!0}}),f(n,r),j()}var mt=(n,t)=>t("ability"),_t=(n,t)=>t("item"),ht=y('<!> <div class="controls svelte-o497rd"><span class="svelte-o497rd">Agregar cartas a tu colecciÃ³n</span> <div class="buttons svelte-o497rd"><button>Agregar Carta de Habilidad</button> <button>Agregar Carta de Objeto MÃ¡gico</button></div></div>',1),ft=y('<div class="empty svelte-o497rd"><em>No se encontraron resultados</em></div>'),yt=y('<div class="cards-tab svelte-o497rd"><!> <!> <!></div> <div class="add-card-modal svelte-o497rd"><div class="all-cards svelte-o497rd"><!> <div class="cards-viewport svelte-o497rd"><!></div></div> <div class="footer svelte-o497rd"><button>Cerrar</button></div></div>',1);function Ct(n,t){U(t,!0);let e=F(t,"character",7),{loadAbilityCards:r,abilityCards:l,loadItemCards:s,itemCards:C}=ze(),{rollExpression:p}=Me();const{buildEmptyFilters:P}=Qe();let A=ge(ve(P())),m=ge(ve([])),u=ge(ve({opened:!1,filteredCards:[],allCards:[]}));const S=l.subscribe(()=>{H(u,{...a(u),allCards:[],filteredCards:[]},!0)});Ge(()=>{S()}),qe(async()=>{await Promise.all([s(),r()]),H(m,[...ue(C),...ue(l)],!0)});const i=R=>{e().cards=R,t.onChange(e())},w=async R=>{const G=e().cards.find(T=>T.id===R),z=a(m).find(T=>T.id===R);G&&z&&G.uses!==null&&z&&await p({expression:"1d6",variables:{},title:`${e().name}: Recarga de carta ${z.name}`,resultFormatter:Z=>`<span class="total ${Z>=(z.uses?.qty??0)?"success":"failure"}">${Z}</span>`})>=(z.uses?.qty??0)&&(G.uses+=1,i([...e().cards]))},d=R=>{H(A,R,!0),H(u,{...a(u),filteredCards:et(a(u).allCards,a(A))},!0)},_=()=>{d(P())},k=R=>{setTimeout(()=>{const G=R==="ability"?ue(l):ue(C);H(u,{opened:!0,filteredCards:G,allCards:G},!0)},0)},x=()=>{H(u,{opened:!1,filteredCards:[],allCards:[]},!0)};var v=yt(),g=ae(v),h=b(g);{var E=R=>{O(R,{children:(G,z)=>{var T=ht(),Z=ae(T);q(Z,{label:"Ranuras de Cartas Activas",labelWidth:"fit",get value(){return e().maxActiveCards},get readonly(){return t.readonly},fullWidth:!0,onChange:Oe=>{e().maxActiveCards=Number(Oe),t.onChange(e())}});var _e=o(Z,2),Ae=o(b(_e),2),Se=b(Ae);Se.__click=[mt,k];var Ie=o(Se,2);Ie.__click=[_t,k],c(Ae),c(_e),f(G,T)},$$slots:{default:!0}})};L(h,R=>{t.readonly||R(E)})}var M=o(h,2);O(M,{get title(){return`Cartas Activas (${e().numActiveCards??""}/${e().maxActiveCards??""})`},children:(R,G)=>{{let z=W(()=>a(m).filter(T=>e().cards.some(Z=>Z.isActive&&Z.id===T.id)));Ce(R,{get cards(){return a(z)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"active",onChange:i,onCardReloadClick:w})}},$$slots:{default:!0}});var K=o(M,2);O(K,{title:"ColecciÃ³n",children:(R,G)=>{{let z=W(()=>a(m).filter(T=>e().cards.some(Z=>Z.id===T.id)));Ce(R,{get cards(){return a(z)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"collection",onChange:i})}},$$slots:{default:!0}}),c(g);var X=o(g,2),ie=b(X),N=b(ie);Xe(N,{get cards(){return a(u).filteredCards},onFiltersChange:d,onResetFilters:_,get filters(){return a(A)}});var D=o(N,2),V=b(D);{var Y=R=>{{let G=W(()=>a(u).filteredCards.filter(z=>e().cards.find(T=>T.id===z.id)===void 0));Ce(R,{get cards(){return a(G)},get readonly(){return t.readonly},get characterCards(){return e().cards},listMode:"all",onChange:i})}},oe=R=>{var G=ft();f(R,G)};L(V,R=>{a(u).filteredCards.length>0?R(Y):R(oe,!1)})}c(D),c(ie);var de=o(ie,2),ye=b(de);ye.__click=x,c(de),c(X),Ze(X,R=>$e?.(R)),I(()=>ne(X,"hidden",!a(u).opened)),Je("outsideclick",X,x),f(n,v),j()}Q(["click"]);const kt=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"add",value:t.quantity,reason:t.reason||e};r().goldHistory.unshift(C),l.onChange(r()),s()},xt=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"subtract",value:t.quantity,reason:t.reason||e};r().goldHistory.unshift(C),l.onChange(r()),s()};var Pt=y('<div class="status svelte-ssntdk"><div class="indicator svelte-ssntdk"><span>Oro Actual</span> <strong> </strong></div> <div class="indicator svelte-ssntdk"><span>Oro Gastado</span> <strong class="number svelte-ssntdk"> </strong></div></div>'),wt=y('<div class="editor svelte-ssntdk"><div class="labels svelte-ssntdk"><label class="qty svelte-ssntdk">Cantidad</label> <label class="reason svelte-ssntdk">RazÃ³n</label> <label class="btn svelte-ssntdk"></label> <label class="btn svelte-ssntdk"></label></div> <div class="controls svelte-ssntdk"><!> <!> <button title="Gastar Oro" class="svelte-ssntdk">-</button> <button title="Ganar Oro" class="svelte-ssntdk">+</button></div></div>'),pt=(n,t,e)=>t(a(e)),At=y('<div class="log-content svelte-ssntdk"><strong> </strong> <span class="log-reason svelte-ssntdk"> </span> <button title="Deshacer esta acciÃ³n">â†¶</button></div>'),St=y('<div class="empty svelte-ssntdk"><em>No hay registros</em></div>'),Et=y('<div class="history svelte-ssntdk"></div>'),Nt=y("<!> <!> <!>",1);function Rt(n,t){U(t,!0);const e="Sin razÃ³n especifica";let r=F(t,"character",7),l=ve({quantity:1,reason:""});const s=()=>{l.quantity=1,l.reason=""},C=S=>{r().goldHistory=r().goldHistory.filter(i=>i.id!==S.id),t.onChange(r())};var p=Nt(),P=ae(p);O(P,{title:"Estado Actual",children:(S,i)=>{var w=Pt(),d=b(w),_=o(b(d),2);let k;var x=b(_,!0);c(_),c(d);var v=o(d,2),g=o(b(v),2),h=b(g,!0);c(g),c(v),c(w),I(E=>{k=te(_,1,"number svelte-ssntdk",null,k,E),J(x,r().currentGold),J(h,r().spentGold)},[()=>({negative:r().currentGold<0})]),f(S,w)},$$slots:{default:!0}});var A=o(P,2);{var m=S=>{O(S,{title:"Actualizar Oro",children:(i,w)=>{var d=wt(),_=o(b(d),2),k=b(_);q(k,{get value(){return l.quantity},placeholder:"Cantidad",fullWidth:!1,onChange:h=>{l.quantity=Number(h)}});var x=o(k,2);q(x,{get value(){return l.reason},placeholder:"RazÃ³n",fullWidth:!0,onChange:h=>{l.reason=h.toString()}});var v=o(x,2);v.__click=[xt,l,e,r,t,s];var g=o(v,2);g.__click=[kt,l,e,r,t,s],c(_),c(d),f(i,d)},$$slots:{default:!0}})};L(A,S=>{t.readonly||S(m)})}var u=o(A,2);O(u,{title:"Historial",children:(S,i)=>{var w=Et();le(w,21,()=>r().goldHistory,d=>d.id,(d,_)=>{var k=At(),x=b(k);let v;var g=b(x);c(x);var h=o(x,2),E=b(h,!0);c(h);var M=o(h,2);M.__click=[pt,C,_],c(k),I(K=>{v=te(x,1,"log-amount svelte-ssntdk",null,v,K),J(g,`${a(_).type==="add"?"+":"-"}${a(_).value??""} Oro`),J(E,a(_).reason)},[()=>({positive:a(_).type==="add",negative:a(_).type==="subtract"})]),f(d,k)},d=>{var _=St();f(d,_)}),c(w),f(S,w)},$$slots:{default:!0}}),f(n,p),j()}Q(["click"]);const Mt=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),name:"",atkFormula:"",dmgFormula:"",notes:""}]),e.onChange(t())};var qt=y('<button title="Agregar Ataque">â•</button>'),Dt=(n,t,e)=>t(a(e)),zt=y('<button title="Eliminar" class="svelte-1v2w3y3">ğŸ—‘ï¸</button>'),Tt=y('<div class="item svelte-1v2w3y3"><!> <!> <!> <!> <!></div>'),Ft=y('<div class="attack-list svelte-1v2w3y3"><div class="header svelte-1v2w3y3"><label>Ataques</label> <!></div> <div class="content svelte-1v2w3y3"><div class="attacks-header svelte-1v2w3y3"><label class="name svelte-1v2w3y3">Nombre</label> <label class="atk-formula svelte-1v2w3y3">Formula Ataque</label> <label class="dmg-formula svelte-1v2w3y3">Formula DaÃ±o</label> <label class="notes svelte-1v2w3y3">Notas</label> <label class="actions svelte-1v2w3y3"></label></div> <!></div></div>');function It(n,t){U(t,!0);let e=F(t,"attacks",7);const r=m=>{e(e().filter(u=>u.id!==m.id)),t.onChange(e())};var l=Ft(),s=b(l),C=o(b(s),2);{var p=m=>{var u=qt();u.__click=[Mt,e,t],f(m,u)};L(C,m=>{t.readonly||m(p)})}c(s);var P=o(s,2),A=o(b(P),2);le(A,17,e,m=>m.id,(m,u,S)=>{var i=Tt(),w=b(i);q(w,{get value(){return a(u).name},get readonly(){return t.readonly},placeholder:"Nombre",fullWidth:!0,onChange:g=>{a(u).name=g.toString(),t.onChange(e())}});var d=o(w,2);{let g=W(()=>({icon:"ğŸ¯",title:"Tirar Ataque",onClick:()=>t.onAttackRoll(a(u)),disabled:!a(u).atkFormula}));q(d,{get value(){return a(u).atkFormula},get readonly(){return t.readonly},placeholder:"1d6e+cuerpo",fullWidth:!0,onChange:h=>{a(u).atkFormula=h.toString(),t.onChange(e())},get button(){return a(g)}})}var _=o(d,2);{let g=W(()=>({icon:"ğŸ’¥",title:"Tirar DaÃ±o",onClick:()=>t.onDamageRoll(a(u)),disabled:!a(u).dmgFormula}));q(_,{get value(){return a(u).dmgFormula},get readonly(){return t.readonly},placeholder:"1d4",fullWidth:!0,onChange:h=>{a(u).dmgFormula=h.toString(),t.onChange(e())},get button(){return a(g)}})}var k=o(_,2);q(k,{get value(){return a(u).notes},get readonly(){return t.readonly},placeholder:"Contundente",fullWidth:!0,onChange:g=>{a(u).notes=g.toString(),t.onChange(e())}});var x=o(k,2);{var v=g=>{var h=zt();h.__click=[Dt,r,u],f(g,h)};L(x,g=>{t.readonly||g(v)})}c(i),f(m,i)}),c(P),c(l),f(n,l),j()}Q(["click"]);function be(n,t){U(t,!0);{let e=W(()=>({icon:"ğŸ²",onClick:t.onDiceRoll,title:"Tirar"}));q(n,{get label(){return t.name},get value(){return t.value},get readonly(){return t.readonly},onChange:r=>t.onChange(Number(r)),get button(){return a(e)}})}j()}const Ot=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),quantity:1,name:"",notes:""}]),e.onChange(t())};var Lt=y('<button title="Agregar Item">â•</button>'),Ut=(n,t,e)=>t(a(e)),jt=y('<button title="Eliminar">ğŸ—‘ï¸</button>'),Ht=y('<div class="item svelte-1ewnrao"><!> <!> <!> <!></div>'),Wt=y('<div class="equipment-list svelte-1ewnrao"><div class="header svelte-1ewnrao"><label>Equipo</label> <!></div> <div class="content svelte-1ewnrao"><div class="items-header svelte-1ewnrao"><label class="quantity svelte-1ewnrao">Cantidad</label> <label class="name svelte-1ewnrao">Nombre</label> <label class="notes svelte-1ewnrao">Notas</label></div> <!></div></div>');function Gt(n,t){U(t,!0);let e=F(t,"equipment",7);const r=m=>{e(e().filter(u=>u.id!==m.id)),t.onChange(e())};var l=Wt(),s=b(l),C=o(b(s),2);{var p=m=>{var u=Lt();u.__click=[Ot,e,t],f(m,u)};L(C,m=>{t.readonly||m(p)})}c(s);var P=o(s,2),A=o(b(P),2);le(A,17,e,m=>m.id,(m,u,S)=>{var i=Ht(),w=b(i);q(w,{get value(){return a(u).quantity},get readonly(){return t.readonly},onChange:v=>{a(u).quantity=Number(v),t.onChange(e())}});var d=o(w,2);q(d,{get value(){return a(u).name},get readonly(){return t.readonly},placeholder:"Nombre",onChange:v=>{a(u).name=v.toString(),t.onChange(e())}});var _=o(d,2);q(_,{get value(){return a(u).notes},get readonly(){return t.readonly},placeholder:"Notas",fullWidth:!0,onChange:v=>{a(u).notes=v.toString(),t.onChange(e())}});var k=o(_,2);{var x=v=>{var g=jt();g.__click=[Ut,r,u],f(v,g)};L(k,v=>{t.readonly||v(x)})}c(i),f(m,i)}),c(P),c(l),f(n,l),j()}Q(["click"]);var Jt=y('<div class="attributes svelte-ox7hjw"><!> <!> <!> <!> <!> <!></div>'),Vt=y('<div class="attributes svelte-ox7hjw"><!> <!> <!> <!> <!> <!> <!></div>'),Bt=y('<div class="empty svelte-ox7hjw"><em>No hay ataques cargados.</em></div>'),Kt=y('<div class="info svelte-ox7hjw"><!> <!> <!> <!></div>'),Yt=y('<div class="empty svelte-ox7hjw"><em>El equipo esta vacÃ­o.</em></div>'),Qt=y('<div class="equipment svelte-ox7hjw"><!> <!> <!></div>'),Xt=y("<!> <!> <!> <!>",1);function Zt(n,t){U(t,!0);let e=F(t,"character",7),{rollExpression:r,rollModal:l}=Me();const s=i=>{l.openRollModal({expression:`1d6e+${i}`,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence,iniciativa:e().initiative},title:`${e().name}: ${tt(i)}`})},C=i=>{l.openRollModal({expression:i.atkFormula,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence},title:`${e().name}: Ataque con ${i.name}`})},p=i=>{r({expression:i.dmgFormula,variables:{cuerpo:e().attributes.body,reflejos:e().attributes.reflexes,mente:e().attributes.mind,instinto:e().attributes.instinct,presencia:e().attributes.presence},title:`${e().name}: DaÃ±o de ${i.name}`})};var P=Xt(),A=ae(P);O(A,{title:"Atributos Principales",children:(i,w)=>{var d=Jt(),_=b(d);be(_,{name:"Cuerpo",get value(){return e().attributes.body},get readonly(){return t.readonly},onDiceRoll:()=>s("cuerpo"),onChange:E=>{e().attributes.body=E,t.onChange(e())}});var k=o(_,2);be(k,{name:"Reflejos",get value(){return e().attributes.reflexes},get readonly(){return t.readonly},onDiceRoll:()=>s("reflejos"),onChange:E=>{e().attributes.reflexes=E,t.onChange(e())}});var x=o(k,2);be(x,{name:"Mente",get value(){return e().attributes.mind},get readonly(){return t.readonly},onDiceRoll:()=>s("mente"),onChange:E=>{e().attributes.mind=E,t.onChange(e())}});var v=o(x,2);be(v,{name:"Instinto",get value(){return e().attributes.instinct},get readonly(){return t.readonly},onDiceRoll:()=>s("instinto"),onChange:E=>{e().attributes.instinct=E,t.onChange(e())}});var g=o(v,2);be(g,{name:"Presencia",get value(){return e().attributes.presence},get readonly(){return t.readonly},onDiceRoll:()=>s("presencia"),onChange:E=>{e().attributes.presence=E,t.onChange(e())}});var h=o(g,2);q(h,{label:"Suerte",get value(){return e().currentLuck},get max(){return e().maxLuck},get readonly(){return t.readonly},onChange:E=>{e().currentLuck=Number(E),t.onChange(e())}}),c(d),f(i,d)},$$slots:{default:!0}});var m=o(A,2);O(m,{title:"Atributos Derivados",children:(i,w)=>{var d=Vt(),_=b(d);q(_,{label:"Salud",get value(){return e().currentHP},get max(){return e().maxHP},get readonly(){return t.readonly},onChange:M=>{e().currentHP=Number(M),t.onChange(e())}});var k=o(_,2);q(k,{label:"Salud Temporal",get value(){return e().tempHP},get readonly(){return t.readonly},onChange:M=>{e().tempHP=Number(M),t.onChange(e())}});var x=o(k,2);q(x,{label:"Velocidad",get value(){return e().speed},readonly:!0});var v=o(x,2);q(v,{label:"Esquiva",get value(){return e().evasion},readonly:!0});var g=o(v,2);q(g,{label:"MitigaciÃ³n FÃ­sica",get value(){return e().physicalMitigation},readonly:!0});var h=o(g,2);q(h,{label:"MitigaciÃ³n MÃ¡gica",get value(){return e().magicalMitigation},readonly:!0});var E=o(h,2);q(E,{label:"Iniciativa",get value(){return e().initiative},readonly:!0,button:{icon:"ğŸ²",title:"Tirar iniciativa",onClick:()=>s("iniciativa")}}),c(d),f(i,d)},$$slots:{default:!0}});var u=o(m,2);O(u,{title:"InformaciÃ³n",children:(i,w)=>{var d=Kt(),_=b(d);It(_,{get attacks(){return e().attacks},get readonly(){return t.readonly},onChange:h=>{e().attacks=h,t.onChange(e())},onAttackRoll:C,onDamageRoll:p});var k=o(_,2);{var x=h=>{var E=Bt();f(h,E)};L(k,h=>{e().attacks.length===0&&h(x)})}var v=o(k,2);pe(v,{label:"InformaciÃ³n RÃ¡pida",get value(){return e().quickInfo},get readonly(){return t.readonly},placeholder:"InformaciÃ³n general, habilidades, etc.",onChange:h=>{e().quickInfo=h,t.onChange(e())}});var g=o(v,2);q(g,{label:"Lenguas",get value(){return e().languages},get readonly(){return t.readonly},fullWidth:!0,placeholder:"Lista de lenguas concidas",textAlign:"left",onChange:h=>{e().languages=h,t.onChange(e())}}),c(d),f(i,d)},$$slots:{default:!0}});var S=o(u,2);O(S,{title:"Equipo",children:(i,w)=>{var d=Qt(),_=b(d);q(_,{label:"Oro",get value(){return e().currentGold},readonly:!0,fullWidth:!0});var k=o(_,2);Gt(k,{get equipment(){return e().equipment},get readonly(){return t.readonly},onChange:g=>{e().equipment=g,t.onChange(e())}});var x=o(k,2);{var v=g=>{var h=Yt();f(g,h)};L(x,g=>{e().equipment.length===0&&g(v)})}c(d),f(i,d)},$$slots:{default:!0}}),f(n,P),j()}const $t=(n,t,e,r)=>{const l={id:crypto.randomUUID(),title:"Nota Nueva",content:""};H(t,[...a(t),l],!0),e.onChange(a(t)),r(l)};var ea=(n,t,e)=>t(a(e)),ta=y('<div class="header svelte-z1ulbz"><button title="Agregar Nota">â•</button> <button title="Eliminar Nota">ğŸ—‘ï¸</button></div>'),aa=(n,t,e)=>t(a(e)),ra=y('<button><span class="svelte-z1ulbz"> </span></button>'),na=y('<div class="notes svelte-z1ulbz"></div>'),la=y('<div class="notes empty svelte-z1ulbz"><em>No hay notas</em></div>'),oa=y('<div class="note svelte-z1ulbz"><!> <!></div>'),sa=y('<div class="note empty svelte-z1ulbz"><em>No hay ninguna nota seleccionada</em></div>'),ia=y('<div class="notes svelte-z1ulbz"><div class="list svelte-z1ulbz"><!> <!></div> <div class="content svelte-z1ulbz"><!></div></div>');function da(n,t){U(t,!0);let e=ge(ve(t.notes)),r=ge(void 0),l=W(()=>a(e).find(v=>v.id===a(r)));const s=v=>{H(r,v.id,!0)},C=v=>{v&&(H(e,a(e).filter(g=>g.id!==v),!0),H(r,void 0),t.onChange(a(e)))},p=()=>{H(e,[...a(e)],!0),t.onChange(a(e))};var P=ia(),A=b(P),m=b(A);{var u=v=>{var g=ta(),h=b(g);h.__click=[$t,e,t,s];var E=o(h,2);E.__click=[ea,C,r],c(g),I(()=>E.disabled=!a(l)),f(v,g)};L(m,v=>{t.readonly||v(u)})}var S=o(m,2);{var i=v=>{var g=na();le(g,21,()=>a(e),h=>h.id,(h,E)=>{var M=ra();let K;M.__click=[aa,s,E];var X=b(M),ie=b(X,!0);c(X),c(M),I(N=>{K=te(M,1,"note-btn svelte-z1ulbz",null,K,N),J(ie,a(E).title||"Nota sin tÃ­tulo")},[()=>({selected:a(r)===a(E).id})]),f(h,M)}),c(g),f(v,g)},w=v=>{var g=la();f(v,g)};L(S,v=>{a(e).length>0?v(i):v(w,!1)})}c(A);var d=o(A,2),_=b(d);{var k=v=>{var g=oa(),h=b(g);Fe(h,{get value(){return a(l).title},get readonly(){return t.readonly},placeholder:"TÃ­tulo de la nota",onChange:M=>{a(l).title=M,p()}});var E=o(h,2);pe(E,{get value(){return a(l).content},get readonly(){return t.readonly},placeholder:"Contenido de la nota",onChange:M=>{a(l).content=M,p()},maxRows:"unlimited"}),c(g),f(v,g)},x=v=>{var g=sa();f(v,g)};L(_,v=>{a(l)?v(k):v(x,!1)})}c(d),c(P),f(n,P),j()}Q(["click"]);function ca(n,t){U(t,!0);let e=F(t,"character",7);O(n,{title:"Notas",children:(r,l)=>{da(r,{get notes(){return e().notes},get readonly(){return t.readonly},onChange:s=>{e().notes=s,t.onChange(e())}})},$$slots:{default:!0}}),j()}const va=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"add",value:t.quantity,reason:t.reason||e};r().ppHistory.unshift(C),l.onChange(r()),s()},ua=(n,t,e,r,l,s)=>{const C={id:crypto.randomUUID(),type:"subtract",value:t.quantity,reason:t.reason||e};r().ppHistory.unshift(C),l.onChange(r()),s()};var ga=y('<div class="status svelte-1cdo061"><div class="indicator svelte-1cdo061"><span>PP Actuales</span> <strong> </strong></div> <div class="indicator svelte-1cdo061"><span>PP Gastados</span> <strong class="number svelte-1cdo061"> </strong></div> <div class="indicator svelte-1cdo061"><span>Poder de PJ</span> <strong class="number svelte-1cdo061"> </strong></div></div>'),ba=y('<div class="editor svelte-1cdo061"><div class="labels svelte-1cdo061"><label class="qty svelte-1cdo061">Cantidad</label> <label class="reason svelte-1cdo061">RazÃ³n</label> <label class="btn svelte-1cdo061"></label> <label class="btn svelte-1cdo061"></label></div> <div class="controls svelte-1cdo061"><!> <!> <button title="Gastar PP" class="svelte-1cdo061">-</button> <button title="Ganar PP" class="svelte-1cdo061">+</button></div></div>'),ma=(n,t,e)=>t(a(e)),_a=y('<div class="log-content svelte-1cdo061"><strong> </strong> <span class="log-reason svelte-1cdo061"> </span> <button title="Deshacer esta acciÃ³n">â†¶</button></div>'),ha=y('<div class="empty svelte-1cdo061"><em>No hay registros</em></div>'),fa=y('<div class="history svelte-1cdo061"></div>'),ya=y("<!> <!> <!>",1);function Ca(n,t){U(t,!0);const e="Sin razÃ³n especifica";let r=F(t,"character",7),l=ve({quantity:1,reason:""});const s=()=>{l.quantity=1,l.reason=""},C=S=>{r().ppHistory=r().ppHistory.filter(i=>i.id!==S.id),t.onChange(r())};var p=ya(),P=ae(p);O(P,{title:"Estado Actual",children:(S,i)=>{var w=ga(),d=b(w),_=o(b(d),2);let k;var x=b(_,!0);c(_),c(d);var v=o(d,2),g=o(b(v),2),h=b(g,!0);c(g),c(v);var E=o(v,2),M=o(b(E),2),K=b(M,!0);c(M),c(E),c(w),I(X=>{k=te(_,1,"number svelte-1cdo061",null,k,X),J(x,r().currentPP),J(h,r().spentPP),J(K,r().pjPower)},[()=>({negative:r().currentPP<0})]),f(S,w)},$$slots:{default:!0}});var A=o(P,2);{var m=S=>{O(S,{title:"Actualizar Progreso",children:(i,w)=>{var d=ba(),_=o(b(d),2),k=b(_);q(k,{get value(){return l.quantity},placeholder:"Cantidad",fullWidth:!1,onChange:h=>{l.quantity=Number(h)}});var x=o(k,2);q(x,{get value(){return l.reason},placeholder:"RazÃ³n",fullWidth:!0,onChange:h=>{l.reason=h.toString()}});var v=o(x,2);v.__click=[ua,l,e,r,t,s];var g=o(v,2);g.__click=[va,l,e,r,t,s],c(_),c(d),f(i,d)},$$slots:{default:!0}})};L(A,S=>{t.readonly||S(m)})}var u=o(A,2);O(u,{title:"Historial",children:(S,i)=>{var w=fa();le(w,21,()=>r().ppHistory,d=>d.id,(d,_)=>{var k=_a(),x=b(k);let v;var g=b(x);c(x);var h=o(x,2),E=b(h,!0);c(h);var M=o(h,2);M.__click=[ma,C,_],c(k),I(K=>{v=te(x,1,"log-amount svelte-1cdo061",null,v,K),J(g,`${a(_).type==="add"?"+":"-"}${a(_).value??""} PP`),J(E,a(_).reason)},[()=>({positive:a(_).type==="add",negative:a(_).type==="subtract"})]),f(d,k)},d=>{var _=ha();f(d,_)}),c(w),f(S,w)},$$slots:{default:!0}}),f(n,p),j()}Q(["click"]);const ka=(n,t)=>{let e="";if(e+=`# ${n.name}

`,e+=`## Atributos
`,e+=`- **Cuerpo:** ${n.attributes.body}
`,e+=`- **Reflejos:** ${n.attributes.reflexes}
`,e+=`- **Mente:** ${n.attributes.mind}
`,e+=`- **Instinto:** ${n.attributes.instinct}
`,e+=`- **Presencia:** ${n.attributes.presence}

`,e+=`- **Suerte:** ${n.currentLuck}/${n.maxLuck}
`,e+=`
`,e+=`## Atributos derivados
`,e+=`- **Salud:** ${n.currentHP}/${n.maxHP}
`,e+=`- **Salud Temporal:** ${n.tempHP}
`,e+=`- **Velocidad:** ${n.speed}
`,e+=`- **Esquiva:** ${n.evasion}
`,e+=`- **MitigaciÃ³n FÃ­sica:** ${n.physicalMitigation}
`,e+=`- **MitigaciÃ³n MÃ¡gica:** ${n.magicalMitigation}
`,e+=`- **Iniciativa:** ${n.initiative}
`,e+=`
`,n.quickInfo&&(e+=`## InformaciÃ³n RÃ¡pida
`,e+=`\`\`\`${n.quickInfo}
\`\`\`
`,e+=`
`),e+=`## Lenguas
`,e+=`${n.languages||"-"}
`,e+=`
`,e+=`## Oro
`,e+=`${n.currentGold}
`,e+=`
`,e+=`## Inventario
`,n.equipment.length>0){e+=`| Cantidad | Nombre | Notas |
`,e+=`| - | - | - |
`;for(const r of n.equipment)e+=`| ${r.quantity} | ${r.name} | ${r.notes} |
`}else e+=`__No hay items en el inventario.__
`;if(e+=`
`,e+=`## Cartas
`,e+=`**Cartas activas:** ${n.numActiveCards}${n.maxActiveCards}
`,e+=`### ColecciÃ³n
`,n.cards.length>0){e+=`| Nombre | Tipo | Activa |
`,e+=`| - | - | - |
`;for(const r of n.cards){const l=t.find(s=>s.id===r.id);l&&(e+=`| ${l.name} | ${l.cardType==="item"?"Objeto MÃ¡gico":"Habilidad"} | ${r.isActive?"Si":"No"} |
`)}}else e+=`__No hay cartas en la colecciÃ³n.__
`;if(e+=`
`,e+=`## Progreso
`,e+=`- **PP Actuales:** ${n.currentPP}
`,e+=`- **PP Gastados:** ${n.spentPP}
`,e+=`- **Poder de Personaje:** ${n.pjPower}
`,e+=`
`,n.story&&(e+=`## Historia
`,e+=`${n.story}
`,e+=`
`),n.notes.length>0){e+=`## Notas del Jugador
`;for(const r of n.notes)e+=`### ${r.title}
`,e+=`\`\`\`${r.content}\`\`\`
`;e+=`
`}return e},xa=async(n,t)=>{try{await navigator.clipboard.writeText(a(t)),alert("Personaje en formato Markdown copiado al portapapeles!")}catch(e){console.error("Failed to copy text: ",e),alert("Error al copiar el markdown al portapapeles")}};var Pa=y('<div class="header svelte-1m8ejye"><label>Personaje</label> <button>Copiar Markdown</button></div> <pre class="svelte-1m8ejye"> </pre>',1);function wa(n,t){U(t,!0);let e=ge(ve([])),{loadAbilityCards:r,abilityCards:l,loadItemCards:s,itemCards:C}=ze(),p=W(()=>ka(t.character,a(e)));qe(async()=>{await Promise.all([s(),r()]),H(e,[...ue(C),...ue(l)],!0)}),O(n,{children:(P,A)=>{var m=Pa(),u=ae(m),S=o(b(u),2);S.__click=[xa,p],c(u);var i=o(u,2),w=b(i,!0);c(i),I(()=>J(w,a(p))),f(P,m)},$$slots:{default:!0}}),j()}Q(["click"]);var pa=(n,t,e)=>t()(a(e)),Aa=y("<option> </option>"),Sa=y('<div class="fieldgroup svelte-1oyc7vz"><select></select></div>');function Re(n,t){U(t,!0);let e=F(t,"onChange",3,()=>{}),r=W(()=>t.value);var l=Sa(),s=b(l);s.__change=[pa,e,r],le(s,21,()=>t.options,C=>C.label,(C,p)=>{var P=Aa(),A=b(P,!0);c(P);var m={};I(()=>{J(A,a(p).label),m!==(m=a(p).value)&&(P.value=(P.__value=a(p).value)??"")}),f(C,P)}),c(s),c(l),at(s,()=>a(r),C=>H(r,C)),f(n,l),j()}Q(["change"]);const Ea=(n,t,e)=>{t([...t(),{id:crypto.randomUUID(),attribute:"maxHP",type:"add",formula:"",reason:""}]),e.onChange(t())};var Na=(n,t,e)=>t(a(e)),Ra=y('<div class="modifier svelte-1n17zba"><!> <!> <!> <!> <button title="Eliminar" class="svelte-1n17zba">ğŸ—‘ï¸</button></div>'),Ma=y('<div class="empty svelte-1n17zba"><em>No hay modificadores disponibles</em></div>'),qa=y('<div class="modifier-list svelte-1n17zba"><div class="header svelte-1n17zba"><label>Modificadores</label> <button title="Agregar Modificador">â•</button></div> <div class="content svelte-1n17zba"><div class="modifiers-header svelte-1n17zba"><label class="type svelte-1n17zba">Tipo</label> <label class="field svelte-1n17zba">Atributo</label> <label class="formula svelte-1n17zba">Formula</label> <label class="label svelte-1n17zba">RazÃ³n</label> <label class="btn svelte-1n17zba"></label></div> <!></div></div>');function Da(n,t){U(t,!0);let e=F(t,"modifiers",7);const r=A=>{e(e().filter(m=>m.id!==A.id)),t.onChange(e())};var l=qa(),s=b(l),C=o(b(s),2);C.__click=[Ea,e,t],c(s);var p=o(s,2),P=o(b(p),2);le(P,17,e,A=>A.id,(A,m,u)=>{var S=Ra(),i=b(S);Re(i,{options:[{label:"Sumar",value:"add"},{label:"Establecer",value:"set"}],get value(){return a(m).type},onChange:x=>{a(m).type=x.toString(),t.onChange(e())}});var w=o(i,2);Re(w,{options:[{label:"Salud MÃ¡xima",value:"maxHP"},{label:"Suerte MÃ¡xima",value:"maxLuck"},{label:"Esquiva",value:"evasion"},{label:"MitigaciÃ³n FÃ­sica",value:"physicalMitigation"},{label:"MitigaciÃ³n MÃ¡gica",value:"magicalMitigation"},{label:"Velocidad",value:"speed"}],get value(){return a(m).attribute},onChange:x=>{a(m).attribute=x.toString(),t.onChange(e())}});var d=o(w,2);q(d,{get value(){return a(m).formula},placeholder:"1+cuerpo",fullWidth:!0,onChange:x=>{a(m).formula=x.toString(),t.onChange(e())}});var _=o(d,2);q(_,{get value(){return a(m).reason},placeholder:"RazÃ³n",fullWidth:!0,onChange:x=>{a(m).reason=x.toString(),t.onChange(e())}});var k=o(_,2);k.__click=[Na,r,m],c(S),f(A,S)},A=>{var m=Ma();f(A,m)}),c(p),c(l),f(n,l),j()}Q(["click"]);var za=y('<div class="general svelte-1hn03u3"><!></div>'),Ta=y('<div class="modifiers svelte-1hn03u3"><!> <small class="available-variables svelte-1hn03u3"><em>Varaibles disponibles: cuerpo, reflejos, mente, instinto, presencia.</em></small></div>'),Fa=y("<!> <!>",1);function Ia(n,t){U(t,!0);let e=F(t,"character",7);var r=Fa(),l=ae(r);O(l,{title:"General",children:(C,p)=>{var P=za(),A=b(P);{let m=W(()=>e().img??"");q(A,{label:"URL del Retrato",get value(){return a(m)},fullWidth:!0,placeholder:"https://...",textAlign:"left",onChange:u=>{const S=u.toString();S.length>0?e().img=S:e().img=null,t.onChange(e())}})}c(P),f(C,P)},$$slots:{default:!0}});var s=o(l,2);O(s,{title:"Modificadores",children:(C,p)=>{var P=Ta(),A=b(P);Da(A,{get modifiers(){return e().modifiers},onChange:m=>{e().modifiers=m,t.onChange(e())}}),He(2),c(P),f(C,P)},$$slots:{default:!0}}),f(n,r),j()}var Oa=y("<button> </button>"),La=y('<div class="character-sheet svelte-1dl9cdg"><div class="title"><!></div> <div class="tabs svelte-1dl9cdg"></div> <!></div>');function Ua(n,t){U(t,!0);let e=F(t,"character",7);const r=[{name:"general",title:"General",component:Zt,availableWhenReadOnly:!0},{name:"cards",title:"Cartas",component:Ct,availableWhenReadOnly:!0},{name:"bio",title:"Bio",component:bt,availableWhenReadOnly:!0},{name:"notes",title:"Notas",component:ca,availableWhenReadOnly:!0},{name:"progress",title:"Progreso",component:Ca,availableWhenReadOnly:!0},{name:"economy",title:"EconomÃ­a",component:Rt,availableWhenReadOnly:!0},{name:"settings",title:"ConfiguraciÃ³n",component:Ia,availableWhenReadOnly:!1},{name:"see_as_md",title:"Ver como MD",component:wa,availableWhenReadOnly:!0}];let l=W(()=>Math.max(r.findIndex(i=>i.name===t.currentTab),0)),s=W(()=>r.find(i=>i.name===t.currentTab)??r[0]);const C=i=>{const w=i.copy();t.onChange(w),e(w)},p=i=>{H(l,i),t.onTabChange(r[i].name)};var P=La(),A=b(P),m=b(A);Fe(m,{get value(){return e().name},get readonly(){return t.readonly},onChange:i=>{e().name=i,C(e())}}),c(A);var u=o(A,2);le(u,23,()=>r,i=>i.title,(i,w,d)=>{var _=We(),k=ae(_);{var x=v=>{var g=Oa();let h;g.__click=()=>p(a(d));var E=b(g,!0);c(g),I(M=>{h=te(g,1,"tab",null,h,M),J(E,a(w).title)},[()=>({selected:a(l)===a(d)})]),f(v,g)};L(k,v=>{(a(w).availableWhenReadOnly||!t.readonly)&&v(x)})}f(i,_)}),c(u);var S=o(u,2);Ye(S,()=>a(s).component,(i,w)=>{w(i,{get character(){return e()},get readonly(){return t.readonly},onChange:C})}),c(P),f(n,P),j()}Q(["click"]);const ja=async(n,t,e)=>{const r=await t()();e(r)},Ha=async(n,t,e)=>{const r=await t()();e(r)},Wa=async(n,t,e)=>{a(t)&&await e()(a(t))},Ga=async(n,t,e,r)=>{!a(t)||!confirm(`Â¿Quieres eliminar a ${a(t).name}?`)||(await e()(a(t)),H(t,void 0),r(null))},Ja=async(n,t,e)=>{a(t)&&await e()(a(t))};var Va=y('<button title="Importar y Editar">ğŸ“</button>'),Ba=y('<button title="Crear">â•</button> <button title="Importar">ğŸ“¥</button> <button title="Exportar">ğŸ“¤</button> <button title="Eliminar">ğŸ—‘ï¸</button>',1),Ka=(n,t,e)=>t(a(e)),Ya=y('<img class="character-image svelte-dk16f3"/>'),Qa=y('<span class="image-placeholder svelte-dk16f3"> </span>'),Xa=y('<button><!> <span class="name svelte-dk16f3"> </span></button>'),Za=y('<section class="characters-page svelte-dk16f3"><div class="list svelte-dk16f3"><div class="header svelte-dk16f3"><!></div> <div class="content svelte-dk16f3"></div></div> <div class="viewport svelte-dk16f3"><!></div></section>');function _r(n,t){U(t,!0);const e=()=>Be(t.characters,"$characters",r),[r,l]=Ve(),s="general";let C=F(t,"onAddToMyCharacters",3,()=>{throw new Error("onAddToMyCharacters not implemented")}),p=F(t,"onCreateCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),P=F(t,"onImportCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),A=F(t,"onExportCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),m=F(t,"onDeleteCharacter",3,async()=>{throw new Error("onCreateCharacter not implemented")}),u=W(()=>re.url.searchParams.get("characterId")),S=W(()=>re.url.searchParams.get("tab")??s);const i=N=>{N!==null?(re.url.searchParams.set("characterId",N.id),re.url.searchParams.set("tab",s)):(re.url.searchParams.delete("characterId"),re.url.searchParams.delete("tab")),Ne(`?${re.url.searchParams.toString()}`)},w=N=>{re.url.searchParams.set("tab",N),Ne(`?${re.url.searchParams.toString()}`)};let d=W(()=>e().find(N=>N.id===a(u)));const _=N=>{t.characters.update(D=>{const V=D.findIndex(Y=>Y.id===N.id);if(V!==-1){const Y=[...D];return Y[V]=N,Y}return D})};var k=Za(),x=b(k),v=b(x),g=b(v);{var h=N=>{var D=Va();D.__click=[Ja,d,C],I(()=>D.disabled=t.allActionsDisabled||!a(d)),f(N,D)},E=N=>{var D=Ba(),V=ae(D);V.__click=[ja,p,i];var Y=o(V,2);Y.__click=[Ha,P,i];var oe=o(Y,2);oe.__click=[Wa,d,A];var de=o(oe,2);de.__click=[Ga,d,m,i],I(()=>{V.disabled=t.allActionsDisabled,Y.disabled=t.allActionsDisabled,oe.disabled=t.allActionsDisabled||!a(d),de.disabled=t.allActionsDisabled||!a(d)}),f(N,D)};L(g,N=>{t.readonly?N(h):N(E,!1)})}c(v);var M=o(v,2);le(M,5,e,N=>N.id,(N,D)=>{var V=Xa();let Y;V.__click=[Ka,i,D];var oe=b(V);{var de=z=>{var T=Ya();I(()=>{ne(T,"src",a(D).img),ne(T,"alt",a(D).name)}),f(z,T)},ye=z=>{var T=Qa(),Z=b(T,!0);c(T),I(_e=>J(Z,_e),[()=>a(D).name.charAt(0).toUpperCase()]),f(z,T)};L(oe,z=>{a(D).img?z(de):z(ye,!1)})}var R=o(oe,2),G=b(R,!0);c(R),c(V),I(z=>{Y=te(V,1,"character-item svelte-dk16f3",null,Y,z),ne(R,"title",a(D).name),J(G,a(D).name)},[()=>({selected:a(u)===a(D).id})]),f(N,V)}),c(M),c(x);var K=o(x,2),X=b(K);{var ie=N=>{Ua(N,{get character(){return a(d)},get readonly(){return t.readonly},onChange:_,get currentTab(){return a(S)},onTabChange:w})};L(X,N=>{a(d)&&N(ie)})}c(K),c(k),f(n,k),j(),l()}Q(["click"]);export{_r as C,mr as u};
