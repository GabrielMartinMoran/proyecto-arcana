import"./DsnmJJEf.js";import{h as Fe,u as Te,l as we,i as qe,F as je,b as g,s as Pe,t as D,a as m,g as _,e as d,aD as Me,r as c,aa as ce,be as Ae,am as Ne,j as a,K as R,aL as be,p as ve,ab as Y,d as oe,f as B,c as ee}from"./4UBXq5Sj.js";import{s as E,d as de,e as We}from"./DEyIqfax.js";import{e as ue,r as ke,s as X,a as Be,b as Ie}from"./Z0ud6hNo.js";import{t as Ge,b as Re,s as le,c as Qe}from"./3q36uapf.js";import{c as Ye,r as ye,l as He}from"./CGjaQNWU.js";import{i as P}from"./DY7lAt98.js";import{p as F}from"./CsZilKOT.js";import{C as Ke}from"./BLWxwbCG.js";import{h as Je}from"./QhpshmSz.js";import{d as Xe}from"./Bx3Ta1aT.js";import{r as Ze}from"./BrLjdzv6.js";import{p as T}from"./DmOLoh4V.js";import{r as Ve}from"./Tt7jWNin.js";import{m as $e,a as et}from"./D5qFhXHN.js";import{w as Ue,g as tt}from"./Cje6xDa-.js";function at(v,e,t){Fe(()=>{var s=Te(()=>e(v,t?.())||{});if(s?.destroy)return()=>s.destroy()})}function pe(v,e={},t,s){for(var i in t){var u=t[i];e[i]!==u&&(t[i]==null?v.style.removeProperty(i):v.style.setProperty(i,u,s))}}function Ce(v,e,t,s){var i=v.__style;if(we||i!==e){var u=Ge(e,s);(!we||u!==v.getAttribute("style"))&&(u==null?v.removeAttribute("style"):v.style.cssText=u),v.__style=e}else s&&(Array.isArray(s)?(pe(v,t?.[0],s[0]),pe(v,t?.[1],s[1],"important")):pe(v,t,s));return s}function rt(v,e,t,s,i){var u=()=>{s(t[v])};t.addEventListener(e,u),i?qe(()=>{t[v]=i()}):u(),(t===document.body||t===window||t===document)&&je(()=>{t.removeEventListener(e,u)})}var st=g('<h2 class="svelte-6qb8f6"> </h2>'),nt=g('<div class="container svelte-6qb8f6"><!> <!></div>');function it(v,e){let t=F(e,"title",3,void 0),s=F(e,"width",3,void 0);var i=nt();let u;var o=d(i);{var n=A=>{var C=st(),x=d(C,!0);c(C),D(()=>E(x,t())),m(A,C)};P(o,A=>{t()&&A(n)})}var z=_(o,2);Pe(z,()=>e.children??Me),c(i),D(A=>u=Ce(i,"",u,A),[()=>({width:s()})]),m(v,i)}const lt=v=>{window.addEventListener("click",e);function e(t){v.contains(t.target)||v.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var vt=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ot=["difference","intersection","symmetricDifference","union"],ze=!1;class te extends Set{#a=new Map;#e=ce(0);#t=ce(0);#r=Ae||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}ze||this.#n()}#s(e){return Ae===this.#r?ce(e):Ne(e)}#n(){ze=!0;var e=te.prototype,t=Set.prototype;for(const s of vt)e[s]=function(...i){return a(this.#e),t[s].apply(this,i)};for(const s of ot)e[s]=function(...i){a(this.#e);var u=t[s].apply(this,i);return new te(u)}}has(e){var t=super.has(e),s=this.#a,i=s.get(e);if(i===void 0){if(!t)return a(this.#e),!1;i=this.#s(!0),s.set(e,i)}return a(i),t}add(e){return super.has(e)||(super.add(e),R(this.#t,super.size),be(this.#e)),this}delete(e){var t=super.delete(e),s=this.#a,i=s.get(e);return i!==void 0&&(s.delete(e),R(i,!1)),t&&(R(this.#t,super.size),be(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())R(t,!1);e.clear(),R(this.#t,0),be(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const ct=(v,e,t)=>{R(e,new te),t.onChange(Array.from(a(e)))};var dt=(v,e,t)=>e(v.target.checked,a(t).value),ut=g('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),ft=g('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function xe(v,e){ve(e,!0);let t=Y(()=>new te(e.value));const s=(k,b)=>{k?a(t).add(b):a(t).delete(b),R(t,new te(a(t))),e.onChange(Array.from(a(t)))};let i=ce(!1);const u=()=>{R(i,!1)};var o=ft(),n=d(o),z=d(n);c(n);var A=_(n,2),C=d(A),x=d(C);ue(x,21,()=>e.options,k=>k.value,(k,b)=>{var O=ut(),w=d(O),r=d(w),l=_(r);ke(l),l.__input=[dt,s,b],c(w),c(O),D(h=>{X(w,"for",a(b).value),E(r,`${a(b).label??""} `),X(l,"id",a(b).value),X(l,"name",a(b).value),Be(l,a(b).value),Ie(l,h)},[()=>a(t).has(a(b).value)]),m(k,O)}),c(x);var M=_(x,2);M.__click=[ct,t,e],c(C),c(A),c(o),at(o,k=>lt?.(k)),Fe(()=>rt("open","toggle",o,k=>R(i,k),()=>a(i))),D(()=>{E(z,`${e.summary??""} (${a(t).size??""})`),M.disabled=a(t).size===0}),We("outsideclick",o,u),m(v,o),oe()}de(["input","click"]);var mt=(v,e,t)=>e.onFiltersChange({...a(t)}),_t=(v,e,t)=>{a(e).type=v.target.value,t.onFiltersChange({...a(e)})},ht=g("<option> </option>"),gt=(v,e)=>e.onResetFilters(),bt=g('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function la(v,e){ve(e,!0);let t=Y(()=>e.filters);const s=()=>{const o=new Set(e.cards.map(n=>n.level));return Array.from(o).sort((n,z)=>n-z)},i=()=>{const o=new Set(e.cards.flatMap(n=>n.tags));return Array.from(o).sort()},u=()=>{const o=new Set(e.cards.map(n=>n.type));return Array.from(o).sort()};it(v,{children:(o,n)=>{var z=bt(),A=d(z);ke(A),A.__input=[mt,e,t];var C=_(A,2);C.__change=[_t,t,e];var x=d(C);x.value=x.__value="";var M=_(x);ue(M,16,u,w=>w,(w,r)=>{var l=ht(),h=d(l,!0);c(l);var I={};D(H=>{E(h,H),I!==(I=r)&&(l.value=(l.__value=r)??"")},[()=>Ye(r)]),m(w,l)}),c(C);var k=_(C,2);{let w=Y(()=>s().map(r=>({value:r,label:`Nivel ${r}`})));xe(k,{summary:"Niveles",get options(){return a(w)},get value(){return a(t).level},onChange:r=>{a(t).level=r,e.onFiltersChange({...a(t)})}})}var b=_(k,2);{let w=Y(()=>i().map(r=>({value:r.toLowerCase(),label:r})));xe(b,{summary:"Etiquetas",get options(){return a(w)},get value(){return a(t).tags},onChange:r=>{a(t).tags=r.map(l=>l.toLowerCase()),e.onFiltersChange({...a(t)})}})}var O=_(b,2);O.__click=[gt,e],c(z),Re(A,()=>a(t).name,w=>a(t).name=w),m(o,z)},$$slots:{default:!0}}),oe()}de(["input","change","click"]);var pt=g("<label> </label>"),yt=(v,e,t,s)=>{e.max!==void 0&&typeof a(t)=="number"&&R(t,Math.min(a(t),e.max)),s()(a(t))},Ct=g('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),kt=g('<button class="button svelte-1r47u3b"> </button>'),wt=g("<div><!> <span><input/> <!> <!></span></div>");function At(v,e){ve(e,!0);let t=F(e,"label",3,void 0),s=F(e,"labelWidth",3,"normalized"),i=F(e,"readonly",3,!1),u=F(e,"onChange",3,()=>{}),o=F(e,"button",3,void 0),n=F(e,"fullWidth",3,!1),z=F(e,"placeholder",3,""),A=F(e,"textAlign",3,"center"),C=Y(()=>e.value);var x=wt();let M;var k=d(x);{var b=L=>{var p=pt(),U=d(p,!0);c(p),D(()=>{le(p,1,Qe(s()),"svelte-1r47u3b"),E(U,t())}),m(L,p)};P(k,L=>{t()&&L(b)})}var O=_(k,2);let w;var r=d(O);ke(r);let l;X(r,"min",0),r.__input=[yt,e,C,u];var h=_(r,2);{var I=L=>{var p=Ct(),U=_(B(p),2);let K;var ae=d(U,!0);c(U),D(V=>{K=le(U,1,"max svelte-1r47u3b",null,K,V),E(ae,e.max)},[()=>({withButton:o()!==void 0})]),m(L,p)};P(h,L=>{e.max!==void 0&&L(I)})}var H=_(h,2);{var Z=L=>{var p=kt();p.__click=function(...K){o().onClick?.apply(this,K)};var U=d(p,!0);c(p),D(()=>{X(p,"title",o().title),p.disabled=o().disabled,E(U,o().icon)}),m(L,p)};P(H,L=>{o()&&L(Z)})}c(O),c(x),D((L,p,U)=>{M=le(x,1,"fieldgroup svelte-1r47u3b",null,M,L),w=le(O,1,"field svelte-1r47u3b",null,w,p),X(r,"type",typeof e.value=="number"?"number":"text"),r.disabled=i(),l=le(r,1,`text-align-${A()}`,"svelte-1r47u3b",l,U),X(r,"max",e.max),X(r,"placeholder",z())},[()=>({fullWidth:n()}),()=>({inputAlone:e.max===void 0&&o()===void 0&&!n(),inputWithButton:o()!==void 0,fullWidth:n(),readonly:i()}),()=>({alone:e.max===void 0&&o()===void 0,fullWidth:n(),withButton:o()!==void 0,withButtonAndMax:e.max!==void 0&&o()!==void 0})]),Re(r,()=>a(C),L=>R(C,L)),m(v,x),oe()}de(["input","click"]);var zt=g('<span class="chip svelte-6vztta"> </span>'),xt=g('<span class="chip svelte-6vztta"> </span>'),Lt=g('<span class="chip svelte-6vztta"> </span>'),St=g('<span class="chip svelte-6vztta"> </span>'),Et=g('<span class="chip svelte-6vztta"> </span>'),Ft=g('<div class="controls svelte-6vztta"><!></div>'),Pt=g('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span> <span class="spacer svelte-6vztta"></span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function Rt(v,e){ve(e,!0);let t=F(e,"children",3,void 0);const s=f=>{switch(ye(f.length>0?String(f[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}};var i=Pt();let u;var o=d(i);let n;var z=_(o,2),A=d(z),C=d(A),x=d(C),M=d(x,!0);c(x);var k=_(x,2),b=d(k);c(k);var O=_(k,4),w=d(O,!0);c(O),c(C);var r=_(C,2),l=d(r,!0);c(r),c(A);var h=_(A,2),I=d(h),H=d(I);Je(H,()=>Xe.parse(e.card.description)),c(I);var Z=_(I,2),L=d(Z);ue(L,16,()=>e.card.tags,f=>f,(f,y)=>{var S=zt(),G=d(S,!0);c(S),D(()=>E(G,y)),m(f,S)});var p=_(L,2);{var U=f=>{var y=ee(),S=B(y);{var G=W=>{var Q=xt(),ie=d(Q);c(Q),D(()=>E(ie,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),m(W,Q)},ne=W=>{var Q=ee(),ie=B(Q);{var fe=q=>{var j=Lt(),_e=d(j);c(j),D(()=>E(_e,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),m(q,j)},me=q=>{var j=ee(),_e=B(j);{var De=he=>{var ge=St(),Oe=d(ge);c(ge),D(()=>E(Oe,`Usos: ${e.card.uses.qty??"?"??""}`)),m(he,ge)};P(_e,he=>{e.card.uses.type==="USES"&&he(De)},!0)}m(q,j)};P(ie,q=>{e.card.uses.type==="RELOAD"?q(fe):q(me,!1)},!0)}m(W,Q)};P(S,W=>{e.card.uses.type==="LONG_REST"?W(G):W(ne,!1)})}m(f,y)};P(p,f=>{e.card.uses.type&&f(U)})}var K=_(p,2);{var ae=f=>{var y=Et(),S=d(y);c(y),D(()=>E(S,`Costo: ${e.card.cost??""} de oro`)),m(f,y)};P(K,f=>{e.card.cardType==="item"&&f(ae)})}c(Z),c(h);var V=_(h,2),N=_(d(V),2),J=d(N),$=d(J,!0);c(J),c(N);var re=_(N,2);{var se=f=>{var y=Ft(),S=d(y);Pe(S,t),c(y),m(f,y)};P(re,f=>{t()!==void 0&&f(se)})}c(V),c(z),c(i),D((f,y,S,G)=>{u=Ce(i,"",u,f),n=Ce(o,"",n,y),E(M,e.card.cardType==="ability"?"Habilidad":"Objeto MÃ¡gico"),E(b,`Nivel ${e.card.level??""}`),E(w,S),E(l,e.card.name),E($,G)},[()=>({"border-color":s(e.card.tags)}),()=>({"background-image":`url(${e.card.img})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â€”"]),m(v,i),oe()}var Ut=(v,e,t)=>e(a(t).id),Dt=g('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Ot=(v,e,t)=>e(a(t).id),Tt=(v,e,t)=>e(a(t).id),qt=g("<button>Desactivar</button>"),jt=(v,e,t)=>e(a(t).id),Mt=g("<button>Activar</button>"),Nt=g('<button>Quitar</button> <span class="spacer"></span> <!>',1),Wt=(v,e,t)=>e(a(t)),Bt=g('<span class="spacer"></span> <button>Agregar</button>',1),It=g('<div class="controls svelte-1rfcjb3"><!></div>'),Gt=g('<div class="cards svelte-1rfcjb3"></div>');function va(v,e){ve(e,!0);let t=F(e,"readonly",3,!0),s=F(e,"characterCards",19,()=>[]),i=F(e,"listMode",3,"all"),u=F(e,"onChange",3,()=>{}),o=F(e,"onCardReloadClick",3,()=>{}),n=Y(s);const z=r=>{const l=e.cards.find(h=>h.id===r);if(!l){C(r);return}R(n,a(n).map(h=>h.id===r?{...h,isActive:!1,uses:b(l)}:h)),u()(a(n))},A=r=>{R(n,a(n).map(l=>l.id===r?{...l,isActive:!0}:l)),u()(a(n))},C=r=>{R(n,a(n).filter(l=>l.id!==r)),u()(a(n))},x=r=>{R(n,[...a(n),{id:r.id,uses:b(r),isActive:!1,level:r.level,cardType:r.type}]),u()(a(n))},M=(r,l)=>{R(n,a(n).map(h=>h.id===r?{...h,uses:l}:h)),u()(a(n))},k=r=>{const l=a(n).find(h=>h.id===r);return l?l.uses:0},b=r=>{if(r.uses.type===null)return null;switch(r.uses.type){case"USES":case"LONG_REST":case"DAY":return r.uses.qty??0;case"RELOAD":return Ke.RELOAD_CARD_USES;default:return null}},O=r=>{const l=a(n).find(h=>h.id===r.id);return l?l.isActive:!1};var w=Gt();ue(w,21,()=>e.cards,r=>r.id,(r,l)=>{Rt(r,{get card(){return a(l)},children:(h,I)=>{var H=ee(),Z=B(H);{var L=p=>{var U=It(),K=d(U);{var ae=N=>{var J=Dt(),$=B(J);{var re=f=>{{let y=Y(()=>k(a(l).id)),S=Y(()=>b(a(l))),G=Y(()=>({icon:"ðŸŽ²",title:"Tirar para recargar",onClick:()=>o()(a(l).id),disabled:k(a(l).id)===b(a(l))}));At(f,{get value(){return a(y)},get max(){return a(S)},onChange:ne=>M(a(l).id,Number(ne)),get button(){return a(G)}})}};P($,f=>{b(a(l))!==null&&f(re)})}var se=_($,4);se.__click=[Ut,z,l],m(N,J)},V=N=>{var J=ee(),$=B(J);{var re=f=>{var y=Nt(),S=B(y);S.__click=[Ot,C,l];var G=_(S,4);{var ne=W=>{var Q=ee(),ie=B(Q);{var fe=q=>{var j=qt();j.__click=[Tt,z,l],m(q,j)},me=q=>{var j=Mt();j.__click=[jt,A,l],m(q,j)};P(ie,q=>{O(a(l))?q(fe):q(me,!1)})}m(W,Q)};P(G,W=>{a(l).type==="activable"&&W(ne)})}m(f,y)},se=f=>{var y=Bt(),S=_(B(y),2);S.__click=[Wt,x,l],m(f,y)};P($,f=>{i()==="collection"?f(re):f(se,!1)},!0)}m(N,J)};P(K,N=>{i()==="active"?N(ae):N(V,!1)})}c(U),m(p,U)};P(Z,p=>{t()||p(L)})}m(h,H)},$$slots:{default:!0}})}),c(w),m(v,w),oe()}de(["click"]);const oa=()=>({buildEmptyFilters:()=>({name:"",level:[],tags:[],type:""}),getFiltersFromURL:()=>{const s=T.url.searchParams.get("name")??"",i=T.url.searchParams.getAll("level").filter(n=>n!=="").map(Number).filter(n=>n>0),u=T.url.searchParams.getAll("tags").filter(n=>n!==""),o=T.url.searchParams.get("type")??"";return{name:s,level:i,tags:u,type:o}},updateURLFilters:s=>{s.name?T.url.searchParams.set("name",s.name):T.url.searchParams.delete("name"),s.level.length===0?T.url.searchParams.delete("level"):T.url.searchParams.set("level",s.level.join(",")),s.tags.length===0?T.url.searchParams.delete("tags"):T.url.searchParams.set("tags",s.tags.join(",")),s.type?T.url.searchParams.set("type",s.type):T.url.searchParams.delete("type");const i=T.url.searchParams.toString(),u=`${T.url.pathname}${i?`?${i}`:""}`;Ze(u,{})}}),Le=Ue([]),Se=Ue([]),Ee=async(v,e,t,s)=>{if(tt(t).length>0)return;const u=await(await fetch(Ve(v))).text();let o=[];try{o=He(u)[e]??[]}catch(n){console.error("Error parsing YAML:",n)}t.set(o.map(n=>s(n)).toSorted((n,z)=>n.level-z.level||n.name.localeCompare(z.name)))},ca=()=>({loadAbilityCards:async()=>{await Ee("/docs/cards.yml","cards",Le,$e)},abilityCards:Le,loadItemCards:async()=>{await Ee("/docs/magical-items.yml","items",Se,et)},itemCards:Se}),da=(v,e)=>v.filter(t=>ye(t.name.toLowerCase()).includes(ye(e.name.toLowerCase()))&&(e.level.length===0||e.level.includes(t.level))&&(e.tags.length===0||e.tags.every(s=>t.tags.map(i=>i.toLowerCase()).includes(s)))&&(!e.type||e.type===t.type));export{la as C,At as I,ca as a,va as b,it as c,at as d,lt as e,da as f,oa as u};
