import"./DsnmJJEf.js";import{g as Se,u as Ue,k as we,h as Fe,D as De,b as p,t as O,a as f,s as _,e as d,ad as Pe,r as c,am as de,bc as Ae,ay as Oe,i as a,J as U,aT as be,p as ve,an as Q,d as ce,f as W,c as re}from"./CXLGFl3I.js";import{s as F,d as _e,e as qe}from"./DYVYXqqK.js";import{e as he,r as ke,s as Z,a as Ne,b as Te}from"./BPnaOVD8.js";import{t as Be,b as Le,s as oe,c as Me}from"./BJEA7xJg.js";import{c as je,r as me,g as We,l as Ge}from"./CjlGQt4x.js";import{s as Ee}from"./CwwEG8Ls.js";import{i as D}from"./ta242qJX.js";import{p as R}from"./tM2D1iY6.js";import{C as fe}from"./DBwz8_1j.js";import{h as Ie}from"./BmGkUAMt.js";import{d as Ke}from"./Bx3Ta1aT.js";import{r as Qe}from"./BLuNEerD.js";import{p as P}from"./SLyWnJcv.js";import{r as Je}from"./Bmki0uZW.js";import{w as Ye,g as He}from"./DnpldMJA.js";function Xe(l,e,t){Se(()=>{var r=Ue(()=>e(l,t?.())||{});if(r?.destroy)return()=>r.destroy()})}function pe(l,e={},t,r){for(var s in t){var v=t[s];e[s]!==v&&(t[s]==null?l.style.removeProperty(s):l.style.setProperty(s,v,r))}}function Ce(l,e,t,r){var s=l.__style;if(we||s!==e){var v=Be(e,r);(!we||v!==l.getAttribute("style"))&&(v==null?l.removeAttribute("style"):l.style.cssText=v),l.__style=e}else r&&(Array.isArray(r)?(pe(l,t?.[0],r[0]),pe(l,t?.[1],r[1],"important")):pe(l,t,r));return r}function Ze(l,e,t,r,s){var v=()=>{r(t[l])};t.addEventListener(e,v),s?Fe(()=>{t[l]=s()}):v(),(t===document.body||t===window||t===document)&&De(()=>{t.removeEventListener(e,v)})}var Ve=p('<h2 class="svelte-6qb8f6"> </h2>'),$e=p('<div class="container svelte-6qb8f6"><!> <!></div>');function et(l,e){let t=R(e,"title",3,void 0),r=R(e,"width",3,void 0);var s=$e();let v;var u=d(s);{var o=k=>{var y=Ve(),w=d(y,!0);c(y),O(()=>F(w,t())),f(k,y)};D(u,k=>{t()&&k(o)})}var S=_(u,2);Ee(S,()=>e.children??Pe),c(s),O(k=>v=Ce(s,"",v,k),[()=>({width:r()})]),f(l,s)}const tt=l=>{window.addEventListener("click",e);function e(t){l.contains(t.target)||l.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var at=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],rt=["difference","intersection","symmetricDifference","union"],ze=!1;class se extends Set{#a=new Map;#e=de(0);#t=de(0);#r=Ae||-1;constructor(e){if(super(),e){for(var t of e)super.add(t);this.#t.v=super.size}ze||this.#n()}#s(e){return Ae===this.#r?de(e):Oe(e)}#n(){ze=!0;var e=se.prototype,t=Set.prototype;for(const r of at)e[r]=function(...s){return a(this.#e),t[r].apply(this,s)};for(const r of rt)e[r]=function(...s){a(this.#e);var v=t[r].apply(this,s);return new se(v)}}has(e){var t=super.has(e),r=this.#a,s=r.get(e);if(s===void 0){if(!t)return a(this.#e),!1;s=this.#s(!0),r.set(e,s)}return a(s),t}add(e){return super.has(e)||(super.add(e),U(this.#t,super.size),be(this.#e)),this}delete(e){var t=super.delete(e),r=this.#a,s=r.get(e);return s!==void 0&&(r.delete(e),U(s,!1)),t&&(U(this.#t,super.size),be(this.#e)),t}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var t of e.values())U(t,!1);e.clear(),U(this.#t,0),be(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#t)}}const st=(l,e,t)=>{U(e,new se),t.onChange(Array.from(a(e)))};var nt=(l,e,t)=>e(l.target.checked,a(t).value),it=p('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),lt=p('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function xe(l,e){ve(e,!0);let t=Q(()=>new se(e.value));const r=(A,h)=>{A?a(t).add(h):a(t).delete(h),U(t,new se(a(t))),e.onChange(Array.from(a(t)))};let s=de(!1);const v=()=>{U(s,!1)};var u=lt(),o=d(u),S=d(o);c(o);var k=_(o,2),y=d(k),w=d(y);he(w,21,()=>e.options,A=>A.value,(A,h)=>{var N=it(),b=d(N),n=d(b),i=_(n);ke(i),i.__input=[nt,r,h],c(b),c(N),O(m=>{Z(b,"for",a(h).value),F(n,`${a(h).label??""} `),Z(i,"id",a(h).value),Z(i,"name",a(h).value),Ne(i,a(h).value),Te(i,m)},[()=>a(t).has(a(h).value)]),f(A,N)}),c(w);var q=_(w,2);q.__click=[st,t,e],c(y),c(k),c(u),Xe(u,A=>tt?.(A)),Se(()=>Ze("open","toggle",u,A=>U(s,A),()=>a(s))),O(()=>{F(S,`${e.summary??""} (${a(t).size??""})`),q.disabled=a(t).size===0}),qe("outsideclick",u,v),f(l,u),ce()}_e(["input","click"]);var ot=(l,e,t)=>e.onFiltersChange({...a(t)}),vt=(l,e,t)=>{a(e).type=l.target.value,t.onFiltersChange({...a(e)})},ct=p("<option> </option>"),ut=(l,e)=>e.onResetFilters(),dt=p('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function ta(l,e){ve(e,!0);let t=Q(()=>e.filters);const r=()=>{const u=new Set(e.cards.map(o=>o.level));return Array.from(u).sort((o,S)=>o-S)},s=()=>{const u=new Set(e.cards.flatMap(o=>o.tags));return Array.from(u).sort()},v=()=>{const u=new Set(e.cards.map(o=>o.type));return Array.from(u).sort()};et(l,{children:(u,o)=>{var S=dt(),k=d(S);ke(k),k.__input=[ot,e,t];var y=_(k,2);y.__change=[vt,t,e];var w=d(y);w.value=w.__value="";var q=_(w);he(q,16,v,b=>b,(b,n)=>{var i=ct(),m=d(i,!0);c(i);var V={};O(G=>{F(m,G),V!==(V=n)&&(i.value=(i.__value=n)??"")},[()=>je(n)]),f(b,i)}),c(y);var A=_(y,2);{let b=Q(()=>r().map(n=>({value:n,label:`Nivel ${n}`})));xe(A,{summary:"Niveles",get options(){return a(b)},get value(){return a(t).level},onChange:n=>{a(t).level=n,e.onFiltersChange({...a(t)})}})}var h=_(A,2);{let b=Q(()=>s().map(n=>({value:n.toLowerCase(),label:n})));xe(h,{summary:"Etiquetas",get options(){return a(b)},get value(){return a(t).tags},onChange:n=>{a(t).tags=n.map(i=>i.toLowerCase()),e.onFiltersChange({...a(t)})}})}var N=_(h,2);N.__click=[ut,e],c(S),Le(k,()=>a(t).name,b=>a(t).name=b),f(u,S)},$$slots:{default:!0}}),ce()}_e(["input","change","click"]);var ft=p("<label> </label>"),mt=(l,e,t,r)=>{e.max!==void 0&&typeof a(t)=="number"&&U(t,Math.min(a(t),e.max)),r()(a(t))},_t=p('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),ht=p('<button class="button svelte-1r47u3b"> </button>'),gt=p("<div><!> <span><input/> <!> <!></span></div>");function bt(l,e){ve(e,!0);let t=R(e,"label",3,void 0),r=R(e,"labelWidth",3,"normalized"),s=R(e,"readonly",3,!1),v=R(e,"onChange",3,()=>{}),u=R(e,"button",3,void 0),o=R(e,"fullWidth",3,!1),S=R(e,"placeholder",3,""),k=R(e,"textAlign",3,"center"),y=Q(()=>e.value);var w=gt();let q;var A=d(w);{var h=z=>{var C=ft(),L=d(C,!0);c(C),O(()=>{oe(C,1,Me(r()),"svelte-1r47u3b"),F(L,t())}),f(z,C)};D(A,z=>{t()&&z(h)})}var N=_(A,2);let b;var n=d(N);ke(n);let i;Z(n,"min",0),n.__input=[mt,e,y,v];var m=_(n,2);{var V=z=>{var C=_t(),L=_(W(C),2);let M;var ae=d(L,!0);c(L),O(ne=>{M=oe(L,1,"max svelte-1r47u3b",null,M,ne),F(ae,e.max)},[()=>({withButton:u()!==void 0})]),f(z,C)};D(m,z=>{e.max!==void 0&&z(V)})}var G=_(m,2);{var te=z=>{var C=ht();C.__click=function(...M){u().onClick?.apply(this,M)};var L=d(C,!0);c(C),O(()=>{Z(C,"title",u().title),C.disabled=u().disabled,F(L,u().icon)}),f(z,C)};D(G,z=>{u()&&z(te)})}c(N),c(w),O((z,C,L)=>{q=oe(w,1,"fieldgroup svelte-1r47u3b",null,q,z),b=oe(N,1,"field svelte-1r47u3b",null,b,C),Z(n,"type",typeof e.value=="number"?"number":"text"),n.disabled=s(),i=oe(n,1,`text-align-${k()}`,"svelte-1r47u3b",i,L),Z(n,"max",e.max),Z(n,"placeholder",S())},[()=>({fullWidth:o()}),()=>({inputAlone:e.max===void 0&&u()===void 0&&!o(),inputWithButton:u()!==void 0,fullWidth:o(),readonly:s()}),()=>({alone:e.max===void 0&&u()===void 0,fullWidth:o(),withButton:u()!==void 0,withButtonAndMax:e.max!==void 0&&u()!==void 0})]),Le(n,()=>a(y),z=>U(y,z)),f(l,w),ce()}_e(["input","click"]);var pt=p('<span class="chip svelte-6vztta"> </span>'),yt=p('<span class="chip svelte-6vztta"> </span>'),Ct=p('<span class="chip svelte-6vztta"> </span>'),kt=p('<span class="chip svelte-6vztta"> </span>'),wt=p('<div class="controls svelte-6vztta"><!></div>'),At=p('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function zt(l,e){ve(e,!0);let t=R(e,"children",3,void 0);const r=g=>{switch(me(g.length>0?String(g[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}},s=g=>{let x=me(g.length>0?String(g[0]).toLowerCase():"");return fe.CARD_BACKGROUNDS[x]?fe.CARD_BACKGROUNDS[x]:fe.CARD_BACKGROUNDS.default};var v=At();let u;var o=d(v);let S;var k=_(o,2),y=d(k),w=d(y),q=d(w),A=d(q);c(q);var h=_(q,2),N=d(h,!0);c(h),c(w);var b=_(w,2),n=d(b,!0);c(b),c(y);var i=_(y,2),m=d(i),V=d(m);Ie(V,()=>Ke.parse(e.card.description)),c(m);var G=_(m,2),te=d(G);he(te,16,()=>e.card.tags,g=>g,(g,x)=>{var T=pt(),E=d(T,!0);c(T),O(()=>F(E,x)),f(g,T)});var z=_(te,2);{var C=g=>{var x=re(),T=W(x);{var E=B=>{var j=yt(),ee=d(j);c(j),O(()=>F(ee,`Usos: ${e.card.uses.qty??"?"??""} por dÃ­a de descanso`)),f(B,j)},I=B=>{var j=re(),ee=W(j);{var ie=Y=>{var H=Ct(),le=d(H);c(H),O(()=>F(le,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),f(Y,H)},ue=Y=>{var H=re(),le=W(H);{var X=K=>{var ge=kt(),Re=d(ge);c(ge),O(()=>F(Re,`Usos: ${e.card.uses.qty??"?"??""}`)),f(K,ge)};D(le,K=>{e.card.uses.type==="USES"&&K(X)},!0)}f(Y,H)};D(ee,Y=>{e.card.uses.type==="RELOAD"?Y(ie):Y(ue,!1)},!0)}f(B,j)};D(T,B=>{e.card.uses.type==="LONG_REST"?B(E):B(I,!1)})}f(g,x)};D(z,g=>{e.card.uses.type&&g(C)})}c(G),c(i);var L=_(i,2),M=_(d(L),2),ae=d(M),ne=d(ae,!0);c(ae),c(M);var J=_(M,2);{var $=g=>{var x=wt(),T=d(x);Ee(T,t),c(x),f(g,x)};D(J,g=>{t()!==void 0&&g($)})}c(L),c(k),c(v),O((g,x,T,E)=>{u=Ce(v,"",u,g),S=Ce(o,"",S,x),F(A,`Nivel ${e.card.level??""}`),F(N,T),F(n,e.card.name),F(ne,E)},[()=>({"border-color":r(e.card.tags)}),()=>({"background-image":`url(${s(e.card.tags)})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"â"]),f(l,v),ce()}var xt=(l,e,t)=>e(a(t).id),St=p('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Lt=(l,e,t)=>e(a(t).id),Et=(l,e,t)=>e(a(t).id),Rt=p("<button>Desactivar</button>"),Ut=(l,e,t)=>e(a(t).id),Ft=p("<button>Activar</button>"),Dt=p('<button>Quitar</button> <span class="spacer"></span> <!>',1),Pt=(l,e,t)=>e(a(t)),Ot=p('<span class="spacer"></span> <button>Agregar</button>',1),qt=p('<div class="controls svelte-1rfcjb3"><!></div>'),Nt=p('<div class="cards svelte-1rfcjb3"></div>');function aa(l,e){ve(e,!0);let t=R(e,"readonly",3,!0),r=R(e,"characterCards",19,()=>[]),s=R(e,"listMode",3,"all"),v=R(e,"onChange",3,()=>{}),u=R(e,"onCardReloadClick",3,()=>{}),o=Q(r);const S=n=>{const i=e.cards.find(m=>m.id===n);if(!i){y(n);return}U(o,a(o).map(m=>m.id===n?{...m,isActive:!1,uses:h(i)}:m)),v()(a(o))},k=n=>{U(o,a(o).map(i=>i.id===n?{...i,isActive:!0}:i)),v()(a(o))},y=n=>{U(o,a(o).filter(i=>i.id!==n)),v()(a(o))},w=n=>{U(o,[...a(o),{id:n.id,uses:h(n),isActive:!1,level:n.level}]),v()(a(o))},q=(n,i)=>{U(o,a(o).map(m=>m.id===n?{...m,uses:i}:m)),v()(a(o))},A=n=>{const i=a(o).find(m=>m.id===n);return i?i.uses:0},h=n=>{if(n.uses.type===null)return null;switch(n.uses.type){case"USES":case"LONG_REST":return n.uses.qty??0;case"RELOAD":return fe.RELOAD_CARD_USES;default:return null}},N=n=>{const i=a(o).find(m=>m.id===n.id);return i?i.isActive:!1};var b=Nt();he(b,21,()=>e.cards,n=>n.id,(n,i)=>{zt(n,{get card(){return a(i)},children:(m,V)=>{var G=re(),te=W(G);{var z=C=>{var L=qt(),M=d(L);{var ae=J=>{var $=St(),g=W($);{var x=E=>{{let I=Q(()=>A(a(i).id)),B=Q(()=>h(a(i))),j=Q(()=>({icon:"ð²",title:"Tirar para recargar",onClick:()=>u()(a(i).id),disabled:A(a(i).id)===h(a(i))}));bt(E,{get value(){return a(I)},get max(){return a(B)},onChange:ee=>q(a(i).id,Number(ee)),get button(){return a(j)}})}};D(g,E=>{h(a(i))!==null&&E(x)})}var T=_(g,4);T.__click=[xt,S,i],f(J,$)},ne=J=>{var $=re(),g=W($);{var x=E=>{var I=Dt(),B=W(I);B.__click=[Lt,y,i];var j=_(B,4);{var ee=ie=>{var ue=re(),Y=W(ue);{var H=X=>{var K=Rt();K.__click=[Et,S,i],f(X,K)},le=X=>{var K=Ft();K.__click=[Ut,k,i],f(X,K)};D(Y,X=>{N(a(i))?X(H):X(le,!1)})}f(ie,ue)};D(j,ie=>{a(i).type==="activable"&&ie(ee)})}f(E,I)},T=E=>{var I=Ot(),B=_(W(I),2);B.__click=[Pt,w,i],f(E,I)};D(g,E=>{s()==="collection"?E(x):E(T,!1)},!0)}f(J,$)};D(M,J=>{s()==="active"?J(ae):J(ne,!1)})}c(L),f(C,L)};D(te,C=>{t()||C(z)})}f(m,G)},$$slots:{default:!0}})}),c(b),f(l,b),ce()}_e(["click"]);const ra=()=>({buildEmptyFilters:()=>({name:"",level:[],tags:[],type:""}),getFiltersFromURL:()=>{const r=P.url.searchParams.get("name")??"",s=P.url.searchParams.getAll("level").filter(o=>o!=="").map(Number).filter(o=>o>0),v=P.url.searchParams.getAll("tags").filter(o=>o!==""),u=P.url.searchParams.get("type")??"";return{name:r,level:s,tags:v,type:u}},updateURLFilters:r=>{r.name?P.url.searchParams.set("name",r.name):P.url.searchParams.delete("name"),r.level.length===0?P.url.searchParams.delete("level"):P.url.searchParams.set("level",r.level.join(",")),r.tags.length===0?P.url.searchParams.delete("tags"):P.url.searchParams.set("tags",r.tags.join(",")),r.type?P.url.searchParams.set("type",r.type):P.url.searchParams.delete("type");const s=P.url.searchParams.toString(),v=`${P.url.pathname}${s?`?${s}`:""}`;Qe(v,{})}}),Tt=l=>{if(!l.name)throw new Error("Card name is required");return{id:We(l.name),...l}},ye=Ye([]),sa=()=>({loadCards:async()=>{if(He(ye).length>0)return;const t=await(await fetch(Je("/docs/cards.yml"))).text();let r=[];try{r=Ge(t).cards??[]}catch(s){console.error("Error parsing YAML:",s)}ye.set(r.map(s=>Tt(s)).toSorted((s,v)=>s.level-v.level||s.name.localeCompare(v.name)))},cards:ye}),na=(l,e)=>l.filter(t=>me(t.name.toLowerCase()).includes(me(e.name.toLowerCase()))&&(e.level.length===0||e.level.includes(t.level))&&(e.tags.length===0||e.tags.every(r=>t.tags.map(s=>s.toLowerCase()).includes(r)))&&(!e.type||e.type===t.type));export{ta as C,bt as I,sa as a,aa as b,et as c,na as f,ra as u};
