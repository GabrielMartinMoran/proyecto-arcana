import"./DsnmJJEf.js";import{v as Se,D as Re,h as Ae,a8 as De,z as Ue,f as k,aT as Ee,t as T,b as h,s as p,d as c,ai as Oe,r as o,e as O,aG as de,aV as we,ar as qe,H as t,O as L,aW as be,aa as me,p as oe,ab as Y,aP as Ne,c as ce,a as K,aN as re}from"./Kn-3yCMi.js";import{e as he,r as ke,s as $,a as Fe,b as Te,C as fe}from"./DoQYgQHR.js";import{t as Be,b as Le,s as ve,c as Me}from"./WpMs7pcV.js";import{r as We}from"./D9NnwYvQ.js";import{p as F}from"./BO6xIS95.js";import{r as _e,c as je,g as Ge,l as Ie}from"./CjlGQt4x.js";import{i as q}from"./XhFqZ_PR.js";import{p as R}from"./C2rRscMh.js";import{h as Ke}from"./DlV9slla.js";import{d as Qe}from"./Bx3Ta1aT.js";import{r as He}from"./CCtmJEK4.js";import{w as Ye,g as Je}from"./C2b8wWAA.js";function Xe(s,e,a){Se(()=>{var i=Re(()=>e(s,a?.())||{});if(i?.destroy)return()=>i.destroy()})}function pe(s,e={},a,i){for(var l in a){var r=a[l];e[l]!==r&&(a[l]==null?s.style.removeProperty(l):s.style.setProperty(l,r,i))}}function Ce(s,e,a,i){var l=s.__style;if(Ae||l!==e){var r=Be(e,i);(!Ae||r!==s.getAttribute("style"))&&(r==null?s.removeAttribute("style"):s.style.cssText=r),s.__style=e}else i&&(Array.isArray(i)?(pe(s,a?.[0],i[0]),pe(s,a?.[1],i[1],"important")):pe(s,a,i));return i}function Ze(s,e,a,i,l){var r=()=>{i(a[s])};a.addEventListener(e,r),l?De(()=>{a[s]=l()}):r(),(a===document.body||a===window||a===document)&&Ue(()=>{a.removeEventListener(e,r)})}var Ve=k('<h2 class="svelte-6qb8f6"> </h2>'),$e=k('<div class="container svelte-6qb8f6"><!> <!></div>');function et(s,e){let a=R(e,"title",3,void 0),i=R(e,"width",3,void 0);var l=$e();let r;var f=c(l);{var d=E=>{var _=Ve(),u=c(_,!0);o(_),T(()=>O(u,a())),h(E,_)};q(f,E=>{a()&&E(d)})}var B=p(f,2);Ee(B,()=>e.children??Oe),o(l),T(E=>r=Ce(l,"",r,E),[()=>({width:i()})]),h(s,l)}const tt=s=>{window.addEventListener("click",e);function e(a){s.contains(a.target)||s.dispatchEvent(new CustomEvent("outsideclick"))}return{destroy(){window.removeEventListener("click",e)}}};var at=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],rt=["difference","intersection","symmetricDifference","union"],ze=!1;class se extends Set{#a=new Map;#e=de(0);#t=de(0);#r=we||-1;constructor(e){if(super(),e){for(var a of e)super.add(a);this.#t.v=super.size}ze||this.#n()}#s(e){return we===this.#r?de(e):qe(e)}#n(){ze=!0;var e=se.prototype,a=Set.prototype;for(const i of at)e[i]=function(...l){return t(this.#e),a[i].apply(this,l)};for(const i of rt)e[i]=function(...l){t(this.#e);var r=a[i].apply(this,l);return new se(r)}}has(e){var a=super.has(e),i=this.#a,l=i.get(e);if(l===void 0){if(!a)return t(this.#e),!1;l=this.#s(!0),i.set(e,l)}return t(l),a}add(e){return super.has(e)||(super.add(e),L(this.#t,super.size),be(this.#e)),this}delete(e){var a=super.delete(e),i=this.#a,l=i.get(e);return l!==void 0&&(i.delete(e),L(l,!1)),a&&(L(this.#t,super.size),be(this.#e)),a}clear(){if(super.size!==0){super.clear();var e=this.#a;for(var a of e.values())L(a,!1);e.clear(),L(this.#t,0),be(this.#e)}}keys(){return this.values()}values(){return t(this.#e),super.values()}entries(){return t(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return t(this.#t)}}const st=(s,e,a)=>{L(e,new se),a.onChange(Array.from(t(e)))};var nt=(s,e,a)=>e(s.target.checked,t(a).value),it=k('<li class="svelte-1d1gkms"><label class="svelte-1d1gkms"> <input type="checkbox" class="svelte-1d1gkms"/></label></li>'),lt=k('<details class="svelte-1d1gkms"><summary class="svelte-1d1gkms"> </summary> <form class="svelte-1d1gkms"><fieldset class="svelte-1d1gkms"><ul class="svelte-1d1gkms"></ul> <button class="clear-btn svelte-1d1gkms">Limpiar</button></fieldset></form></details>');function xe(s,e){oe(e,!0);let a=Y(()=>new se(e.value));const i=(y,m)=>{y?t(a).add(m):t(a).delete(m),L(a,new se(t(a))),e.onChange(Array.from(t(a)))};let l=de(!1);const r=()=>{L(l,!1)};var f=lt(),d=c(f),B=c(d);o(d);var E=p(d,2),_=c(E),u=c(_);he(u,21,()=>e.options,y=>y.value,(y,m)=>{var D=it(),U=c(D),v=c(U),n=p(v);ke(n),n.__input=[nt,i,m],o(U),o(D),T(g=>{$(U,"for",t(m).value),O(v,`${t(m).label??""} `),$(n,"id",t(m).value),$(n,"name",t(m).value),Fe(n,t(m).value),Te(n,g)},[()=>t(a).has(t(m).value)]),h(y,D)}),o(u);var A=p(u,2);A.__click=[st,a,e],o(_),o(E),o(f),Xe(f,y=>tt?.(y)),Se(()=>Ze("open","toggle",f,y=>L(l,y),()=>t(l))),T(()=>{O(B,`${e.summary??""} (${t(a).size??""})`),A.disabled=t(a).size===0}),Ne("outsideclick",f,r),h(s,f),ce()}me(["input","click"]);const vt=(s,e,a,i)=>{L(e,a()),i()};var ot=(s,e)=>e(),ct=(s,e,a)=>{t(e).type=s.target.value,a()},ut=k("<option> </option>"),dt=k('<div class="filters svelte-1o8sb8t"><input type="text" placeholder="Buscar por nombre" class="svelte-1o8sb8t"/> <select class="svelte-1o8sb8t"><option>Todos los Tipos</option><!></select> <!> <!> <button>Limpiar Filtros</button></div>');function Vt(s,e){oe(e,!0);const a=()=>({name:"",level:[],tags:[],type:""}),i=()=>{const _=F.url.searchParams.get("name")??"",u=F.url.searchParams.getAll("level").filter(m=>m!=="").map(Number).filter(m=>m>0),A=F.url.searchParams.getAll("tags").filter(m=>m!==""),y=F.url.searchParams.get("type")??"";return{name:_,level:u,tags:A,type:y}},l=()=>{t(r).name?F.url.searchParams.set("name",t(r).name):F.url.searchParams.delete("name"),t(r).level.length===0?F.url.searchParams.delete("level"):F.url.searchParams.set("level",t(r).level.join(",")),t(r).tags.length===0?F.url.searchParams.delete("tags"):F.url.searchParams.set("tags",t(r).tags.join(",")),t(r).type?F.url.searchParams.set("type",t(r).type):F.url.searchParams.delete("type");const _=F.url.searchParams.toString(),u=`${F.url.pathname}${_?`?${_}`:""}`;We(u,{})};let r=Y(i);const f=()=>{const _=e.cards.filter(u=>_e(u.name.toLowerCase()).includes(_e(t(r).name.toLowerCase()))&&(t(r).level.length===0||t(r).level.includes(u.level))&&(t(r).tags.length===0||t(r).tags.every(A=>u.tags.includes(A)))&&(!t(r).type||t(r).type===u.type));e.onFilter(_),l()},d=()=>{const _=new Set(e.cards.map(u=>u.level));return Array.from(_).sort((u,A)=>u-A)},B=()=>{const _=new Set(e.cards.flatMap(u=>u.tags));return Array.from(_).sort()},E=()=>{const _=new Set(e.cards.map(u=>u.type));return Array.from(_).sort()};et(s,{children:(_,u)=>{var A=dt(),y=c(A);ke(y),y.__input=[ot,f];var m=p(y,2);m.__change=[ct,r,f];var D=c(m);D.value=D.__value="";var U=p(D);he(U,16,E,N=>N,(N,w)=>{var j=ut(),z=c(j,!0);o(j);var b={};T(x=>{O(z,x),b!==(b=w)&&(j.value=(j.__value=w)??"")},[()=>je(w)]),h(N,j)}),o(m);var v=p(m,2);{let N=Y(()=>d().map(w=>({value:w,label:`Nivel ${w}`})));xe(v,{summary:"Niveles",get options(){return t(N)},get value(){return t(r).level},onChange:w=>{t(r).level=w,f()}})}var n=p(v,2);{let N=Y(()=>B().map(w=>({value:w,label:w})));xe(n,{summary:"Etiquetas",get options(){return t(N)},get value(){return t(r).tags},onChange:w=>{t(r).tags=w,f()}})}var g=p(n,2);g.__click=[vt,r,a,f],o(A),Le(y,()=>t(r).name,N=>t(r).name=N),h(_,A)},$$slots:{default:!0}}),ce()}me(["input","change","click"]);var ft=k("<label> </label>"),_t=(s,e,a,i)=>{e.max!==void 0&&typeof t(a)=="number"&&L(a,Math.min(t(a),e.max)),i()(t(a))},mt=k('<span class="divider svelte-1r47u3b">/</span> <span> </span>',1),ht=k('<button class="button svelte-1r47u3b"> </button>'),gt=k("<div><!> <span><input/> <!> <!></span></div>");function bt(s,e){oe(e,!0);let a=R(e,"label",3,void 0),i=R(e,"labelWidth",3,"normalized"),l=R(e,"readonly",3,!1),r=R(e,"onChange",3,()=>{}),f=R(e,"button",3,void 0),d=R(e,"fullWidth",3,!1),B=R(e,"placeholder",3,""),E=R(e,"textAlign",3,"center"),_=Y(()=>e.value);var u=gt();let A;var y=c(u);{var m=z=>{var b=ft(),x=c(b,!0);o(b),T(()=>{ve(b,1,Me(i()),"svelte-1r47u3b"),O(x,a())}),h(z,b)};q(y,z=>{a()&&z(m)})}var D=p(y,2);let U;var v=c(D);ke(v);let n;$(v,"min",0),v.__input=[_t,e,_,r];var g=p(v,2);{var N=z=>{var b=mt(),x=p(K(b),2);let G;var ae=c(x,!0);o(x),T(ne=>{G=ve(x,1,"max svelte-1r47u3b",null,G,ne),O(ae,e.max)},[()=>({withButton:f()!==void 0})]),h(z,b)};q(g,z=>{e.max!==void 0&&z(N)})}var w=p(g,2);{var j=z=>{var b=ht();b.__click=function(...G){f().onClick?.apply(this,G)};var x=c(b,!0);o(b),T(()=>{$(b,"title",f().title),b.disabled=f().disabled,O(x,f().icon)}),h(z,b)};q(w,z=>{f()&&z(j)})}o(D),o(u),T((z,b,x)=>{A=ve(u,1,"fieldgroup svelte-1r47u3b",null,A,z),U=ve(D,1,"field svelte-1r47u3b",null,U,b),$(v,"type",typeof e.value=="number"?"number":"text"),v.disabled=l(),n=ve(v,1,`text-align-${E()}`,"svelte-1r47u3b",n,x),$(v,"max",e.max),$(v,"placeholder",B())},[()=>({fullWidth:d()}),()=>({inputAlone:e.max===void 0&&f()===void 0&&!d(),inputWithButton:f()!==void 0,fullWidth:d(),readonly:l()}),()=>({alone:e.max===void 0&&f()===void 0,fullWidth:d(),withButton:f()!==void 0,withButtonAndMax:e.max!==void 0&&f()!==void 0})]),Le(v,()=>t(_),z=>L(_,z)),h(s,u),ce()}me(["input","click"]);var pt=k('<span class="chip svelte-6vztta"> </span>'),yt=k('<span class="chip svelte-6vztta"> </span>'),Ct=k('<span class="chip svelte-6vztta"> </span>'),kt=k('<span class="chip svelte-6vztta"> </span>'),At=k('<div class="controls svelte-6vztta"><!></div>'),wt=k('<div class="card svelte-6vztta"><div class="bg svelte-6vztta"></div> <div class="inner svelte-6vztta"><div class="header svelte-6vztta"><div class="chips svelte-6vztta"><span class="chip svelte-6vztta"> </span> <span class="chip svelte-6vztta"> </span></div> <h3 class="svelte-6vztta"> </h3></div> <div class="body svelte-6vztta"><span class="description svelte-6vztta"><!></span> <div class="tags svelte-6vztta"><!> <!></div></div> <div class="footer svelte-6vztta"><span class="requirements svelte-6vztta">REQUERIMIENTOS</span> <div class="requirements-list svelte-6vztta"><span> </span></div> <!></div></div></div>');function zt(s,e){oe(e,!0);let a=R(e,"children",3,void 0);const i=C=>{switch(_e(C.length>0?String(C[0]).toLowerCase():"")){case"arcanista":return"var(--accent-arcanista)";case"combatiente":return"var(--accent-combatiente)";case"picaro":return"var(--accent-picaro)";case"druida":return"var(--accent-druida)";case"sacerdote":return"var(--accent-sacerdote)";case"bardo":return"var(--accent-bardo)";case"dote":return"var(--accent-dote)";case"linaje":return"var(--accent-linaje)";default:return"var(--accent-default)"}},l=C=>{let S=_e(C.length>0?String(C[0]).toLowerCase():"");return fe.CARD_BACKGROUNDS[S]?fe.CARD_BACKGROUNDS[S]:fe.CARD_BACKGROUNDS.default};var r=wt();let f;var d=c(r);let B;var E=p(d,2),_=c(E),u=c(_),A=c(u),y=c(A);o(A);var m=p(A,2),D=c(m,!0);o(m),o(u);var U=p(u,2),v=c(U,!0);o(U),o(_);var n=p(_,2),g=c(n),N=c(g);Ke(N,()=>Qe.parse(e.card.description)),o(g);var w=p(g,2),j=c(w);he(j,16,()=>e.card.tags,C=>C,(C,S)=>{var M=pt(),P=c(M,!0);o(M),T(()=>O(P,S)),h(C,M)});var z=p(j,2);{var b=C=>{var S=re(),M=K(S);{var P=W=>{var I=yt(),te=c(I);o(I),T(()=>O(te,`Usos: ${e.card.uses.qty??"?"??""} por día de descanso`)),h(W,I)},Q=W=>{var I=re(),te=K(I);{var ie=X=>{var Z=Ct(),le=c(Z);o(Z),T(()=>O(le,`Usos: 1 (Recarga ${e.card.uses.qty??"?"??""}+)`)),h(X,Z)},ue=X=>{var Z=re(),le=K(Z);{var V=H=>{var ge=kt(),Pe=c(ge);o(ge),T(()=>O(Pe,`Usos: ${e.card.uses.qty??"?"??""}`)),h(H,ge)};q(le,H=>{e.card.uses.type==="USES"&&H(V)},!0)}h(X,Z)};q(te,X=>{e.card.uses.type==="RELOAD"?X(ie):X(ue,!1)},!0)}h(W,I)};q(M,W=>{e.card.uses.type==="LONG_REST"?W(P):W(Q,!1)})}h(C,S)};q(z,C=>{e.card.uses.type&&C(b)})}o(w),o(n);var x=p(n,2),G=p(c(x),2),ae=c(G),ne=c(ae,!0);o(ae),o(G);var J=p(G,2);{var ee=C=>{var S=At(),M=c(S);Ee(M,a),o(S),h(C,S)};q(J,C=>{a()!==void 0&&C(ee)})}o(x),o(E),o(r),T((C,S,M,P)=>{f=Ce(r,"",f,C),B=Ce(d,"",B,S),O(y,`Nivel ${e.card.level??""}`),O(D,M),O(v,e.card.name),O(ne,P)},[()=>({"border-color":i(e.card.tags)}),()=>({"background-image":`url(${l(e.card.tags)})`}),()=>e.card.type.charAt(0).toUpperCase()+e.card.type.slice(1),()=>e.card.requirements.length>0?e.card.requirements.join(", "):"—"]),h(s,r),ce()}var xt=(s,e,a)=>e(t(a).id),St=k('<!> <span class="spacer"></span> <button>Desactivar</button>',1),Et=(s,e,a)=>e(t(a).id),Lt=(s,e,a)=>e(t(a).id),Pt=k("<button>Desactivar</button>"),Rt=(s,e,a)=>e(t(a).id),Dt=k("<button>Activar</button>"),Ut=k('<button>Quitar</button> <span class="spacer"></span> <!>',1),Ot=(s,e,a)=>e(t(a)),qt=k('<span class="spacer"></span> <button>Agregar</button>',1),Nt=k('<div class="controls svelte-1rfcjb3"><!></div>'),Ft=k('<div class="cards svelte-1rfcjb3"></div>');function $t(s,e){oe(e,!0);let a=R(e,"readonly",3,!0),i=R(e,"characterCards",19,()=>[]),l=R(e,"listMode",3,"all"),r=R(e,"onChange",3,()=>{}),f=R(e,"onCardReloadClick",3,()=>{}),d=Y(i);const B=v=>{const n=e.cards.find(g=>g.id===v);if(!n){_(v);return}L(d,t(d).map(g=>g.id===v?{...g,isActive:!1,uses:m(n)}:g)),r()(t(d))},E=v=>{L(d,t(d).map(n=>n.id===v?{...n,isActive:!0}:n)),r()(t(d))},_=v=>{L(d,t(d).filter(n=>n.id!==v)),r()(t(d))},u=v=>{L(d,[...t(d),{id:v.id,uses:m(v),isActive:!1,level:v.level}]),r()(t(d))},A=(v,n)=>{L(d,t(d).map(g=>g.id===v?{...g,uses:n}:g)),r()(t(d))},y=v=>{const n=t(d).find(g=>g.id===v);return n?n.uses:0},m=v=>{if(v.uses.type===null)return null;switch(v.uses.type){case"USES":case"LONG_REST":return v.uses.qty??0;case"RELOAD":return fe.RELOAD_CARD_USES;default:return null}},D=v=>{const n=t(d).find(g=>g.id===v.id);return n?n.isActive:!1};var U=Ft();he(U,21,()=>e.cards,v=>v.id,(v,n)=>{zt(v,{get card(){return t(n)},children:(g,N)=>{var w=re(),j=K(w);{var z=b=>{var x=Nt(),G=c(x);{var ae=J=>{var ee=St(),C=K(ee);{var S=P=>{{let Q=Y(()=>y(t(n).id)),W=Y(()=>m(t(n))),I=Y(()=>({icon:"🎲",title:"Tirar para recargar",onClick:()=>f()(t(n).id),disabled:y(t(n).id)===m(t(n))}));bt(P,{get value(){return t(Q)},get max(){return t(W)},onChange:te=>A(t(n).id,Number(te)),get button(){return t(I)}})}};q(C,P=>{m(t(n))!==null&&P(S)})}var M=p(C,4);M.__click=[xt,B,n],h(J,ee)},ne=J=>{var ee=re(),C=K(ee);{var S=P=>{var Q=Ut(),W=K(Q);W.__click=[Et,_,n];var I=p(W,4);{var te=ie=>{var ue=re(),X=K(ue);{var Z=V=>{var H=Pt();H.__click=[Lt,B,n],h(V,H)},le=V=>{var H=Dt();H.__click=[Rt,E,n],h(V,H)};q(X,V=>{D(t(n))?V(Z):V(le,!1)})}h(ie,ue)};q(I,ie=>{t(n).type==="activable"&&ie(te)})}h(P,Q)},M=P=>{var Q=qt(),W=p(K(Q),2);W.__click=[Ot,u,n],h(P,Q)};q(C,P=>{l()==="collection"?P(S):P(M,!1)},!0)}h(J,ee)};q(G,J=>{l()==="active"?J(ae):J(ne,!1)})}o(x),h(b,x)};q(j,b=>{a()||b(z)})}h(g,w)},$$slots:{default:!0}})}),o(U),h(s,U),ce()}me(["click"]);const Tt=s=>{if(!s.name)throw new Error("Card name is required");return{id:Ge(s.name),...s}},ye=Ye([]),ea=()=>({loadCards:async()=>{if(Je(ye).length>0)return;const a=await(await fetch(He("/docs/cards.yml"))).text();let i=[];try{i=Ie(a).cards??[]}catch(l){console.error("Error parsing YAML:",l)}ye.set(i.map(l=>Tt(l)))},cards:ye});export{Vt as C,bt as I,$t as a,et as b,ea as u};
