import"../chunks/DsnmJJEf.js";import"../chunks/BZPDMRZD.js";import{o as St}from"../chunks/Eew5uVUK.js";import{p as Y,b,e as a,r as e,s as r,t as E,a as m,d as G,i as g}from"../chunks/DYbDzwUz.js";import{e as C}from"../chunks/BcxGJwjK.js";import{i as jt}from"../chunks/1BU-U8cA.js";import{i as S,s as Dt,a as It}from"../chunks/Cc_HksML.js";import{s as v,d as Tt}from"../chunks/Bv3eHQs5.js";import{s as ut}from"../chunks/Coc7tNCi.js";import{a as Ft,p as Ht}from"../chunks/CdP0W2Yj.js";import{c as Lt,g as Nt,l as Pt}from"../chunks/CjlGQt4x.js";import{r as Bt}from"../chunks/B6zkWroc.js";import{w as Ut,g as Vt}from"../chunks/Dxiokm-6.js";var Yt=b('<div class="action"><strong> </strong> <span> </span></div>');function dt(s,t){Y(t,!0);var u=Yt(),f=a(u),p=a(f);e(f);var x=r(f,2),A=a(x,!0);e(x),e(u),E(()=>{v(p,`${t.action.name??""}
		${t.action.uses?`(${t.action.uses.type=="USES"?`${t.action.uses.qty} ${t.action.uses.qty===1?"uso":"usos"}`:`Recarga ${t.action.uses.qty}+`})`:""}:`),v(A,t.action.detail)}),m(s,u),G()}var Gt=(s,t,u)=>t(`1d6e+${u}`,Lt(u)),Jt=b('<div class="attribute svelte-2zpvir"><strong> </strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div>'),Kt=(s,t)=>t("1d6e+reflejos","Iniciativa"),Ot=b("<li><strong> </strong> <span> </span></li>"),Qt=b('<div class="traits"><strong>Rasgos</strong> <ul></ul></div>'),Wt=(s,t,u)=>t(g(u)),Xt=(s,t,u)=>t(g(u)),Zt=b('<li><strong> </strong> <span><button class="svelte-2zpvir"> </button> <button class="svelte-2zpvir"> </button> </span></li>'),$t=b('<div class="attacks svelte-2zpvir"><strong>Ataques</strong> <ul></ul></div>'),te=b("<li><!></li>"),ee=b('<div class="actions"><strong>Acciones</strong> <ul></ul></div>'),ae=b("<li><!></li>"),re=b('<div class="actions"><strong>Reacciones</strong> <ul></ul></div>'),se=b('<div class="statblock svelte-2zpvir"><div class="bg svelte-2zpvir"></div> <div class="data svelte-2zpvir"><div class="header svelte-2zpvir"><h2> </h2> <span><strong>NA</strong> <span> </span></span></div> <div class="attributes svelte-2zpvir"></div> <div class="stats svelte-2zpvir"><div class="attribute svelte-2zpvir"><strong>Salud</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Esquiva</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Física</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Mágica</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Velocidad</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Iniciativa</strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div></div> <div class="middle svelte-2zpvir"><div class="left svelte-2zpvir"><div class="languages"><strong>Lenguas</strong> <span> </span></div> <!> <!> <!> <!> <div class="behavior"><strong>Comportamiento:</strong> <span> </span></div></div> <div class="right svelte-2zpvir"><img class="svelte-2zpvir"/></div></div></div></div>');function ie(s,t){Y(t,!0);const u={body:"Cuerpo",reflexes:"Reflejos",mind:"Mente",instinct:"Instinto",presence:"Presencia"};let{rollModal:f,rollExpression:p}=Ft();const x=(i,n)=>{f.openRollModal({expression:i,variables:{cuerpo:t.creature.attributes.body,reflejos:t.creature.attributes.reflexes,mente:t.creature.attributes.mind,instinto:t.creature.attributes.instinct,presencia:t.creature.attributes.presence,iniciativa:t.creature.attributes.reflexes},title:`${t.creature.name}: ${n}`})},A=i=>{x(`1d6e+${i.bonus}`,`Ataca con ${i.name}`)},w=i=>{const n=Ht(i.damage);p({expression:n,title:`${t.creature.name}: Daño de ${i.name}`})};var z=se(),M=r(a(z),2),k=a(M),j=a(k),_t=a(j,!0);e(j);var J=r(j,2),K=r(a(J),2),gt=a(K,!0);e(K),e(J),e(k);var D=r(k,2);C(D,20,()=>["body","reflexes","mind","instinct","presence"],i=>i,(i,n)=>{var d=Jt(),o=a(d),c=a(o,!0);e(o);var l=r(o,2),_=a(l),q=a(_,!0);e(_);var h=r(_,2);h.__click=[Gt,x,n],e(l),e(d),E(()=>{v(c,u[n]),v(q,t.creature.attributes[n])}),m(i,d)}),e(D);var I=r(D,2),T=a(I),O=r(a(T),2),mt=a(O,!0);e(O),e(T);var F=r(T,2),Q=r(a(F),2),bt=a(Q);e(Q),e(F);var H=r(F,2),W=r(a(H),2),ft=a(W);e(W),e(H);var L=r(H,2),X=r(a(L),2),pt=a(X);e(X),e(L);var N=r(L,2),Z=r(a(N),2),xt=a(Z);e(Z),e(N);var $=r(N,2),tt=r(a($),2),P=a(tt),ht=a(P,!0);e(P);var zt=r(P,2);zt.__click=[Kt,x],e(tt),e($),e(I);var et=r(I,2),B=a(et),U=a(B),at=r(a(U),2),Mt=a(at,!0);e(at),e(U);var rt=r(U,2);{var yt=i=>{var n=Qt(),d=r(a(n),2);C(d,21,()=>t.creature.traits,o=>o.name,(o,c)=>{var l=Ot(),_=a(l),q=a(_);e(_);var h=r(_,2),y=a(h,!0);e(h),e(l),E(()=>{v(q,`${g(c).name??""}:`),v(y,g(c).detail)}),m(o,l)}),e(d),e(n),m(i,n)};S(rt,i=>{t.creature.traits.length>0&&i(yt)})}var st=r(rt,2);{var Ct=i=>{var n=$t(),d=r(a(n),2);C(d,21,()=>t.creature.attacks,o=>o.name,(o,c)=>{var l=Zt(),_=a(l),q=a(_,!0);e(_);var h=r(_,2),y=a(h);y.__click=[Wt,A,c];var qt=a(y);e(y);var R=r(y,2);R.__click=[Xt,w,c];var Et=a(R);e(R);var Rt=r(R,1,!0);e(h),e(l),E(()=>{v(q,g(c).name),v(qt,`${(g(c).bonus>0?"+"+g(c).bonus:g(c).bonus)??""} 🎯`),v(Et,`${g(c).damage??""} 💥`),v(Rt,g(c).note?g(c).note:"")}),m(o,l)}),e(d),e(n),m(i,n)};S(st,i=>{t.creature.attacks.length>0&&i(Ct)})}var it=r(st,2);{var At=i=>{var n=ee(),d=r(a(n),2);C(d,21,()=>t.creature.actions,o=>o.name,(o,c)=>{var l=te(),_=a(l);dt(_,{get action(){return g(c)}}),e(l),m(o,l)}),e(d),e(n),m(i,n)};S(it,i=>{t.creature.actions.length>0&&i(At)})}var nt=r(it,2);{var wt=i=>{var n=re(),d=r(a(n),2);C(d,21,()=>t.creature.reactions,o=>o.name,(o,c)=>{var l=ae(),_=a(l);dt(_,{get action(){return g(c)}}),e(l),m(o,l)}),e(d),e(n),m(i,n)};S(nt,i=>{t.creature.reactions.length>0&&i(wt)})}var vt=r(nt,2),ot=r(a(vt),2),kt=a(ot,!0);e(ot),e(vt),e(B);var ct=r(B,2),lt=a(ct);e(ct),e(et),e(M),e(z),E(i=>{v(_t,t.creature.name),v(gt,t.creature.na),v(mt,t.creature.stats.maxHealth),v(bt,`${t.creature.stats.evasion.value??""}${t.creature.stats.evasion.note?` (${t.creature.stats.evasion.note})`:""}`),v(ft,`${t.creature.stats.physicalMitigation.value??""}${t.creature.stats.physicalMitigation.note?` (${t.creature.stats.physicalMitigation.note})`:""}`),v(pt,`${t.creature.stats.magicalMitigation.value??""}${t.creature.stats.magicalMitigation.note?` (${t.creature.stats.magicalMitigation.note})`:""}`),v(xt,`${t.creature.stats.speed.value??""}${t.creature.stats.speed.note?` (${t.creature.stats.speed.note})`:""}`),v(ht,t.creature.attributes.reflexes),v(Mt,i),v(kt,t.creature.behavior),ut(lt,"src",t.creature.img),ut(lt,"alt",t.creature.name)},[()=>t.creature.languages.join(", ")]),m(s,z),G()}Tt(["click"]);const ne=s=>{if(!s.name)throw new Error("Creature name is required");return{id:Nt(s.name),...s,attributes:{body:s.attributes.body??s.attributes.cuerpo??0,reflexes:s.attributes.reflexes??s.attributes.reflejos??0,mind:s.attributes.mind??s.attributes.mente??0,instinct:s.attributes.instinct??s.attributes.instinto??0,presence:s.attributes.presencia??s.attributes.presencia??0},stats:{maxHealth:s.stats.maxHealth??s.stats.salud??0,evasion:s.stats.evasion??s.stats.esquiva??{value:0,note:null},physicalMitigation:s.stats.physicalMitigation??s.stats.mitigacion??s.stats.mitigacionFisica??{value:0,note:null},magicalMitigation:s.stats.magicalMitigation??s.stats.mitigacionMagica??{value:0,note:null},speed:s.stats.speed??s.stats.velocidad??{value:0,note:null}}}},V=Ut([]),ve=()=>({loadCreatures:async()=>{if(Vt(V).length>0)return;const u=await(await fetch(Bt("/docs/bestiary.yml"))).text();let f=[];try{f=Pt(u).creatures??[]}catch(p){console.error("Error parsing YAML:",p)}V.set(f.map(p=>ne(p)))},creatures:V});var oe=b('<section><h1>Bestiario</h1> <div class="statblock-list svelte-uuivdv"></div></section>');function Me(s,t){Y(t,!1);const u=()=>It(A,"$creatures",f),[f,p]=Dt(),{loadCreatures:x,creatures:A}=ve();St(async()=>{await x()}),jt();var w=oe(),z=r(a(w),2);C(z,5,u,M=>M.id,(M,k)=>{ie(M,{get creature(){return g(k)}})}),e(z),e(w),m(s,w),G(),p()}export{Me as component};
