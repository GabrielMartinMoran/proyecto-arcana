const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BT9g2Aig.js","../chunks/BQL_5efD.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{o as Te,d as Se,s as W,h as De}from"../chunks/FRtchhGd.js";import{j as Le,k as je,be as Ne,bf as Oe,ao as qe,l as Fe,m as Ye,n as Be,o as Ve,q as He,u as We,ak as Ge,v as Je,p as me,Q as u,aa as Y,a5 as Ue,h as e,b as l,e as m,r as d,a as s,d as _e,f as H,g as _,t as X,c as ce,ab as xe,ac as Ke,bg as Re}from"../chunks/Cx9SZC40.js";import{i as L,s as Qe,a as Ze}from"../chunks/BQQjEHXb.js";import{s as de,b as Xe}from"../chunks/BKawnmId.js";import{_ as we}from"../chunks/PPVm8Dsz.js";import{b as $e}from"../chunks/Di1F8SJa.js";import{p as ue}from"../chunks/BqEhn_dl.js";import{r as ea,e as Ie,i as aa}from"../chunks/y3PUPQak.js";import{b as ta}from"../chunks/CjSGUr8l.js";import{u as ra,S as Ce}from"../chunks/BEA79oA8.js";import{d as oa,l as na}from"../chunks/BQL_5efD.js";import{R as ke}from"../chunks/DylWN1zM.js";import{m as sa}from"../chunks/DZAtAn7e.js";import{r as la}from"../chunks/BU-tBLa1.js";import{b as ia}from"../chunks/DjO2gEHc.js";function Pe(R,r,f){Le&&je();var i=R,w=Ge,n,p,b=null,C=Ne()?Oe:qe;function y(){n&&Je(n),b!==null&&(b.lastChild.remove(),i.before(b),b=null),n=p}Fe(()=>{if(C(w,w=r())){var E=i,g=He();g&&(b=document.createDocumentFragment(),b.append(E=Ye())),p=Be(()=>f(E)),g?Ve.add_callback(y):y()}}),Le&&(i=We)}const va=!1,lt=Object.freeze(Object.defineProperty({__proto__:null,ssr:va},Symbol.toStringTag,{value:"Module"}));var ca=l('<div class="code-editor svelte-lu1zm1"><div class="editor-content svelte-lu1zm1"></div></div>');function Ee(R,r){me(r,!0);let f=ue(r,"value",15,""),i=ue(r,"language",3,"yaml"),w,n=null;Te(()=>{let y=null;return(async()=>{try{const[{CodeJar:E},g]=await Promise.all([we(()=>import("../chunks/DxjqA_Qw.js"),[],import.meta.url),we(()=>import("../chunks/BT9g2Aig.js").then(k=>k.p),__vite__mapDeps([0,1]),import.meta.url)]);await we(()=>import("../chunks/Chm5ZdEN.js"),[],import.meta.url),n=E(w,k=>{const j=k.textContent||"";k.innerHTML=g.highlight(j,g.languages[i()]||g.languages.yaml,i())}),n.updateCode(f()),u(p,f(),!0),n.onUpdate(k=>{f(k),u(p,k,!0)}),y=()=>{n?.destroy(),n=null}}catch(E){console.error("Failed to initialize code editor:",E)}})(),()=>{y?.()}});let p=Y("");Ue(()=>{n&&f()!==e(p)&&(n.updateCode(f()),u(p,f(),!0))});var b=ca(),C=m(b);$e(C,y=>w=y,()=>w),d(b),s(R,b),_e()}var da=(R,r)=>r.onTabChange("mixed"),ua=(R,r)=>r.onTabChange("sheet"),ma=(R,r)=>r.onTabChange("yaml"),_a=l('<button title="Importar del Bestiario" class="svelte-frapm5">ğŸ“š</button>'),fa=l('<button title="Reiniciar al ejemplo" class="svelte-frapm5">ğŸ”„</button>'),pa=l('<button title="Copiar enlace" class="svelte-frapm5">ğŸ”—</button>'),ha=l('<button title="Copiar cÃ³digo iframe" class="svelte-frapm5">&lt;/&gt;</button>'),ya=l('<button title="Descargar YAML" class="svelte-frapm5">â¬‡ï¸</button>'),ba=l('<div class="tabs svelte-frapm5"><button>Mixta</button> <button>Ficha</button> <button>YAML</button></div> <div class="spacer svelte-frapm5"></div> <div class="actions svelte-frapm5"><!> <!> <!> <!> <!></div>',1),ga=l('<div class="toolbar svelte-frapm5"><!></div>');function wa(R,r){me(r,!0);let f=ue(r,"readonly",3,!1);var i=ga(),w=m(i);{var n=p=>{var b=ba(),C=H(b),y=m(C);y.__click=[da,r];let E;var g=_(y,2);g.__click=[ua,r];let G;var k=_(g,2);k.__click=[ma,r];let j;d(C);var re=_(C,4),T=m(re);{var S=v=>{var o=_a();o.__click=function(...h){r.onImport?.apply(this,h)},s(v,o)};L(T,v=>{r.onImport&&v(S)})}var M=_(T,2);{var B=v=>{var o=fa();o.__click=function(...h){r.onReset?.apply(this,h)},s(v,o)};L(M,v=>{r.onReset&&v(B)})}var oe=_(M,2);{var $=v=>{var o=pa();o.__click=function(...h){r.onCopyLink?.apply(this,h)},s(v,o)};L(oe,v=>{r.onCopyLink&&v($)})}var J=_(oe,2);{var ee=v=>{var o=ha();o.__click=function(...h){r.onCopyIframe?.apply(this,h)},s(v,o)};L(J,v=>{r.onCopyIframe&&v(ee)})}var q=_(J,2);{var ne=v=>{var o=ya();o.__click=function(...h){r.onDownload?.apply(this,h)},s(v,o)};L(q,v=>{r.onDownload&&v(ne)})}d(re),X((v,o,h)=>{E=de(y,1,"svelte-frapm5",null,E,v),G=de(g,1,"svelte-frapm5",null,G,o),j=de(k,1,"svelte-frapm5",null,j,h)},[()=>({active:r.activeTab==="mixed"}),()=>({active:r.activeTab==="sheet"}),()=>({active:r.activeTab==="yaml"})]),s(p,b)};L(w,p=>{f()||p(n)})}d(i),s(R,i),_e()}Se(["click"]);var Ca=R=>R.stopPropagation(),ka=l("<option> </option>"),Ta=(R,r,f)=>r(e(f)),La=l('<button class="creature-item svelte-z9w54y"><span class="creature-name svelte-z9w54y"> </span> <span class="creature-tier svelte-z9w54y"> </span></button>'),xa=l('<p class="empty-state svelte-z9w54y">No hay criaturas que coincidan con los filtros.</p>'),Ra=l('<div class="modal-backdrop svelte-z9w54y" role="presentation"><div class="modal-content svelte-z9w54y"><div class="modal-header svelte-z9w54y"><h3 class="svelte-z9w54y">Importar del Bestiario</h3> <button class="close-btn svelte-z9w54y">âœ•</button></div> <div class="filters svelte-z9w54y"><input type="text" placeholder="Buscar por nombre..." class="svelte-z9w54y"/> <select class="svelte-z9w54y"><option>Todos los tiers</option><!></select></div> <div class="creature-list svelte-z9w54y"></div></div></div>');function Ia(R,r){me(r,!0);const f=()=>Ze(b,"$creatures",i),[i,w]=Qe();let n=ue(r,"open",15,!1);const{loadCreatures:p,creatures:b}=ra();let C=Y(""),y=Y(""),E=xe(()=>(f()||[]).filter(T=>{const S=!e(C)||T.name.toLowerCase().includes(e(C).toLowerCase()),M=!e(y)||T.tier===parseInt(e(y));return S&&M})),g=xe(()=>Array.from(new Set((f()||[]).map(T=>T.tier))).sort((T,S)=>T-S));Te(async()=>{await p()});function G(T){const{id:S,...M}=T,B=oa(M,{indent:2,lineWidth:100});r.onSelect(B),n(!1)}var k=ce(),j=H(k);{var re=T=>{var S=Ra();S.__click=function(...o){r.onClose?.apply(this,o)};var M=m(S);M.__click=[Ca];var B=m(M),oe=_(m(B),2);oe.__click=function(...o){r.onClose?.apply(this,o)},d(B);var $=_(B,2),J=m($);ea(J);var ee=_(J,2),q=m(ee);q.value=q.__value="";var ne=_(q);Ie(ne,17,()=>e(g),aa,(o,h)=>{var z=ka(),ae=m(z);d(z);var a={};X(t=>{W(ae,`Tier ${e(h)??""}`),a!==(a=t)&&(z.value=(z.__value=t)??"")},[()=>e(h).toString()]),s(o,z)}),d(ee),d($);var v=_($,2);Ie(v,21,()=>e(E),o=>o.id,(o,h)=>{var z=La();z.__click=[Ta,G,h];var ae=m(z),a=m(ae,!0);d(ae);var t=_(ae,2),c=m(t);d(t),d(z),X(()=>{W(a,e(h).name),W(c,`Tier ${e(h).tier??""}`)}),s(o,z)},o=>{var h=xa();s(o,h)}),d(v),d(M),d(S),Xe(J,()=>e(C),o=>u(C,o)),ta(ee,()=>e(y),o=>u(y,o)),s(T,S)};L(j,T=>{n()&&T(re)})}s(R,k),_e(),w()}Se(["click"]);var Pa=l('<meta name="viewport" content="width=device-width, initial-scale=1"/>'),Ea=l("<!> <!>",1),Sa=l('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),Ua=l('<div class="sheet svelte-1smdv23"><!></div>'),Aa=l('<div class="error svelte-1smdv23"> </div>'),Ma=l('<div class="ok svelte-1smdv23">Criatura vÃ¡lida: <strong> </strong> </div>'),za=l('<div class="editor svelte-1smdv23"><!> <!></div>'),Da=l('<div class="error svelte-1smdv23"> </div>'),ja=l('<div class="ok svelte-1smdv23">Criatura vÃ¡lida: <strong> </strong> </div>'),Na=l("<!> <!>",1),Oa=l('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),qa=l('<div class="mixed-view svelte-1smdv23"><div class="editor-panel svelte-1smdv23"><!> <!></div> <div class="preview-panel svelte-1smdv23"><!></div></div>'),Fa=l("<!> <!>",1),Ya=l('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),Ba=l('<div class="sheet svelte-1smdv23"><!></div>'),Va=l("<div><!> <!> <!></div>");function it(R,r){me(r,!0);let f=Y("mixed"),i=Y(""),w=Y(null),n=Y(void 0),p=Y(!1),b=Y(!1),C=Y(0),y=null;const E=400;let g=null;const G=2e3;let k=0;const j=`# Ejemplo de criatura (editar aquÃ­)
name: Goblin
tier: 1
attributes:
  body: 2
  reflexes: 3
  mind: 1
  instinct: 2
  presence: 1
stats:
  maxHealth: 8
  evasion:
    value: 1
    note: null
  physicalMitigation:
    value: 0
    note: null
  magicalMitigation:
    value: 0
    note: null
  speed:
    value: 6
    note: null
languages: []
attacks:
  - name: Mordisco
    bonus: 1
    damage: 1d6
    note: null
traits:
  - name: Astuto
    detail: Sumar +1 a iniciativas en grupo
actions:
  - name: Ataque mÃºltiple
    detail: Ataca dos veces
    uses: null
reactions: []
interactions: []
behavior: ActÃºa en pequeÃ±os grupos para emboscar.
img: null
`,{isInsideFoundry:re,syncCreatureState:T}=ia(),S=a=>{u(n,a,!0),re()&&T(e(n))};function M(a){if(u(w,null),!a||!a.trim()){u(n,void 0);return}try{const t=na(a);let c=null;if(t&&typeof t=="object"&&Array.isArray(t.creatures))c=t.creatures[0]??null;else if(t&&typeof t=="object")c=t;else throw new Error("YAML no contiene un objeto vÃ¡lido de criatura.");if(!c)throw new Error("No se encontrÃ³ una criatura en el YAML proporcionado.");const N=sa(c);S(N)}catch(t){u(n,void 0);const c=t&&t.message?t.message:String(t);u(w,`Error al parsear YAML: ${c}`)}}Ue(()=>{const a=e(i);y&&clearTimeout(y),y=setTimeout(()=>{M(a),y=null},E);try{const t=Date.now(),c=()=>{try{const N=encodeURIComponent(a),K=new URL(window.location.href);N&&N.length>0?K.searchParams.set("yaml",N):K.searchParams.delete("yaml"),e(p)&&K.searchParams.set("readonly","1"),la(K.toString(),{}),k=Date.now()}catch{}};if(t-k>=G)g&&(clearTimeout(g),g=null),c();else{const N=G-(t-k);g||(g=setTimeout(()=>{c(),g=null},N))}}catch{}}),Te(()=>{try{const a=new URL(window.location.href),t=a.searchParams.get("yaml"),c=a.searchParams.get("readonly");if(u(p,c==="1"),t)try{u(i,decodeURIComponent(t),!0)}catch{u(i,j)}else u(i,j)}catch{u(i,j),u(p,!1)}e(p)&&u(f,"sheet")});function B(a){u(i,a,!0),Re(C),u(f,"mixed")}function oe(){confirm("Â¿Reiniciar al ejemplo por defecto? Se perderÃ¡n los cambios actuales.")&&(u(i,j),Re(C))}function $(){try{const a=encodeURIComponent(e(i)),t=new URL(window.location.href);a&&a.length>0?t.searchParams.set("yaml",a):t.searchParams.delete("yaml"),e(p)&&t.searchParams.set("readonly","1");const c=t.toString();navigator.clipboard.writeText(c),alert("Enlace copiado al portapapeles.")}catch(a){console.warn("[embedded npc] copyShareURL failed",a),alert("No se pudo copiar la URL.")}}function J(){try{const a=encodeURIComponent(e(i)),t=new URL(window.location.href);a&&a.length>0?t.searchParams.set("yaml",a):t.searchParams.delete("yaml"),t.searchParams.set("readonly","1");const c=`<iframe src="${t.toString()}" width="100%" height="600" style="border:none;"></iframe>`;navigator.clipboard.writeText(c),alert("CÃ³digo iframe copiado al portapapeles.")}catch(a){console.warn("[embedded npc] copyIframe failed",a),alert("No se pudo copiar el cÃ³digo iframe.")}}function ee(){const a=new Blob([e(i)],{type:"text/yaml"}),t=URL.createObjectURL(a),c=document.createElement("a");c.href=t,c.download=`${(e(n)?.name??"creature").replace(/\s+/g,"_")}.yml`,document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(t)}var q=Va();De(a=>{var t=Pa();Ke.title="NPC Custom (embebido)",s(a,t)});let ne;var v=m(q);wa(v,{get activeTab(){return e(f)},onTabChange:a=>u(f,a,!0),onImport:()=>u(b,!0),onReset:oe,onCopyLink:$,onCopyIframe:J,onDownload:ee,get readonly(){return e(p)}});var o=_(v,2);Ia(o,{onSelect:B,onClose:()=>u(b,!1),get open(){return e(b)},set open(a){u(b,a,!0)}});var h=_(o,2);{var z=a=>{var t=Ua(),c=m(t);{var N=U=>{var O=Ea(),te=H(O);Ce(te,{get creature(){return e(n)}});var le=_(te,2);ke(le,{}),s(U,O)},K=U=>{var O=Sa();s(U,O)};L(c,U=>{e(n)?U(N):U(K,!1)})}d(t),s(a,t)},ae=a=>{var t=ce(),c=H(t);{var N=U=>{var O=za(),te=m(O);Pe(te,()=>e(C),x=>{Ee(x,{language:"yaml",get value(){return e(i)},set value(P){u(i,P,!0)}})});var le=_(te,2);{var fe=x=>{var P=Aa(),Z=m(P,!0);d(P),X(()=>W(Z,e(w))),s(x,P)},Q=x=>{var P=ce(),Z=H(P);{var ie=D=>{var F=Ma(),V=_(m(F)),ve=m(V,!0);d(V);var pe=_(V);d(F),X(()=>{W(ve,e(n).name),W(pe,` (tier ${e(n).tier??""})`)}),s(D,F)};L(Z,D=>{e(n)&&D(ie)},!0)}s(x,P)};L(le,x=>{e(w)?x(fe):x(Q,!1)})}d(O),s(U,O)},K=U=>{var O=ce(),te=H(O);{var le=Q=>{var x=qa(),P=m(x),Z=m(P);Pe(Z,()=>e(C),I=>{Ee(I,{language:"yaml",get value(){return e(i)},set value(A){u(i,A,!0)}})});var ie=_(Z,2);{var D=I=>{var A=Da(),se=m(A,!0);d(A),X(()=>W(se,e(w))),s(I,A)},F=I=>{var A=ce(),se=H(A);{var he=ye=>{var be=ja(),ge=_(m(be)),Me=m(ge,!0);d(ge);var ze=_(ge);d(be),X(()=>{W(Me,e(n).name),W(ze,` (tier ${e(n).tier??""})`)}),s(ye,be)};L(se,ye=>{e(n)&&ye(he)},!0)}s(I,A)};L(ie,I=>{e(w)?I(D):I(F,!1)})}d(P);var V=_(P,2),ve=m(V);{var pe=I=>{var A=Na(),se=H(A);Ce(se,{get creature(){return e(n)}});var he=_(se,2);ke(he,{}),s(I,A)},Ae=I=>{var A=Oa();s(I,A)};L(ve,I=>{e(n)?I(pe):I(Ae,!1)})}d(V),d(x),s(Q,x)},fe=Q=>{var x=Ba(),P=m(x);{var Z=D=>{var F=Fa(),V=H(F);Ce(V,{get creature(){return e(n)}});var ve=_(V,2);ke(ve,{}),s(D,F)},ie=D=>{var F=Ya();s(D,F)};L(P,D=>{e(n)?D(Z):D(ie,!1)})}d(x),s(Q,x)};L(te,Q=>{e(f)==="mixed"?Q(le):Q(fe,!1)},!0)}s(U,O)};L(c,U=>{e(f)==="yaml"?U(N):U(K,!1)},!0)}s(a,t)};L(h,a=>{e(p)?a(z):a(ae,!1)})}d(q),X(a=>ne=de(q,1,"embedded-npc svelte-1smdv23",null,ne,a),[()=>({readonly:e(p)})]),s(R,q),_e()}export{it as component,lt as universal};
