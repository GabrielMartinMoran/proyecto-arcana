import"../chunks/DsnmJJEf.js";import"../chunks/B9xErqrg.js";import{s as o,d as Tt,o as jt}from"../chunks/DEyIqfax.js";import{p as U,b,e,r as a,g as r,t as y,a as m,d as V,j as g}from"../chunks/4UBXq5Sj.js";import{e as C,s as ct}from"../chunks/Z0ud6hNo.js";import{i as qt}from"../chunks/CwSwkGN2.js";import{i as S,s as Dt,a as It}from"../chunks/DY7lAt98.js";import{a as Nt,p as Pt}from"../chunks/2I8yVucp.js";import{c as Ft,l as Lt}from"../chunks/CGjaQNWU.js";import{C as H}from"../chunks/h9G2bksv.js";import{r as Ot}from"../chunks/E2nQb6Fw.js";import{m as Bt}from"../chunks/DemwCk8g.js";import{w as Gt,g as Ht}from"../chunks/Cje6xDa-.js";var Ut=b('<div class="action"><strong> </strong> <span> </span></div>');function lt(f,t){U(t,!0);var u=Ut(),x=e(u),_=e(x);a(x);var p=r(x,2),R=e(p,!0);a(p),a(u),y(()=>{o(_,`${t.action.name??""}
		${t.action.uses?`(${t.action.uses.type=="USES"?`${t.action.uses.qty} ${t.action.uses.qty===1?"uso":"usos"}`:`Recarga ${t.action.uses.qty}+`})`:""}:`),o(R,t.action.detail)}),m(f,u),V()}var Vt=(f,t,u)=>t(`1d6e+${H.ATTR_NAME_MAP[u]}`,Ft(H.ATTR_NAME_MAP[u])),Yt=b('<div class="attribute svelte-2zpvir"><strong> </strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div>'),Jt=(f,t)=>t("1d6e+reflejos","Iniciativa"),Kt=b("<li><strong> </strong> <span> </span></li>"),Qt=b('<div class="traits"><strong>Rasgos</strong> <ul></ul></div>'),Wt=(f,t,u)=>t(g(u)),Xt=(f,t,u)=>t(g(u)),Zt=b('<li><strong> </strong> <span><button class="svelte-2zpvir"> </button> <button class="svelte-2zpvir"> </button> </span></li>'),$t=b('<div class="attacks svelte-2zpvir"><strong>Ataques</strong> <ul></ul></div>'),ta=b("<li><!></li>"),aa=b('<div class="actions"><strong>Acciones</strong> <ul></ul></div>'),ea=b("<li><!></li>"),ra=b('<div class="actions"><strong>Reacciones</strong> <ul></ul></div>'),sa=b('<div class="right svelte-2zpvir"><img class="svelte-2zpvir"/></div>'),ia=b('<div class="statblock svelte-2zpvir"><div class="bg svelte-2zpvir"></div> <div class="data svelte-2zpvir"><div class="header svelte-2zpvir"><h2> </h2> <span><strong>NA</strong> <span> </span></span></div> <div class="attributes svelte-2zpvir"></div> <div class="stats svelte-2zpvir"><div class="attribute svelte-2zpvir"><strong>Salud</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Esquiva</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Física</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Mágica</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Velocidad</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Iniciativa</strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div></div> <div class="middle svelte-2zpvir"><div class="left svelte-2zpvir"><div class="languages"><strong>Lenguas</strong> <span> </span></div> <!> <!> <!> <!> <div class="behavior"><strong>Comportamiento:</strong> <span> </span></div></div> <!></div></div></div>');function va(f,t){U(t,!0);let{rollModal:u,rollExpression:x}=Nt();const _=(s,i)=>{const v={Cuerpo:t.creature.attributes.body,Reflejos:t.creature.attributes.reflexes,Mente:t.creature.attributes.mind,Instinto:t.creature.attributes.instinct,Presencia:t.creature.attributes.presence,Iniciativa:t.creature.attributes.reflexes};for(const n of Object.keys(v))v[n.toLowerCase()]=v[n];u.openRollModal({expression:s,variables:v,title:`${t.creature.name}: ${i}`})},p=s=>{_(`1d6e+${s.bonus}`,`Ataca con ${s.name}`)},R=s=>{const i=Pt(s.damage);x({expression:i,title:`${t.creature.name}: Daño de ${s.name}`})};var z=ia(),k=r(e(z),2),h=e(k),w=e(h),ut=e(w,!0);a(w);var Y=r(w,2),J=r(e(Y),2),dt=e(J,!0);a(J),a(Y),a(h);var j=r(h,2);C(j,20,()=>["body","reflexes","mind","instinct","presence"],s=>s,(s,i)=>{var v=Yt(),n=e(v),c=e(n,!0);a(n);var l=r(n,2),d=e(l),E=e(d,!0);a(d);var M=r(d,2);M.__click=[Vt,_,i],a(l),a(v),y(()=>{o(c,H.ATTR_NAME_MAP[i]),o(E,t.creature.attributes[i])}),m(s,v)}),a(j);var q=r(j,2),D=e(q),K=r(e(D),2),_t=e(K,!0);a(K),a(D);var I=r(D,2),Q=r(e(I),2),gt=e(Q);a(Q),a(I);var N=r(I,2),W=r(e(N),2),mt=e(W);a(W),a(N);var P=r(N,2),X=r(e(P),2),bt=e(X);a(X),a(P);var F=r(P,2),Z=r(e(F),2),ft=e(Z);a(Z),a(F);var $=r(F,2),tt=r(e($),2),L=e(tt),xt=e(L,!0);a(L);var pt=r(L,2);pt.__click=[Jt,_],a(tt),a($),a(q);var at=r(q,2),O=e(at),B=e(O),et=r(e(B),2),zt=e(et,!0);a(et),a(B);var rt=r(B,2);{var ht=s=>{var i=Qt(),v=r(e(i),2);C(v,21,()=>t.creature.traits,n=>n.name,(n,c)=>{var l=Kt(),d=e(l),E=e(d);a(d);var M=r(d,2),A=e(M,!0);a(M),a(l),y(()=>{o(E,`${g(c).name??""}:`),o(A,g(c).detail)}),m(n,l)}),a(v),a(i),m(s,i)};S(rt,s=>{t.creature.traits.length>0&&s(ht)})}var st=r(rt,2);{var Mt=s=>{var i=$t(),v=r(e(i),2);C(v,21,()=>t.creature.attacks,n=>n.name,(n,c)=>{var l=Zt(),d=e(l),E=e(d,!0);a(d);var M=r(d,2),A=e(M);A.__click=[Wt,p,c];var wt=e(A);a(A);var T=r(A,2);T.__click=[Xt,R,c];var Et=e(T);a(T);var St=r(T,1,!0);a(M),a(l),y(()=>{o(E,g(c).name),o(wt,`${(g(c).bonus>0?"+"+g(c).bonus:g(c).bonus)??""} 🎯`),o(Et,`${g(c).damage??""} 💥`),o(St,g(c).note?g(c).note:"")}),m(n,l)}),a(v),a(i),m(s,i)};S(st,s=>{t.creature.attacks.length>0&&s(Mt)})}var it=r(st,2);{var At=s=>{var i=aa(),v=r(e(i),2);C(v,21,()=>t.creature.actions,n=>n.name,(n,c)=>{var l=ta(),d=e(l);lt(d,{get action(){return g(c)}}),a(l),m(n,l)}),a(v),a(i),m(s,i)};S(it,s=>{t.creature.actions.length>0&&s(At)})}var vt=r(it,2);{var yt=s=>{var i=ra(),v=r(e(i),2);C(v,21,()=>t.creature.reactions,n=>n.name,(n,c)=>{var l=ea(),d=e(l);lt(d,{get action(){return g(c)}}),a(l),m(n,l)}),a(v),a(i),m(s,i)};S(vt,s=>{t.creature.reactions.length>0&&s(yt)})}var nt=r(vt,2),ot=r(e(nt),2),Ct=e(ot,!0);a(ot),a(nt),a(O);var Rt=r(O,2);{var kt=s=>{var i=sa(),v=e(i);a(i),y(()=>{ct(v,"src",t.creature.img),ct(v,"alt",t.creature.name)}),m(s,i)};S(Rt,s=>{t.creature.img&&s(kt)})}a(at),a(k),a(z),y(s=>{o(ut,t.creature.name),o(dt,t.creature.na),o(_t,t.creature.stats.maxHealth),o(gt,`${t.creature.stats.evasion.value??""}${t.creature.stats.evasion.note?` (${t.creature.stats.evasion.note})`:""}`),o(mt,`${t.creature.stats.physicalMitigation.value??""}${t.creature.stats.physicalMitigation.note?` (${t.creature.stats.physicalMitigation.note})`:""}`),o(bt,`${t.creature.stats.magicalMitigation.value??""}${t.creature.stats.magicalMitigation.note?` (${t.creature.stats.magicalMitigation.note})`:""}`),o(ft,`${t.creature.stats.speed.value??""}${t.creature.stats.speed.note?` (${t.creature.stats.speed.note})`:""}`),o(xt,t.creature.attributes.reflexes),o(zt,s),o(Ct,t.creature.behavior)},[()=>t.creature.languages.join(", ")]),m(f,z),V()}Tt(["click"]);const G=Gt([]),na=()=>({loadCreatures:async()=>{if(Ht(G).length>0)return;const u=await(await fetch(Ot("/docs/bestiary.yml"))).text();let x=[];try{x=Lt(u).creatures??[]}catch(_){console.error("Error parsing YAML:",_)}G.set(x.map(_=>Bt(_)).toSorted((_,p)=>_.na-p.na||_.name.localeCompare(p.name)))},creatures:G});var oa=b('<section class="svelte-uuivdv"><h1>Bestiario</h1> <div class="statblock-list svelte-uuivdv"></div></section>');function Ma(f,t){U(t,!1);const u=()=>It(R,"$creatures",x),[x,_]=Dt(),{loadCreatures:p,creatures:R}=na();jt(async()=>{await p()}),qt();var z=oa(),k=r(e(z),2);C(k,5,u,h=>h.id,(h,w)=>{va(h,{get creature(){return g(w)}})}),a(k),a(z),m(f,z),V(),_()}export{Ma as component};
