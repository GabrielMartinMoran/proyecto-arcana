import"../chunks/DsnmJJEf.js";import"../chunks/d2Dok1Vz.js";import{o as jt}from"../chunks/DfNiT5Wx.js";import{p as V,b as f,e as a,r as e,s as r,t as R,a as b,d as Y,i as g}from"../chunks/CXLGFl3I.js";import{e as C,s as ut}from"../chunks/BPnaOVD8.js";import{i as Et}from"../chunks/DZEc-YHI.js";import{i as j,s as It,a as Dt}from"../chunks/ta242qJX.js";import{s as c,d as Ft}from"../chunks/DYVYXqqK.js";import{a as Ht,p as Lt}from"../chunks/kpi8fZtB.js";import{c as Pt,g as Tt,l as Bt}from"../chunks/CjlGQt4x.js";import{r as Nt}from"../chunks/TWQo5Y65.js";import{w as Ot,g as Ut}from"../chunks/DnpldMJA.js";var Vt=f('<div class="action"><strong> </strong> <span> </span></div>');function dt(s,t){V(t,!0);var d=Vt(),m=a(d),p=a(m);e(m);var x=r(m,2),w=a(x,!0);e(x),e(d),R(()=>{c(p,`${t.action.name??""}
		${t.action.uses?`(${t.action.uses.type=="USES"?`${t.action.uses.qty} ${t.action.uses.qty===1?"uso":"usos"}`:`Recarga ${t.action.uses.qty}+`})`:""}:`),c(w,t.action.detail)}),b(s,d),Y()}var Yt=(s,t,d,m)=>t(`1d6e+${d[m]}`,Pt(d[m])),Gt=f('<div class="attribute svelte-2zpvir"><strong> </strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div>'),Jt=(s,t)=>t("1d6e+reflejos","Iniciativa"),Kt=f("<li><strong> </strong> <span> </span></li>"),Qt=f('<div class="traits"><strong>Rasgos</strong> <ul></ul></div>'),Wt=(s,t,d)=>t(g(d)),Xt=(s,t,d)=>t(g(d)),Zt=f('<li><strong> </strong> <span><button class="svelte-2zpvir"> </button> <button class="svelte-2zpvir"> </button> </span></li>'),$t=f('<div class="attacks svelte-2zpvir"><strong>Ataques</strong> <ul></ul></div>'),te=f("<li><!></li>"),ee=f('<div class="actions"><strong>Acciones</strong> <ul></ul></div>'),ae=f("<li><!></li>"),re=f('<div class="actions"><strong>Reacciones</strong> <ul></ul></div>'),se=f('<div class="statblock svelte-2zpvir"><div class="bg svelte-2zpvir"></div> <div class="data svelte-2zpvir"><div class="header svelte-2zpvir"><h2> </h2> <span><strong>NA</strong> <span> </span></span></div> <div class="attributes svelte-2zpvir"></div> <div class="stats svelte-2zpvir"><div class="attribute svelte-2zpvir"><strong>Salud</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Esquiva</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Física</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Mitigación Mágica</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Velocidad</strong> <span> </span></div> <div class="attribute svelte-2zpvir"><strong>Iniciativa</strong> <div class="score svelte-2zpvir"><span> </span> <button title="Tirar" class="svelte-2zpvir">🎲</button></div></div></div> <div class="middle svelte-2zpvir"><div class="left svelte-2zpvir"><div class="languages"><strong>Lenguas</strong> <span> </span></div> <!> <!> <!> <!> <div class="behavior"><strong>Comportamiento:</strong> <span> </span></div></div> <div class="right svelte-2zpvir"><img class="svelte-2zpvir"/></div></div></div></div>');function ie(s,t){V(t,!0);const d={body:"Cuerpo",reflexes:"Reflejos",mind:"Mente",instinct:"Instinto",presence:"Presencia"};let{rollModal:m,rollExpression:p}=Ht();const x=(i,n)=>{const o={Cuerpo:t.creature.attributes.body,Reflejos:t.creature.attributes.reflexes,Mente:t.creature.attributes.mind,Instinto:t.creature.attributes.instinct,Presencia:t.creature.attributes.presence,Iniciativa:t.creature.attributes.reflexes};for(const v of Object.keys(o))o[v.toLowerCase()]=o[v];m.openRollModal({expression:i,variables:o,title:`${t.creature.name}: ${n}`})},w=i=>{x(`1d6e+${i.bonus}`,`Ataca con ${i.name}`)},k=i=>{const n=Lt(i.damage);p({expression:n,title:`${t.creature.name}: Daño de ${i.name}`})};var z=se(),y=r(a(z),2),q=a(y),E=a(q),_t=a(E,!0);e(E);var G=r(E,2),J=r(a(G),2),gt=a(J,!0);e(J),e(G),e(q);var I=r(q,2);C(I,20,()=>["body","reflexes","mind","instinct","presence"],i=>i,(i,n)=>{var o=Gt(),v=a(o),l=a(v,!0);e(v);var u=r(v,2),_=a(u),A=a(_,!0);e(_);var h=r(_,2);h.__click=[Yt,x,d,n],e(u),e(o),R(()=>{c(l,d[n]),c(A,t.creature.attributes[n])}),b(i,o)}),e(I);var D=r(I,2),F=a(D),K=r(a(F),2),mt=a(K,!0);e(K),e(F);var H=r(F,2),Q=r(a(H),2),bt=a(Q);e(Q),e(H);var L=r(H,2),W=r(a(L),2),ft=a(W);e(W),e(L);var P=r(L,2),X=r(a(P),2),pt=a(X);e(X),e(P);var T=r(P,2),Z=r(a(T),2),xt=a(Z);e(Z),e(T);var $=r(T,2),tt=r(a($),2),B=a(tt),ht=a(B,!0);e(B);var zt=r(B,2);zt.__click=[Jt,x],e(tt),e($),e(D);var et=r(D,2),N=a(et),O=a(N),at=r(a(O),2),yt=a(at,!0);e(at),e(O);var rt=r(O,2);{var Mt=i=>{var n=Qt(),o=r(a(n),2);C(o,21,()=>t.creature.traits,v=>v.name,(v,l)=>{var u=Kt(),_=a(u),A=a(_);e(_);var h=r(_,2),M=a(h,!0);e(h),e(u),R(()=>{c(A,`${g(l).name??""}:`),c(M,g(l).detail)}),b(v,u)}),e(o),e(n),b(i,n)};j(rt,i=>{t.creature.traits.length>0&&i(Mt)})}var st=r(rt,2);{var Ct=i=>{var n=$t(),o=r(a(n),2);C(o,21,()=>t.creature.attacks,v=>v.name,(v,l)=>{var u=Zt(),_=a(u),A=a(_,!0);e(_);var h=r(_,2),M=a(h);M.__click=[Wt,w,l];var At=a(M);e(M);var S=r(M,2);S.__click=[Xt,k,l];var Rt=a(S);e(S);var St=r(S,1,!0);e(h),e(u),R(()=>{c(A,g(l).name),c(At,`${(g(l).bonus>0?"+"+g(l).bonus:g(l).bonus)??""} 🎯`),c(Rt,`${g(l).damage??""} 💥`),c(St,g(l).note?g(l).note:"")}),b(v,u)}),e(o),e(n),b(i,n)};j(st,i=>{t.creature.attacks.length>0&&i(Ct)})}var it=r(st,2);{var wt=i=>{var n=ee(),o=r(a(n),2);C(o,21,()=>t.creature.actions,v=>v.name,(v,l)=>{var u=te(),_=a(u);dt(_,{get action(){return g(l)}}),e(u),b(v,u)}),e(o),e(n),b(i,n)};j(it,i=>{t.creature.actions.length>0&&i(wt)})}var nt=r(it,2);{var kt=i=>{var n=re(),o=r(a(n),2);C(o,21,()=>t.creature.reactions,v=>v.name,(v,l)=>{var u=ae(),_=a(u);dt(_,{get action(){return g(l)}}),e(u),b(v,u)}),e(o),e(n),b(i,n)};j(nt,i=>{t.creature.reactions.length>0&&i(kt)})}var vt=r(nt,2),ot=r(a(vt),2),qt=a(ot,!0);e(ot),e(vt),e(N);var ct=r(N,2),lt=a(ct);e(ct),e(et),e(y),e(z),R(i=>{c(_t,t.creature.name),c(gt,t.creature.na),c(mt,t.creature.stats.maxHealth),c(bt,`${t.creature.stats.evasion.value??""}${t.creature.stats.evasion.note?` (${t.creature.stats.evasion.note})`:""}`),c(ft,`${t.creature.stats.physicalMitigation.value??""}${t.creature.stats.physicalMitigation.note?` (${t.creature.stats.physicalMitigation.note})`:""}`),c(pt,`${t.creature.stats.magicalMitigation.value??""}${t.creature.stats.magicalMitigation.note?` (${t.creature.stats.magicalMitigation.note})`:""}`),c(xt,`${t.creature.stats.speed.value??""}${t.creature.stats.speed.note?` (${t.creature.stats.speed.note})`:""}`),c(ht,t.creature.attributes.reflexes),c(yt,i),c(qt,t.creature.behavior),ut(lt,"src",t.creature.img),ut(lt,"alt",t.creature.name)},[()=>t.creature.languages.join(", ")]),b(s,z),Y()}Ft(["click"]);const ne=s=>{if(!s.name)throw new Error("Creature name is required");return{id:Tt(s.name),...s,attributes:{body:s.attributes.body??s.attributes.cuerpo??0,reflexes:s.attributes.reflexes??s.attributes.reflejos??0,mind:s.attributes.mind??s.attributes.mente??0,instinct:s.attributes.instinct??s.attributes.instinto??0,presence:s.attributes.presencia??s.attributes.presencia??0},stats:{maxHealth:s.stats.maxHealth??s.stats.salud??0,evasion:s.stats.evasion??s.stats.esquiva??{value:0,note:null},physicalMitigation:s.stats.physicalMitigation??s.stats.mitigacion??s.stats.mitigacionFisica??{value:0,note:null},magicalMitigation:s.stats.magicalMitigation??s.stats.mitigacionMagica??{value:0,note:null},speed:s.stats.speed??s.stats.velocidad??{value:0,note:null}}}},U=Ot([]),ve=()=>({loadCreatures:async()=>{if(Ut(U).length>0)return;const d=await(await fetch(Nt("/docs/bestiary.yml"))).text();let m=[];try{m=Bt(d).creatures??[]}catch(p){console.error("Error parsing YAML:",p)}U.set(m.map(p=>ne(p)))},creatures:U});var oe=f('<section class="svelte-uuivdv"><h1>Bestiario</h1> <div class="statblock-list svelte-uuivdv"></div></section>');function ze(s,t){V(t,!1);const d=()=>Dt(w,"$creatures",m),[m,p]=It(),{loadCreatures:x,creatures:w}=ve();jt(async()=>{await x()}),Et();var k=oe(),z=r(a(k),2);C(z,5,d,y=>y.id,(y,q)=>{ie(y,{get creature(){return g(q)}})}),e(z),e(k),b(s,k),Y(),p()}export{ze as component};
