const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BT9g2Aig.js","../chunks/BQL_5efD.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{o as Le}from"../chunks/CzhoJcdv.js";import{i as xe,j as je,b3 as Ne,b4 as Oe,aM as Fe,k as qe,l as Ye,m as Be,n as Ve,o as He,q as Ge,ai as Je,u as We,p as _e,O as u,a2 as Y,am as Ue,g as e,f as s,d as m,r as d,b as i,c as fe,aF as Ae,a as H,s as _,t as X,aH as de,e as G,aG as Re,aI as Ke,aJ as Ze,b5 as Ie}from"../chunks/DLXWS9Me.js";import{i as L}from"../chunks/sk9sCnVa.js";import{s as ue}from"../chunks/DvREelRX.js";import{_ as Ce}from"../chunks/PPVm8Dsz.js";import{b as Qe}from"../chunks/DJm-D21k.js";import{p as me}from"../chunks/B0W8Y-cb.js";import{e as Pe,i as Xe}from"../chunks/DqBPzmir.js";import{r as $e}from"../chunks/YdHDDrJh.js";import{b as ea}from"../chunks/CwyfYjnX.js";import{b as aa}from"../chunks/B16OnVP7.js";import{s as ta,a as ra}from"../chunks/9-vBrUj_.js";import{u as oa,S as ke}from"../chunks/DsHTFQ4U.js";import{d as na,l as ia}from"../chunks/BQL_5efD.js";import{R as Te}from"../chunks/BkMshWWk.js";import{m as sa}from"../chunks/DZAtAn7e.js";import{r as la}from"../chunks/BlEGOwK4.js";/* empty css                */import{b as va}from"../chunks/Cf74FySC.js";import{d as ce}from"../chunks/BA7vPwHJ.js";function Se(R,r,f){xe&&je();var l=R,w=Je,n,p,b=null,C=Ne()?Oe:Fe;function h(){n&&We(n),b!==null&&(b.lastChild.remove(),l.before(b),b=null),n=p}qe(()=>{if(C(w,w=r())){var S=l,g=He();g&&(b=document.createDocumentFragment(),b.append(S=Ye())),p=Be(()=>f(S)),g?Ve.add_callback(h):h()}}),xe&&(l=Ge)}const ca=!1,mt=Object.freeze(Object.defineProperty({__proto__:null,ssr:ca},Symbol.toStringTag,{value:"Module"}));var da=s('<div class="code-editor svelte-lu1zm1"><div class="editor-content svelte-lu1zm1"></div></div>');function Ee(R,r){_e(r,!0);let f=me(r,"value",15,""),l=me(r,"language",3,"yaml"),w,n=null;Le(()=>{let h=null;return(async()=>{try{const[{CodeJar:S},g]=await Promise.all([Ce(()=>import("../chunks/DxjqA_Qw.js"),[],import.meta.url),Ce(()=>import("../chunks/BT9g2Aig.js").then(k=>k.p),__vite__mapDeps([0,1]),import.meta.url)]);await Ce(()=>import("../chunks/Chm5ZdEN.js"),[],import.meta.url),n=S(w,k=>{const j=k.textContent||"";k.innerHTML=g.highlight(j,g.languages[l()]||g.languages.yaml,l())}),n.updateCode(f()),u(p,f(),!0),n.onUpdate(k=>{f(k),u(p,k,!0)}),h=()=>{n?.destroy(),n=null}}catch(S){console.error("Failed to initialize code editor:",S)}})(),()=>{h?.()}});let p=Y("");Ue(()=>{n&&f()!==e(p)&&(n.updateCode(f()),u(p,f(),!0))});var b=da(),C=m(b);Qe(C,h=>w=h,()=>w),d(b),i(R,b),fe()}var ua=(R,r)=>r.onTabChange("mixed"),ma=(R,r)=>r.onTabChange("sheet"),_a=(R,r)=>r.onTabChange("yaml"),fa=s('<button title="Importar del Bestiario" class="svelte-frapm5">ğŸ“š</button>'),pa=s('<button title="Reiniciar al ejemplo" class="svelte-frapm5">ğŸ”„</button>'),ya=s('<button title="Copiar enlace" class="svelte-frapm5">ğŸ”—</button>'),ha=s('<button title="Copiar cÃ³digo iframe" class="svelte-frapm5">&lt;/&gt;</button>'),ba=s('<button title="Descargar YAML" class="svelte-frapm5">â¬‡ï¸</button>'),ga=s('<div class="tabs svelte-frapm5"><button>Mixta</button> <button>Ficha</button> <button>YAML</button></div> <div class="spacer svelte-frapm5"></div> <div class="actions svelte-frapm5"><!> <!> <!> <!> <!></div>',1),wa=s('<div class="toolbar svelte-frapm5"><!></div>');function Ca(R,r){_e(r,!0);let f=me(r,"readonly",3,!1);var l=wa(),w=m(l);{var n=p=>{var b=ga(),C=H(b),h=m(C);h.__click=[ua,r];let S;var g=_(h,2);g.__click=[ma,r];let J;var k=_(g,2);k.__click=[_a,r];let j;d(C);var re=_(C,4),T=m(re);{var E=v=>{var o=fa();o.__click=function(...y){r.onImport?.apply(this,y)},i(v,o)};L(T,v=>{r.onImport&&v(E)})}var M=_(T,2);{var B=v=>{var o=pa();o.__click=function(...y){r.onReset?.apply(this,y)},i(v,o)};L(M,v=>{r.onReset&&v(B)})}var oe=_(M,2);{var $=v=>{var o=ya();o.__click=function(...y){r.onCopyLink?.apply(this,y)},i(v,o)};L(oe,v=>{r.onCopyLink&&v($)})}var W=_(oe,2);{var ee=v=>{var o=ha();o.__click=function(...y){r.onCopyIframe?.apply(this,y)},i(v,o)};L(W,v=>{r.onCopyIframe&&v(ee)})}var F=_(W,2);{var ne=v=>{var o=ba();o.__click=function(...y){r.onDownload?.apply(this,y)},i(v,o)};L(F,v=>{r.onDownload&&v(ne)})}d(re),X((v,o,y)=>{S=ue(h,1,"svelte-frapm5",null,S,v),J=ue(g,1,"svelte-frapm5",null,J,o),j=ue(k,1,"svelte-frapm5",null,j,y)},[()=>({active:r.activeTab==="mixed"}),()=>({active:r.activeTab==="sheet"}),()=>({active:r.activeTab==="yaml"})]),i(p,b)};L(w,p=>{f()||p(n)})}d(l),i(R,l),fe()}Ae(["click"]);var ka=R=>R.stopPropagation(),Ta=s("<option> </option>"),La=(R,r,f)=>r(e(f)),xa=s('<button class="creature-item svelte-z9w54y"><span class="creature-name svelte-z9w54y"> </span> <span class="creature-tier svelte-z9w54y"> </span></button>'),Ra=s('<p class="empty-state svelte-z9w54y">No hay criaturas que coincidan con los filtros.</p>'),Ia=s('<div class="modal-backdrop svelte-z9w54y" role="presentation"><div class="modal-content svelte-z9w54y"><div class="modal-header svelte-z9w54y"><h3 class="svelte-z9w54y">Importar del Bestiario</h3> <button class="close-btn svelte-z9w54y">âœ•</button></div> <div class="filters svelte-z9w54y"><input type="text" placeholder="Buscar por nombre..." class="svelte-z9w54y"/> <select class="svelte-z9w54y"><option>Todos los tiers</option><!></select></div> <div class="creature-list svelte-z9w54y"></div></div></div>');function Pa(R,r){_e(r,!0);const f=()=>ra(b,"$creatures",l),[l,w]=ta();let n=me(r,"open",15,!1);const{loadCreatures:p,creatures:b}=oa();let C=Y(""),h=Y(""),S=Re(()=>(f()||[]).filter(T=>{const E=!e(C)||T.name.toLowerCase().includes(e(C).toLowerCase()),M=!e(h)||T.tier===parseInt(e(h));return E&&M})),g=Re(()=>Array.from(new Set((f()||[]).map(T=>T.tier))).sort((T,E)=>T-E));Le(async()=>{await p()});function J(T){const{id:E,...M}=T,B=na(M,{indent:2,lineWidth:100});r.onSelect(B),n(!1)}var k=de(),j=H(k);{var re=T=>{var E=Ia();E.__click=function(...o){r.onClose?.apply(this,o)};var M=m(E);M.__click=[ka];var B=m(M),oe=_(m(B),2);oe.__click=function(...o){r.onClose?.apply(this,o)},d(B);var $=_(B,2),W=m($);$e(W);var ee=_(W,2),F=m(ee);F.value=F.__value="";var ne=_(F);Pe(ne,17,()=>e(g),Xe,(o,y)=>{var z=Ta(),ae=m(z);d(z);var a={};X(t=>{G(ae,`Tier ${e(y)??""}`),a!==(a=t)&&(z.value=(z.__value=t)??"")},[()=>e(y).toString()]),i(o,z)}),d(ee),d($);var v=_($,2);Pe(v,21,()=>e(S),o=>o.id,(o,y)=>{var z=xa();z.__click=[La,J,y];var ae=m(z),a=m(ae,!0);d(ae);var t=_(ae,2),c=m(t);d(t),d(z),X(()=>{G(a,e(y).name),G(c,`Tier ${e(y).tier??""}`)}),i(o,z)},o=>{var y=Ra();i(o,y)}),d(v),d(M),d(E),ea(W,()=>e(C),o=>u(C,o)),aa(ee,()=>e(h),o=>u(h,o)),i(T,E)};L(j,T=>{n()&&T(re)})}i(R,k),fe(),w()}Ae(["click"]);var Sa=s('<meta name="viewport" content="width=device-width, initial-scale=1"/>'),Ea=s("<!> <!>",1),Ua=s('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),Aa=s('<div class="sheet svelte-1smdv23"><!></div>'),Ma=s('<div class="error svelte-1smdv23"> </div>'),za=s('<div class="ok svelte-1smdv23">Criatura vÃ¡lida: <strong> </strong> </div>'),Da=s('<div class="editor svelte-1smdv23"><!> <!></div>'),ja=s('<div class="error svelte-1smdv23"> </div>'),Na=s('<div class="ok svelte-1smdv23">Criatura vÃ¡lida: <strong> </strong> </div>'),Oa=s("<!> <!>",1),Fa=s('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),qa=s('<div class="mixed-view svelte-1smdv23"><div class="editor-panel svelte-1smdv23"><!> <!></div> <div class="preview-panel svelte-1smdv23"><!></div></div>'),Ya=s("<!> <!>",1),Ba=s('<div class="status svelte-1smdv23">No hay una criatura vÃ¡lida para mostrar.</div>'),Va=s('<div class="sheet svelte-1smdv23"><!></div>'),Ha=s("<div><!> <!> <!></div>");function _t(R,r){_e(r,!0);let f=Y("mixed"),l=Y(""),w=Y(null),n=Y(void 0),p=Y(!1),b=Y(!1),C=Y(0),h=null;const S=400;let g=null;const J=2e3;let k=0;const j=`# Ejemplo de criatura (editar aquÃ­)
name: Goblin
tier: 1
attributes:
  body: 2
  reflexes: 3
  mind: 1
  instinct: 2
  presence: 1
stats:
  maxHealth: 8
  evasion:
    value: 1
    note: null
  physicalMitigation:
    value: 0
    note: null
  magicalMitigation:
    value: 0
    note: null
  speed:
    value: 6
    note: null
languages: []
attacks:
  - name: Mordisco
    bonus: 1
    damage: 1d6
    note: null
traits:
  - name: Astuto
    detail: Sumar +1 a iniciativas en grupo
actions:
  - name: Ataque mÃºltiple
    detail: Ataca dos veces
    uses: null
reactions: []
interactions: []
behavior: ActÃºa en pequeÃ±os grupos para emboscar.
img: null
`,{isInsideFoundry:re,syncCreatureState:T}=va(),E=a=>{u(n,a,!0),re()&&T(e(n))};function M(a){if(u(w,null),!a||!a.trim()){u(n,void 0);return}try{const t=ia(a);let c=null;if(t&&typeof t=="object"&&Array.isArray(t.creatures))c=t.creatures[0]??null;else if(t&&typeof t=="object")c=t;else throw new Error("YAML no contiene un objeto vÃ¡lido de criatura.");if(!c)throw new Error("No se encontrÃ³ una criatura en el YAML proporcionado.");const N=sa(c);E(N)}catch(t){u(n,void 0);const c=t&&t.message?t.message:String(t);u(w,`Error al parsear YAML: ${c}`)}}Ue(()=>{const a=e(l);h&&clearTimeout(h),h=setTimeout(()=>{M(a),h=null},S);try{const t=Date.now(),c=()=>{try{const N=encodeURIComponent(a),K=new URL(window.location.href);N&&N.length>0?K.searchParams.set("yaml",N):K.searchParams.delete("yaml"),e(p)&&K.searchParams.set("readonly","1"),la(K.toString(),{}),k=Date.now()}catch{}};if(t-k>=J)g&&(clearTimeout(g),g=null),c();else{const N=J-(t-k);g||(g=setTimeout(()=>{c(),g=null},N))}}catch{}}),Le(()=>{try{const a=new URL(window.location.href),t=a.searchParams.get("yaml"),c=a.searchParams.get("readonly");if(u(p,c==="1"),t)try{u(l,decodeURIComponent(t),!0)}catch{u(l,j)}else u(l,j)}catch{u(l,j),u(p,!1)}e(p)&&u(f,"sheet")});function B(a){u(l,a,!0),Ie(C),u(f,"mixed")}async function oe(){await ce.confirm("Â¿Reiniciar al ejemplo por defecto? Se perderÃ¡n los cambios actuales.",{title:"Confirmar reinicio",confirmLabel:"Reiniciar",cancelLabel:"Cancelar"})&&(u(l,j),Ie(C))}async function $(){try{const a=encodeURIComponent(e(l)),t=new URL(window.location.href);a&&a.length>0?t.searchParams.set("yaml",a):t.searchParams.delete("yaml"),e(p)&&t.searchParams.set("readonly","1");const c=t.toString();await navigator.clipboard.writeText(c),await ce.alert("Enlace copiado al portapapeles.")}catch(a){console.warn("[embedded npc] copyShareURL failed",a),await ce.alert("No se pudo copiar la URL.")}}async function W(){try{const a=encodeURIComponent(e(l)),t=new URL(window.location.href);a&&a.length>0?t.searchParams.set("yaml",a):t.searchParams.delete("yaml"),t.searchParams.set("readonly","1");const c=`<iframe src="${t.toString()}" width="100%" height="600" style="border:none;"></iframe>`;await navigator.clipboard.writeText(c),await ce.alert("CÃ³digo iframe copiado al portapapeles.")}catch(a){console.warn("[embedded npc] copyIframe failed",a),await ce.alert("No se pudo copiar el cÃ³digo iframe.")}}function ee(){const a=new Blob([e(l)],{type:"text/yaml"}),t=URL.createObjectURL(a),c=document.createElement("a");c.href=t,c.download=`${(e(n)?.name??"creature").replace(/\s+/g,"_")}.yml`,document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(t)}var F=Ha();Ke(a=>{var t=Sa();Ze.title="NPC Custom (embebido)",i(a,t)});let ne;var v=m(F);Ca(v,{get activeTab(){return e(f)},onTabChange:a=>u(f,a,!0),onImport:()=>u(b,!0),onReset:oe,onCopyLink:$,onCopyIframe:W,onDownload:ee,get readonly(){return e(p)}});var o=_(v,2);Pa(o,{onSelect:B,onClose:()=>u(b,!1),get open(){return e(b)},set open(a){u(b,a,!0)}});var y=_(o,2);{var z=a=>{var t=Aa(),c=m(t);{var N=U=>{var O=Ea(),te=H(O);ke(te,{get creature(){return e(n)}});var se=_(te,2);Te(se,{}),i(U,O)},K=U=>{var O=Ua();i(U,O)};L(c,U=>{e(n)?U(N):U(K,!1)})}d(t),i(a,t)},ae=a=>{var t=de(),c=H(t);{var N=U=>{var O=Da(),te=m(O);Se(te,()=>e(C),x=>{Ee(x,{language:"yaml",get value(){return e(l)},set value(P){u(l,P,!0)}})});var se=_(te,2);{var pe=x=>{var P=Ma(),Q=m(P,!0);d(P),X(()=>G(Q,e(w))),i(x,P)},Z=x=>{var P=de(),Q=H(P);{var le=D=>{var q=za(),V=_(m(q)),ve=m(V,!0);d(V);var ye=_(V);d(q),X(()=>{G(ve,e(n).name),G(ye,` (tier ${e(n).tier??""})`)}),i(D,q)};L(Q,D=>{e(n)&&D(le)},!0)}i(x,P)};L(se,x=>{e(w)?x(pe):x(Z,!1)})}d(O),i(U,O)},K=U=>{var O=de(),te=H(O);{var se=Z=>{var x=qa(),P=m(x),Q=m(P);Se(Q,()=>e(C),I=>{Ee(I,{language:"yaml",get value(){return e(l)},set value(A){u(l,A,!0)}})});var le=_(Q,2);{var D=I=>{var A=ja(),ie=m(A,!0);d(A),X(()=>G(ie,e(w))),i(I,A)},q=I=>{var A=de(),ie=H(A);{var he=be=>{var ge=Na(),we=_(m(ge)),ze=m(we,!0);d(we);var De=_(we);d(ge),X(()=>{G(ze,e(n).name),G(De,` (tier ${e(n).tier??""})`)}),i(be,ge)};L(ie,be=>{e(n)&&be(he)},!0)}i(I,A)};L(le,I=>{e(w)?I(D):I(q,!1)})}d(P);var V=_(P,2),ve=m(V);{var ye=I=>{var A=Oa(),ie=H(A);ke(ie,{get creature(){return e(n)}});var he=_(ie,2);Te(he,{}),i(I,A)},Me=I=>{var A=Fa();i(I,A)};L(ve,I=>{e(n)?I(ye):I(Me,!1)})}d(V),d(x),i(Z,x)},pe=Z=>{var x=Va(),P=m(x);{var Q=D=>{var q=Ya(),V=H(q);ke(V,{get creature(){return e(n)}});var ve=_(V,2);Te(ve,{}),i(D,q)},le=D=>{var q=Ba();i(D,q)};L(P,D=>{e(n)?D(Q):D(le,!1)})}d(x),i(Z,x)};L(te,Z=>{e(f)==="mixed"?Z(se):Z(pe,!1)},!0)}i(U,O)};L(c,U=>{e(f)==="yaml"?U(N):U(K,!1)},!0)}i(a,t)};L(y,a=>{e(p)?a(z):a(ae,!1)})}d(F),X(a=>ne=ue(F,1,"embedded-npc svelte-1smdv23",null,ne,a),[()=>({readonly:e(p)})]),i(R,F),fe()}export{_t as component,mt as universal};
