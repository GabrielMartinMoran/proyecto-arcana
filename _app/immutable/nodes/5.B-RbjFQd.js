import"../chunks/DsnmJJEf.js";import"../chunks/ofLKhmed.js";import{p as _,o as v,c as w}from"../chunks/Kn-3yCMi.js";import{i as A}from"../chunks/DyaUJb1m.js";import{s as I,a as R}from"../chunks/XhFqZ_PR.js";import{a as s,C as $,u as j}from"../chunks/CZXeoIMr.js";import{C as c}from"../chunks/DoQYgQHR.js";const k=()=>new s({id:crypto.randomUUID(),name:"Nuevo Personaje",attributes:{body:1,reflexes:1,mind:1,instinct:1,presence:1},cards:[],ppHistory:[],goldHistory:[],equipment:[],modifiers:[],currentHP:0,tempHP:0,currentLuck:c.STARTING_LUCK,img:null,story:"",notes:[],languages:"",quickInfo:"",attacks:[],maxActiveCards:c.BASE_MAX_ACTIVE_CARDS,version:1});function H(i,p){_(p,!1);const d=()=>R(o,"$characters",l),[l,m]=I();let{characters:o,loadCharacters:u}=j();v(async()=>{await u()});const h=async()=>{const t=k();return o.update(()=>[...d(),t]),t},y=()=>new Promise(t=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async()=>{if(!e.files||e.files.length===0)return;const r=e.files[0],a=new FileReader;a.onload=async g=>{const b=JSON.parse(g.target?.result),n=new s({...b,id:crypto.randomUUID()});o.update(U=>[...U,n]),t(n)},a.readAsText(r)},document.body.appendChild(e),e.click(),document.body.removeChild(e)}),C=async t=>{const e=new Blob([JSON.stringify(t)],{type:"application/json"}),r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=`${t.name}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},f=async t=>{o.update(e=>e.filter(r=>r.id!==t.id))};A(),$(i,{readonly:!1,get characters(){return o},onCreateCharacter:h,onImportCharacter:y,onExportCharacter:C,onDeleteCharacter:f}),w(),m()}export{H as component};
