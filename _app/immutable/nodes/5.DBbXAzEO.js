import"../chunks/DsnmJJEf.js";import"../chunks/ofLKhmed.js";import{p as _,o as j,c as v}from"../chunks/Kn-3yCMi.js";import{i as w}from"../chunks/DyaUJb1m.js";import{s as A,a as I}from"../chunks/XhFqZ_PR.js";import{a as s,C as R,u as $}from"../chunks/Bja0MEWI.js";import{C as c}from"../chunks/DoQYgQHR.js";const k=()=>new s({id:crypto.randomUUID(),name:"Nuevo Personaje",attributes:{cuerpo:1,reflejos:1,mente:1,instinto:1,presencia:1},cards:[],ppHistory:[],goldHistory:[],equipment:[],modifiers:[],currentHP:0,tempHP:0,currentLuck:c.STARTING_LUCK,img:null,story:"",notes:[],languages:"",quickInfo:"",attacks:[],maxActiveCards:c.BASE_MAX_ACTIVE_CARDS,version:1});function H(i,p){_(p,!1);const d=()=>I(o,"$characters",l),[l,m]=A();let{characters:o,loadCharacters:u}=$();j(async()=>{await u()});const h=async()=>{const t=k();return o.update(()=>[...d(),t]),t},C=()=>new Promise(t=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async()=>{if(!e.files||e.files.length===0)return;const r=e.files[0],a=new FileReader;a.onload=async g=>{const b=JSON.parse(g.target?.result),n=new s({...b,id:crypto.randomUUID()});o.update(U=>[...U,n]),t(n)},a.readAsText(r)},document.body.appendChild(e),e.click(),document.body.removeChild(e)}),f=async t=>{const e=new Blob([JSON.stringify(t)],{type:"application/json"}),r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=`${t.name}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},y=async t=>{o.update(e=>e.filter(r=>r.id!==t.id))};w(),R(i,{readonly:!1,get characters(){return o},onCreateCharacter:h,onImportCharacter:C,onExportCharacter:f,onDeleteCharacter:y}),v(),m()}export{H as component};
